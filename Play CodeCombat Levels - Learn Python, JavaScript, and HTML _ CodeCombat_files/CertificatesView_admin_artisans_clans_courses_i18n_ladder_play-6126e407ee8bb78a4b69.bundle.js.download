(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{1373:function(t,e,i){null==window.createjs&&(window.createjs={}),i(1566),t.exports=window.createjs},1374:function(v,t,b){!function(g){function t(t,e){for(var i in e)c.call(e,i)&&(t[i]=e[i]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t}var e,S,i,n,a,r,s,o,h,l,u=function(t,e){return function(){return t.apply(e,arguments)}},c={}.hasOwnProperty,d=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};function p(){return this.onFileUploaded=u(this.onFileUploaded,this),p.__super__.constructor.apply(this,arguments)}function f(){return f.__super__.constructor.apply(this,arguments)}function m(){return m.__super__.constructor.apply(this,arguments)}i=b(25),a=b(1393),S=b(619),e=b(115),h=b(1373),r=b(177),s=b(639),l=b(6),o=[],v.exports=(t(p,i),p.className="ThangType",p.schema=b(1567),p.heroes=r.heroes,p.heroClasses=r.heroClasses,p.items=r.items,p.prototype.urlRoot="/db/thang.type",p.prototype.building={},p.prototype.editableByArtisans=!0,p.defaultActions=["idle","die","move","attack","trick","cast"],p.heroConfigStats={},p.prototype.initialize=function(){return p.__super__.initialize.call(this),this.building={},this.spriteSheets={}},p.prototype.destroy=function(){var t;return null!=(t=this.rasterImage)&&"function"==typeof t.off&&t.off(),p.__super__.destroy.call(this)},p.prototype.resetRawData=function(){return this.set("raw",{shapes:{},containers:{},animations:{}})},p.prototype.resetSpriteSheetCache=function(){return this.buildActions(),this.spriteSheets={},this.building={}},p.prototype.isFullyLoaded=function(){return this.get("actions")||this.get("raster")},p.prototype.loadRasterImage=function(){var t,e,i;if(!this.loadingRaster&&!this.loadedRaster&&(t=this.get("raster")))return this.rasterImage=l.isIE()?g("<img src='/file/"+t+"' />"):g("<img crossOrigin='Anonymous', src='/file/"+t+"' />"),this.loadingRaster=!0,this.rasterImage.one("load",(e=this,function(){return e.loadingRaster=!1,e.loadedRaster=!0,e.trigger("raster-image-loaded",e),e.rasterImage.off("error")})),this.rasterImage.one("error",(i=this,function(){return i.loadingRaster=!1,i.trigger("raster-image-load-errored",i),i.rasterImage.off("load")}))},p.prototype.getActions=function(){return this.isFullyLoaded()?this.actions||this.buildActions():{}},p.prototype.getDefaultActions=function(){for(var e,t=[],i=_.values(this.getActions()),n=0,r=i.length;n<r;n++)e=i[n],_.any(p.defaultActions,function(t){return _.string.startsWith(e.name,t)})&&t.push(e);return t},p.prototype.buildActions=function(){var t,e,i,n,r,s,a;if(!this.isFullyLoaded())return null;for(e in this.actions=g.extend(!0,{},this.get("actions")),i=this.actions)for(a in(t=i[e]).name=e,r=null!=(n=t.relatedActions)?n:{})(s=r[a]).name=t.name+"_"+a,this.actions[s.name]=s;return this.actions},p.prototype.fillOptions=function(t){return null==t&&(t={}),null==(t=_.clone(t)).resolutionFactor&&(t.resolutionFactor=SPRITE_RESOLUTION_FACTOR),null==t.async&&(t.async=!1),t.thang=null,t},p.prototype.buildSpriteSheet=function(t){var e,i;return!(!this.isFullyLoaded()||!this.get("raw"))&&(this.options=this.fillOptions(t),e=this.spriteSheetKey(this.options),(i=this.spriteSheets[e])?i:this.building[e]?(this.options=null,e):(this.t0=(new Date).getTime(),this.initBuild(t),this.options.portraitOnly||this.addGeneralFrames(),this.addPortrait(),this.building[e]=!0,this.finishBuild()))},p.prototype.initBuild=function(t){return this.actions||this.buildActions(),this.vectorParser=new a(this,t),this.builder=new h.SpriteSheetBuilder,this.builder.padding=2,this.frames={}},p.prototype.addPortrait=function(){var t,e,i,n;if(this.actions&&(i=this.actions.portrait))return n=i.scale||1,t=null!=(e=i.positions)?e.registration:void 0,e=new h.Rectangle((null!=t?t.x:void 0)/n||0,(null!=t?t.y:void 0)/n||0,100/n,100/n),i.animation?((t=this.vectorParser.buildMovieClip(i.animation)).nominalBounds=t.frameBounds=null,this.builder.addMovieClip(t,e,n),t=this.builder._animations[i.animation].frames,null!=i.frames&&(t=this.mapFrames(i.frames,t[0])),this.builder.addAnimation("portrait",t,!0)):i.container?(i=this.vectorParser.buildContainerFromStore(i.container),n=this.builder.addFrame(i,e,n),this.builder.addAnimation("portrait",[n],!1)):void 0},p.prototype.addGeneralFrames=function(){for(var t,e,i,n,r,s,a,o,h,l,u,c={},d=this.requiredRawAnimations(),p=0,_=d.length;p<_;p++)n=(e=d[p]).animation,(i=this.vectorParser.buildMovieClip(n))&&(this.builder.addMovieClip(i,null,e.scale*this.options.resolutionFactor),c[e.scale+"_"+n]=this.builder._animations[n].frames);for(n in r=this.actions)(t=r[n]).animation&&"portrait"!==n&&(a=c[(u=null!=(s=null!=(a=t.scale)?a:this.get("scale"))?s:1)+"_"+t.animation])&&(null!=t.frames&&(a=this.mapFrames(t.frames,a[0])),s=!0,t.goesTo&&(s=t.goesTo),!1===t.loops&&(s=!1),this.builder.addAnimation(n,a,s));for(n in h=[],o=this.actions)(t=o[n]).container&&!t.animation&&"portrait"!==n&&(u=this.options.resolutionFactor*(t.scale||this.get("scale")||1),(l=this.vectorParser.buildContainerFromStore(t.container))&&(l=this.builder.addFrame(l,l.bounds,u),h.push(this.builder.addAnimation(n,[l],!1))));return h},p.prototype.requiredRawAnimations=function(){var t,e,i,n,r,s,a,o,h=[],l=this.get("actions");for(s in l)if(a=l[s],"portrait"!==s)for(n=0,r=(e=[a].concat(_.values(null!=(a=a.relatedActions)?a:{}))).length;n<r;n++)(t=e[n]).animation&&(o="portrait"===s?t.scale||1:t.scale||this.get("scale")||1,(i={animation:t.animation,scale:o}).portrait="portrait"===s,_.find(h,function(t){return _.isEqual(t,i)})||h.push(i));return h},p.prototype.mapFrames=function(t,e){var i,n,r,s,a;if(!_.isString(t))return t;for(a=[],n=0,r=(s=t.split(",")).length;n<r;n++)i=s[n],a.push(parseInt(i,10)+e);return a},p.prototype.finishBuild=function(){var t,e;if(!_.isEmpty(this.builder._animations))return t=this.spriteSheetKey(this.options),this.options.async?(o.push(this.builder),this.builder.t0=(new Date).getTime(),1<o.length||this.builder.buildAsync(),this.builder.on("complete",this.onBuildSpriteSheetComplete,this,!0,[this.builder,t,this.options]),this.builder=null,t):(e=this.builder.build(),this.logBuild(this.t0,!1,this.options.portraitOnly),this.spriteSheets[t]=e,this.building[t]=!1,this.builder=null,this.options=null,e)},p.prototype.onBuildSpriteSheetComplete=function(t,e){var i=e[0],n=e[1],e=e[2];return this.logBuild(i.t0,!0,e.portraitOnly),(o=o.slice(1))[0]&&(o[0].t0=(new Date).getTime()),null!=(e=o[0])&&e.buildAsync(),this.spriteSheets[n]=t.target.spriteSheet,this.building[n]=!1,this.trigger("build-complete",{key:n,thangType:this}),this.vectorParser=null},p.prototype.logBuild=function(t,e,i){var n=e?"Async":"Sync ";return i=i?"(Portrait)":"",e=_.string.rpad(this.get("name"),20),t=_.string.lpad(""+(new Date).getTime()-t,6),console.debug("Built sheet:  "+e+" "+t+"ms  "+n+"  "+i)},p.prototype.spriteSheetKey=function(t){var e,i,n,r=[],s=t.colorConfig||{};for(i in s)e=s[i],r.push(i+":"+e.hue+"|"+e.saturation+"|"+e.lightness);return r=r.join(","),n=!!t.portraitOnly,this.get("name")+" - "+t.resolutionFactor+" - "+r+" - "+n},p.prototype.getHeroShortName=function(){return s.getHeroShortName(this.attributes)},p.prototype.getGender=function(){return s.getGender(this.attributes)},p.prototype.getPortraitImage=function(t,e){return(e=this.getPortraitSource(t,e=null==e?100:e))?g("<img />").attr("src",e):null},p.prototype.getPortraitSource=function(t,e){return null==e&&(e=100),this.get("rasterIcon")||this.get("raster")?this.getPortraitURL():null!=(e=this.getPortraitStage(t,e))?e.toDataURL():void 0},p.prototype.getPortraitStage=function(t,e){var i,n,r,s,e=g("<canvas width='"+(e=null==e?100:e)+"' height='"+e+"'></canvas>");try{s=new h.Stage(e[0])}catch(t){return r=t,console.error("Error trying to create "+this.get("name")+" avatar stage:",r,"with window as",window),null}return this.isFullyLoaded()?(r=t,r=_.isString(r)?r:this.spriteSheetKey(this.fillOptions(r)),(r=this.spriteSheets[r])||((t=_.isPlainObject(t)?t:{}).portraitOnly=!0,r=this.buildSpriteSheet(t)),!_.isString(r)&&r?(n=new h.Sprite(r),i=null!=(r=this.actions.portrait)&&null!=(i=r.positions)?i.registration:void 0,n.regX=(null!=i?i.x:void 0)||0,n.regY=(null!=i?i.y:void 0)||0,n.framerate=null!=(i=null!=(i=this.actions.portrait)?i.framerate:void 0)?i:20,n.gotoAndStop("portrait"),s.addChild(n),s.update(),s.startTalking=function(){return n.gotoAndPlay("portrait")},s.stopTalking=function(){return n.gotoAndStop("portrait")},s):void 0):s},p.prototype.getVectorPortraitStage=function(t){var e,i,n,r,s;if(null==t&&(t=100),this.actions&&(s=g("<canvas width='"+t+"' height='"+t+"'></canvas>"),r=new h.Stage(s[0]),(e=this.actions.portrait)&&(e.animation||e.container)))return i=e.scale||1,s=new a(this,{}),e.animation?(n=s.buildMovieClip(e.animation)).gotoAndStop(0):e.container&&(n=s.buildContainerFromStore(e.container)),e=null!=(e=e.positions)?e.registration:void 0,n.regX=(null!=e?e.x:void 0)/i||0,n.regY=(null!=e?e.y:void 0)/i||0,n.scaleX=n.scaleY=i*t/100,r.addChild(n),r.update(),r},p.prototype.uploadGenericPortrait=function(t,e){return(e=null==e?this.getPortraitSource():e)&&_.string.startsWith(e,"data:")?(e=e.replace("data:image/png;base64,","").replace(/\ /g,"+"),e={filename:"portrait.png",mimetype:"image/png",path:"db/thang.type/"+this.get("original"),b64png:e,force:"true"},g.ajax("/file",{type:"POST",data:e,success:t||this.onFileUploaded})):"function"==typeof t?t():void 0},p.prototype.onFileUploaded=function(){return console.log("Image uploaded")},p.loadUniversalWizard=function(){return this.wizardType||(this.wizardType=new v.exports,this.wizardType.url=function(){return"/db/thang.type/52a00d55cf1818f2be00000b/version"},this.wizardType.fetch(),this.wizardType)},p.prototype.getPortraitURL=function(){return s.getPortraitURL(this.attributes)},p.prototype.getAllowedSlots=function(){var t,e=_.find(this.get("components")||[],function(t){return t.original===S.ItemID});return(null!=e&&null!=(t=e.config)?t.slots:void 0)||["right-hand"]},p.prototype.getAllowedHeroClasses=function(){var t;return(t=this.get("heroClass"))?[t]:["Warrior","Ranger","Wizard"]},p.prototype.getHeroStats=function(){var t,e,i,n,r,s,a,o,h,l,u,c,d,p,f;if(this.get("heroClass")){if(l=this.get("components")||[],!(u=null!=(h=_.find(l,{original:S.EquipsID}))?h.config:void 0))return console.warn(this.get("name"),"is not an equipping hero, but you are asking for its hero stats. (Did you project away components?)");if(!(h=null!=(h=_.find(l,{original:S.MovesID}))?h.config:void 0))return console.warn(this.get("name"),"is not a moving hero, but you are asking for its hero stats.");if(!(s=null!=(l=_.find(l,{original:S.ProgrammableID}))?l.config:void 0))return console.warn(this.get("name"),"is not a Programmable hero, but you are asking for its hero stats.");for(null==this.classStatAverages&&(this.classStatAverages={attack:{Warrior:7.5,Ranger:5,Wizard:2.5},health:{Warrior:7.5,Ranger:5,Wizard:3.5}}),f={},o={attack:null!=(l=u.attackDamageFactor)?l:1,health:null!=(u=u.maxHealthFactor)?u:1,speed:h.maxSpeed},t=0,e=(c=["attack","health"]).length;t<e;t++)n=(p=o[a=c[t]])<1?10-5/p:5*p,r=this.classStatAverages[a][this.get("heroClass")],f[a]={relative:Math.round(2*(r-2.5+n/2))/2/10,absolute:p},r=function(){var t,e=[];for(i=t=1;t<=3;i=++t)e.push(g.i18n.t("choose_hero."+a+"_"+i));return e}(),n=Math.round(100*p)+"%",p=g.i18n.t("general."+_.string.slugify(this.get("heroClass"))),f[a].description=[r[0],n,r[1],p,r[2]].join(" ");return f.speed={relative:Math.round(20*(o.speed-4)/12)/2/10,absolute:o.speed,description:g.i18n.t("choose_hero.speed_1")+" "+o.speed+" "+g.i18n.t("choose_hero.speed_2")},f.skills=function(){for(var t=s.programmableProperties,e=[],i=0,n=t.length;i<n;i++)"say"===(d=t[i])||/(Range|Pos|Radius|Damage)$/.test(d)||e.push(_.string.titleize(_.string.humanize(d)));return e}(),f}},p.prototype.getFrontFacingStats=function(){var t,e,i,n,r,s,a,o,h,l,u,c,d,p,f,g,m,v,b,y,T=this.get("components")||[];if(!(p=null!=(c=_.find(T,{original:S.ItemID}))?c.config:void 0))return console.warn(this.get("name"),"is not an item, but you are asking for its stats."),{props:[],stats:{}};for(m in b={},u=(u=null!=(c=p.programmableProperties)?c:[]).concat(null!=(c=p.moreProgrammableProperties)?c:[]),u=_.without(u,"canCast","spellNames","spells"),d=null!=(c=p.stats)?c:{})l=d[m],b[m]=this.formatStatDisplay(m,l);for(i=0,a=(f=null!=(p=p.extraHUDProperties)?p:[]).length;i<a;i++)null==b[m=f[i]]&&(b[m]=null);for(n=0,o=T.length;n<o;n++)if(t=T[n].config){for(m in b)null==(y=b[m])&&null!=(y=t[m])&&(b[m]=this.formatStatDisplay(m,{setTo:y}),"attackDamage"===m&&(e=(y/(t.cooldown||.5)).toFixed(1),b[m].display+=" ("+e+" DPS)"));t.programmableSnippets&&(u=u.concat(t.programmableSnippets))}for(m in b)null==(y=b[m])&&(b[m]={name:m,display:"???"});for((v=_.keys(b)).sort(),u.sort(),g={},r=0,h=v.length;r<h;r++)g[s=v[r]]=b[s];return{props:u,stats:g}},p.prototype.formatStatDisplay=function(t,e){var i,n={maxHealth:"health",maxSpeed:"speed",healthReplenishRate:"regeneration",attackDamage:"attack",attackRange:"range",shieldDefenseFactor:"blocks",visualRange:"range",throwDamage:"attack",throwRange:"range",bashDamage:"attack",backstabDamage:"backstab"}[t],r=n?(t=g.i18n.t("choose_hero."+n),!0):(t=_.string.humanize(t),!1),s="";return/(range|radius|distance|vision)$/i.test(t)&&(s="m"),/cooldown$/i.test(t)&&(s=s||"s"),/speed$/i.test(t)&&(s=s||"m/s"),/(regeneration| rate)$/i.test(t)&&(s=s||"/s"),i=e.setTo,/(blocks)$/i.test(t)&&(s=s||"%",i=(100*i).toFixed(1)),n=[],null!=(i=_.isArray(i)?i.join(", "):i)&&n.push(""+i+s),0<e.addend&&n.push("+"+e.addend+s),e.addend<0&&n.push(""+e.addend+s),null!=e.factor&&1!==e.factor&&n.push("x"+e.factor),{name:t,display:n=(n=n.join(", ")).replace(/9001m?/,"Infinity"),matchedShortName:r}},p.prototype.isSilhouettedItem=function(){var t;return null==this.get("gems")&&null==this.get("tier")?console.error("Trying to determine whether "+this.get("name")+" should be a silhouetted item, but it has no gem cost."):(null==this.get("tier")&&console.info("Add (or make sure you have fetched) a tier for "+this.get("name")+" to more accurately determine whether it is silhouetted."),null!=this.get("tier")?this.levelRequiredForItem()>me.level():(t=1.5*(null!=(t=me.get("points"))?t:0),this.get("gems")>1.2*(100+t)))},p.prototype.levelRequiredForItem=function(){var t;return null==this.get("tier")?console.error("Trying to determine what level is required for "+this.get("name")+", but it has no tier."):(t=this.get("tier"),me.constructor.levelForTier(t/2.5))},p.prototype.getContainersForAnimation=function(t,e){var i,n,r,s,a=this.get("raw").animations[t];for(a||console.error("thang type",this.get("name"),"is missing animation",t,"from action",e),i=a.containers,n=0,r=(s=this.get("raw").animations[t].animations).length;n<r;n++)t=s[n],i=i.concat(this.getContainersForAnimation(t.gn,e));return i},p.prototype.getContainersForActions=function(t){for(var e,i,n,r,s={},a=this.getActions(),o=0,h=t.length;o<h;o++)if(e=t[o],(e=_.find(a,{name:e})).container)s[e.container]=!0;else if(e.animation)for(n=0,r=(i=this.getContainersForAnimation(e.animation,e)).length;n<r;n++)s[i[n].gn]=!0;return _.keys(s)},p.prototype.nextForAction=function(t){var e=!0;return t.goesTo&&(e=t.goesTo),e=!1===t.loops?!1:e},p.prototype.noRawData=function(){return!this.get("raw")},p.prototype.initPrerenderedSpriteSheets=function(){var t;if(!this.prerenderedSpriteSheets&&(t=this.get("prerenderedSpriteSheetData")))return this.prerenderedSpriteSheets=new n(t)},p.prototype.getPrerenderedSpriteSheet=function(i,t){var n;if(this.prerenderedSpriteSheets)return n=this.get("spriteType")||t,!(t=this.prerenderedSpriteSheets.find(function(t){var e;return t.get("spriteType")===n&&(e=t.get("colorConfig"),!(!_.isEmpty(i)||!_.isEmpty(e))||(t=function(t){return _.result(_.result(t,"team"),"hue")})(i)===t(e))}))&&this.noRawData()?this.prerenderedSpriteSheets.first():t},p.prototype.getPrerenderedSpriteSheetToLoad=function(){if(this.prerenderedSpriteSheets)return this.noRawData()?this.prerenderedSpriteSheets.first():this.prerenderedSpriteSheets.find(function(t){return t.needToLoad&&!t.loadedImage})},p.prototype.onLoaded=function(){var t,e,i,n,r,s,a,o;if(p.__super__.onLoaded.call(this),!p.heroConfigStats[this.get("original")]&&(i=this.get("components")||[]).length&&(null!=this.get("gems")||!(this.project&&!/gems/.test(this.project)||/project/.test(this.getURL())&&!/gems/.test(this.getURL())||null!=(t=this.collection)&&t.project&&!/gems/.test(null!=(o=this.collection)?o.project:void 0)||/project/.test(null!=(n=this.collection)?n.getURL():void 0)&&!/gems/.test(null!=(r=this.collection)?r.getURL():void 0))))return o={gems:this.get("gems")||0},(r=null!=(n=_.find(i,{original:S.ItemID}))?n.config:void 0)?(o.kind="item",(a=null!=(n=r.stats)&&null!=(a=n.maxSpeed)?a.addend:void 0)&&(o.speed=a),(s=null!=(r=r.stats)&&null!=(s=r.maxHealth)?s.addend:void 0)&&(o.health=s),(s=null!=(s=_.find(i,{original:S.AttacksID}))?s.config:void 0)&&(o.attack=(null!=(e=s.attackDamage)?e:3)/(null!=(e=s.cooldown)?e:1)),p.heroConfigStats[this.get("original")]=o):(e=null!=(s=_.find(i,{original:S.EquipsID}))?s.config:void 0)&&(o.kind="hero",o.attackMultiplier=null!=(s=e.attackDamageFactor)?s:1,o.healthMultiplier=null!=(e=e.maxHealthFactor)?e:1,(e=null!=(e=_.find(i,{original:S.MovesID}))?e.config:void 0)&&(o.speed=null!=(e=e.maxSpeed)?e:3.6),(i=null!=(i=_.find(i,{original:S.AttackableID}))?i.config:void 0)&&(o.baseHealth=null!=(i=i.maxHealth)?i:11),p.heroConfigStats[this.get("original")]=o),null},p.calculateStatsForHeroConfig=function(t,e){for(var i,n,r,s,a={},o=null!=(o=t.thangType)?o:p.heroes.captain,h=_.values(t.inventory).concat([o]),l=0,u=h.length;l<u;l++)n=h[l],a[n]=p.heroConfigStats[n]||"loading";for(n in s=this,i=function(t){return t.on("sync",function(){return a[t.get("original")]=p.heroConfigStats[t.get("original")],t.off("sync"),t.destroy(),s.formatStatsForHeroConfig(a,e)})},a)"loading"===a[n]&&(r="/db/thang.type/"+n+"/version?project=original,components,gems",i(r=(new p).setURL(r)),r.fetch());return this.formatStatsForHeroConfig(a,e)},p.formatStatsForHeroConfig=function(t,e){var i,n,r,s,a,o=_.values(t);if(!(0<=d.call(o,"loading"))){for(a={health:null!=(t=(i=_.find(o,{kind:"hero"})).baseHealth)?t:11,speed:0,gems:0},n=0,r=o.length;n<r;n++)(s=o[n]).gems&&(a.gems+=s.gems),s.health&&(a.health+=s.health*(i.healthMultiplier||1)),s.attack&&(a.attack=s.attack*(i.attackMultiplier||1)),s.speed&&(a.speed+=s.speed);return e(a)}},p),t(f,i),f.className="PrerenderedSpriteSheet",f.prototype.loadImage=function(){var t,e,i;return!!this.loadingImage||!this.loadedImage&&(!!(t=this.get("image"))&&(this.image=g("<img crossOrigin='Anonymous', src='/file/"+t+"' />"),this.loadingImage=!0,this.image.one("load",(e=this,function(){return e.loadingImage=!1,e.loadedImage=!0,e.buildSpriteSheet(),e.trigger("image-loaded",e)})),this.image.one("error",(i=this,function(){return i.loadingImage=!1,i.trigger("image-load-error",i)})),!0))},f.prototype.buildSpriteSheet=function(){return this.spriteSheet=new h.SpriteSheet({images:[this.image[0]],frames:this.get("frames"),animations:this.get("animations")})},f.prototype.markToLoad=function(){return this.needToLoad=!0},f.prototype.needToLoad=!1,f.prototype.loadedImage=!1,f.prototype.loadingImage=!1,i=f,t(m,e),m.prototype.model=i,n=m}.call(this,b(3))},1393:function(module,exports,__webpack_require__){var SpriteBuilder,createjs,hexToHSL,hslToHex,ref,sum,slice=[].slice,ref=__webpack_require__(6),hexToHSL=ref.hexToHSL,hslToHex=ref.hslToHex,createjs=__webpack_require__(1373);module.exports=SpriteBuilder=function(){function SpriteBuilder(t,e){this.thangType=t,this.options=e,null==this.options&&(this.options={}),e=this.thangType.get("raw")||{},this.shapeStore=e.shapes,this.containerStore=e.containers,this.animationStore=e.animations,this.buildColorMaps()}return SpriteBuilder.prototype.setOptions=function(t){this.options=t},SpriteBuilder.prototype.buildMovieClip=function(t,e,i,n,r){var s,a,o,h,l,u,c,d,p,f,g,m,v,b=this.animationStore[t];if(!b)return console.error("couldn't find animData from",this.animationStore,"for",t),null;for(p={},_.extend(p,this.buildMovieClipShapes(b.shapes)),_.extend(p,this.buildMovieClipContainers(b.containers)),_.extend(p,this.buildMovieClipAnimations(b.animations)),_.extend(p,this.buildMovieClipGraphics(b.graphics)),s=new createjs.MovieClip,r||((r={})[t]=0),s.initialize(null!=e?e:createjs.MovieClip.INDEPENDENT,null!=i?i:0,null==n||n,r),l=0,c=(f=b.tweens).length;l<c;l++){for(v=f[l],m=createjs.Tween,g=!1,u=0,d=v.length;u<d;u++){if(h=v[u],a=_.cloneDeep(h.a),this.dereferenceArgs(a,p),!m[h.n]){g=!0;break}m=m[h.n].apply(m,a)}g||s.timeline.addTween(m)}return s.nominalBounds=function(t,e,i){i.prototype=t.prototype;i=new i,e=t.apply(i,e);return Object(e)===e?e:i}(createjs.Rectangle,b.bounds,function(){}),b.frameBounds&&(s.frameBounds=function(){for(var t=b.frameBounds,e=[],i=0,n=t.length;i<n;i++)o=t[i],e.push(function(t,e,i){i.prototype=t.prototype;i=new i,e=t.apply(i,e);return Object(e)===e?e:i}(createjs.Rectangle,o,function(){}));return e}()),s},SpriteBuilder.prototype.dereferenceArgs=function(args,locals){var key,val;for(key in args)val=args[key],locals[val]?args[key]=locals[val]:null===val?args[key]={}:_.isString(val)&&0===val.indexOf("createjs.")?args[key]=eval(val):(_.isObject(val)||_.isArray(val))&&this.dereferenceArgs(val,locals);return args},SpriteBuilder.prototype.buildMovieClipShapes=function(t){for(var e,i,n={},r=0,s=t.length;r<s;r++)(e=t[r]).im?(i=new createjs.Shape)._off=!0:(i=this.buildShapeFromStore(e.gn),e.m&&(i.mask=n[e.m])),n[e.bn]=i;return n},SpriteBuilder.prototype.buildMovieClipContainers=function(t){for(var e,i,n={},r=0,s=t.length;r<s;r++)i=t[r],(e=this.buildContainerFromStore(i.gn)).setTransform.apply(e,i.t),null!=i.o&&(e._off=i.o),null!=i.al&&(e.alpha=i.al),n[i.bn]=e;return n},SpriteBuilder.prototype.buildMovieClipAnimations=function(t){for(var e,i,n={},r=0,s=t.length;r<s;r++)i=t[r],(e=this.buildMovieClip.apply(this,[i.gn].concat(slice.call(i.a)))).setTransform.apply(e,i.t),i.off&&(e._off=!0),n[i.bn]=e;return n},SpriteBuilder.prototype.buildMovieClipGraphics=function(t){for(var e,i,n={},r=0,s=t.length;r<s;r++)i=t[r],e=(new createjs.Graphics).p(i.p),n[i.bn]=e;return n},SpriteBuilder.prototype.buildShapeFromStore=function(t,e){var i,n,r,s;return null==e&&(e=!1),s=this.shapeStore[t],r=new createjs.Shape,null!=s.lf?(e=r.graphics).lf.apply(e,s.lf):null!=s.fc?r.graphics.f(this.colorMap[t]||s.fc):null!=s.rf&&(i=r.graphics).rf.apply(i,s.rf),null!=s.ls?(i=r.graphics).ls.apply(i,s.ls):null!=s.sc&&r.graphics.s(s.sc),null!=s.ss&&(n=r.graphics).ss.apply(n,s.ss),null!=s.de&&(n=r.graphics).de.apply(n,s.de),null!=s.p&&r.graphics.p(s.p),r.setTransform.apply(r,s.t),r},SpriteBuilder.prototype.buildContainerFromStore=function(t){var e,i,n,r,s,a;for(t||console.error("Yo we don't have no containerKey"),t=this.containerStore[t],(n=new createjs.Container).initialize(),r=0,s=(a=t.c).length;r<s;r++){if(i=a[r],_.isString(i))e=this.buildShapeFromStore(i);else{if(!i.gn)continue;(e=this.buildContainerFromStore(i.gn)).setTransform.apply(e,i.t)}n.addChild(e)}return n.bounds=function(t,e,i){i.prototype=t.prototype;i=new i,e=t.apply(i,e);return Object(e)===e?e:i}(createjs.Rectangle,t.b,function(){}),n},SpriteBuilder.prototype.buildColorMaps=function(){var t,e,i,n,r;if(this.colorMap={},e=this.thangType.get("colorGroups"),!_.isEmpty(e)&&_.size(this.shapeStore)&&(t=this.options.colorConfig)){for(n in r=[],t)i=t[n],e[n]&&r.push(this.buildColorMapForGroup(e[n],i));return r}},SpriteBuilder.prototype.buildColorMapForGroup=function(t,e){var i;if(t.length)return i=this.initColorMap(t),this.adjustHuesForColorMap(i,e.hue),this.adjustValueForColorMap(i,1,e.saturation),this.adjustValueForColorMap(i,2,e.lightness),this.applyColorMap(t,i)},SpriteBuilder.prototype.initColorMap=function(t){for(var e,i,n={},r=0,s=t.length;r<s;r++)i=t[r],null==(e=this.shapeStore[i]).fc||n[e.fc]||(i=hexToHSL(e.fc),n[e.fc]=i);return n},SpriteBuilder.prototype.adjustHuesForColorMap=function(e,t){var i,n,r,s,a,o,h=function(){var t=[];for(s in e)a=e[s],t.push(a[0]);return t}();for(s in.5<Math.max(h)-Math.min(h)&&(h=function(){var t,e,i;if(r<.5)return r+1;for(i=[],t=0,e=h.length;t<e;t++)r=h[t],i.push(r);return i}()),i=sum(h)/h.length,n=(t=null==t?0:t)-(i%=1),o=[],e)a=e[s],o.push(a[0]=(a[0]+n+1)%1);return o},SpriteBuilder.prototype.adjustValueForColorMap=function(e,i,t){var n,r,s=function(){var t=[];for(n in e)r=e[n],t.push(r[i]);return t}(),a=(t=null==t?.5:t)-sum(s)/s.length,o=[];for(n in e)r=e[n],o.push(r[i]=Math.max(0,Math.min(1,r[i]+a)));return o},SpriteBuilder.prototype.applyColorMap=function(t,e){for(var i,n,r=[],s=0,a=t.length;s<a;s++)n=t[s],null!=(i=this.shapeStore[n]).fc&&e[i.fc]&&r.push(this.colorMap[n]=hslToHex(e[i.fc]));return r},SpriteBuilder}(),sum=function(t){return _.reduce(t,function(t,e){return t+e})}},1566:function(t,u,c){!function(o,h){var l;!function(){var t,a,i,e,R=window.createjs;
/*!
* createjs
* Visit http://createjs.com/ for documentation, updates and examples.
*
* Copyright (c) 2010 gskinner.com, inc.
*
* Permission is hereby granted, free of charge, to any person
* obtaining a copy of this software and associated documentation
* files (the "Software"), to deal in the Software without
* restriction, including without limitation the rights to use,
* copy, modify, merge, publish, distribute, sublicense, and/or sell
* copies of the Software, and to permit persons to whom the
* Software is furnished to do so, subject to the following
* conditions:
*
* The above copyright notice and this permission notice shall be
* included in all copies or substantial portions of the Software.
*
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
* EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
* OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
* NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
* HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
* WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
* FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
* OTHER DEALINGS IN THE SOFTWARE.
*/function n(t){this.DisplayObject_constructor(),"string"==typeof t?(this.image=document.createElement("img"),this.image.src=t):this.image=t,this.sourceRect=null,this._webGLRenderStyle=R.DisplayObject._StageGL_BITMAP}this.createjs=this.createjs||{},R.extend=function(t,e){"use strict";function i(){this.constructor=t}return i.prototype=e.prototype,t.prototype=new i},R.promote=function(t,e){"use strict";var i=t.prototype,n=Object.getPrototypeOf&&Object.getPrototypeOf(i)||i.__proto__;if(n)for(var r in i[(e+="_")+"constructor"]=n.constructor,n)i.hasOwnProperty(r)&&"function"==typeof n[r]&&(i[e+r]=n[r]);return t},R.indexOf=function(t,e){"use strict";for(var i=0,n=t.length;i<n;i++)if(e===t[i])return i;return-1},function(){"use strict";function t(){throw"UID cannot be instantiated"}t._nextID=0,t.get=function(){return t._nextID++},R.UID=t}(),R.deprecate=function(e,i){"use strict";return function(){var t="Deprecated property or method '"+i+"'. See docs for info.";return console&&(console.warn?console.warn(t):console.log(t)),e&&e.apply(this,arguments)}},function(){"use strict";function t(t,e,i){this.type=t,this.target=null,this.currentTarget=null,this.eventPhase=0,this.bubbles=!!e,this.cancelable=!!i,this.timeStamp=(new Date).getTime(),this.defaultPrevented=!1,this.propagationStopped=!1,this.immediatePropagationStopped=!1,this.removed=!1}var e=t.prototype;e.preventDefault=function(){this.defaultPrevented=this.cancelable&&!0},e.stopPropagation=function(){this.propagationStopped=!0},e.stopImmediatePropagation=function(){this.immediatePropagationStopped=this.propagationStopped=!0},e.remove=function(){this.removed=!0},e.clone=function(){return new t(this.type,this.bubbles,this.cancelable)},e.set=function(t){for(var e in t)this[e]=t[e];return this},e.toString=function(){return"[Event (type="+this.type+")]"},R.Event=t}(),function(){"use strict";function t(){this._listeners=null,this._captureListeners=null}var e=t.prototype;t.initialize=function(t){t.addEventListener=e.addEventListener,t.on=e.on,t.removeEventListener=t.off=e.removeEventListener,t.removeAllEventListeners=e.removeAllEventListeners,t.hasEventListener=e.hasEventListener,t.dispatchEvent=e.dispatchEvent,t._dispatchEvent=e._dispatchEvent,t.willTrigger=e.willTrigger},e.addEventListener=function(t,e,i){var n=i?this._captureListeners=this._captureListeners||{}:this._listeners=this._listeners||{},r=n[t];return r&&this.removeEventListener(t,e,i),(r=n[t])?r.push(e):n[t]=[e],e},e.on=function(t,e,i,n,r,s){return e.handleEvent&&(i=i||e,e=e.handleEvent),i=i||this,this.addEventListener(t,function(t){e.call(i,t,r),n&&t.remove()},s)},e.removeEventListener=function(t,e,i){var n=i?this._captureListeners:this._listeners;if(n){var r=n[t];if(r)for(var s=0,a=r.length;s<a;s++)if(r[s]==e){1==a?delete n[t]:r.splice(s,1);break}}},e.off=e.removeEventListener,e.removeAllEventListeners=function(t){t?(this._listeners&&delete this._listeners[t],this._captureListeners&&delete this._captureListeners[t]):this._listeners=this._captureListeners=null},e.dispatchEvent=function(t,e,i){if("string"==typeof t){var n=this._listeners;if(!(e||n&&n[t]))return!0;t=new R.Event(t,e,i)}else t.target&&t.clone&&(t=t.clone());try{t.target=this}catch(t){}if(t.bubbles&&this.parent){for(var r=this,s=[r];r.parent;)s.push(r=r.parent);for(var a=s.length,o=a-1;0<=o&&!t.propagationStopped;o--)s[o]._dispatchEvent(t,1+(0==o));for(o=1;o<a&&!t.propagationStopped;o++)s[o]._dispatchEvent(t,3)}else this._dispatchEvent(t,2);return!t.defaultPrevented},e.hasEventListener=function(t){var e=this._listeners,i=this._captureListeners;return!!(e&&e[t]||i&&i[t])},e.willTrigger=function(t){for(var e=this;e;){if(e.hasEventListener(t))return!0;e=e.parent}return!1},e.toString=function(){return"[EventDispatcher]"},e._dispatchEvent=function(t,e){var i,n=e<=2?this._captureListeners:this._listeners;if(t&&n&&(r=n[t.type])&&(i=r.length)){try{t.currentTarget=this}catch(t){}try{t.eventPhase=0|e}catch(t){}t.removed=!1;for(var r=r.slice(),s=0;s<i&&!t.immediatePropagationStopped;s++){var a=r[s];a.handleEvent?a.handleEvent(t):a(t),t.removed&&(this.off(t.type,a,1==e),t.removed=!1)}}2===e&&this._dispatchEvent(t,2.1)},R.EventDispatcher=t}(),function(){"use strict";function s(){throw"Ticker cannot be instantiated."}s.RAF_SYNCHED="synched",s.RAF="raf",s.TIMEOUT="timeout",s.timingMode=null,s.maxDelta=0,s.paused=!1,s.removeEventListener=null,s.removeAllEventListeners=null,s.dispatchEvent=null,s.hasEventListener=null,s._listeners=null,R.EventDispatcher.initialize(s),s._addEventListener=s.addEventListener,s.addEventListener=function(){return s._inited||s.init(),s._addEventListener.apply(s,arguments)},s._inited=!1,s._startTime=0,s._pausedTime=0,s._ticks=0,s._pausedTicks=0,s._interval=50,s._lastTime=0,s._times=null,s._tickTimes=null,s._timerId=null,s._raf=!0,s.setInterval=R.deprecate(s._setInterval=function(t){s._interval=t,s._inited&&s._setupTick()},"Ticker.setInterval"),s.getInterval=R.deprecate(s._getInterval=function(){return s._interval},"Ticker.getInterval"),s.setFPS=R.deprecate(s._setFPS=function(t){s._setInterval(1e3/t)},"Ticker.setFPS"),s.getFPS=R.deprecate(s._getFPS=function(){return 1e3/s._interval},"Ticker.getFPS");try{Object.defineProperties(s,{interval:{get:s._getInterval,set:s._setInterval},framerate:{get:s._getFPS,set:s._setFPS}})}catch(t){console.log(t)}s.init=function(){s._inited||(s._inited=!0,s._times=[],s._tickTimes=[],s._startTime=s._getTime(),s._times.push(s._lastTime=0),s.interval=s._interval)},s.reset=function(){var t;s._raf?(t=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame)&&t(s._timerId):clearTimeout(s._timerId),s.removeAllEventListeners("tick"),s._timerId=s._times=s._tickTimes=null,s._startTime=s._lastTime=s._ticks=s._pausedTime=0,s._inited=!1},s.getMeasuredTickTime=function(t){var e=0,i=s._tickTimes;if(!i||i.length<1)return-1;t=Math.min(i.length,t||0|s._getFPS());for(var n=0;n<t;n++)e+=i[n];return e/t},s.getMeasuredFPS=function(t){var e=s._times;return!e||e.length<2?-1:(t=Math.min(e.length-1,t||0|s._getFPS()),1e3/((e[0]-e[t])/t))},s.getTime=function(t){return s._startTime?s._getTime()-(t?s._pausedTime:0):-1},s.getEventTime=function(t){return s._startTime?(s._lastTime||s._startTime)-(t?s._pausedTime:0):-1},s.getTicks=function(t){return s._ticks-(t?s._pausedTicks:0)},s._handleSynch=function(){s._timerId=null,s._setupTick(),s._getTime()-s._lastTime>=.97*(s._interval-1)&&s._tick()},s._handleRAF=function(){s._timerId=null,s._setupTick(),s._tick()},s._handleTimeout=function(){s._timerId=null,s._setupTick(),s._tick()},s._setupTick=function(){if(null==s._timerId){var t=s.timingMode;if(t==s.RAF_SYNCHED||t==s.RAF){var e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame;if(e)return s._timerId=e(t==s.RAF?s._handleRAF:s._handleSynch),void(s._raf=!0)}s._raf=!1,s._timerId=setTimeout(s._handleTimeout,s._interval)}},s._tick=function(){var t,e,i=s.paused,n=s._getTime(),r=n-s._lastTime;for(s._lastTime=n,s._ticks++,i&&(s._pausedTicks++,s._pausedTime+=r),s.hasEventListener("tick")&&((t=new R.Event("tick")).delta=(e=s.maxDelta)&&e<r?e:r,t.paused=i,t.time=n,t.runTime=n-s._pausedTime,s.dispatchEvent(t)),s._tickTimes.unshift(s._getTime()-n);100<s._tickTimes.length;)s._tickTimes.pop();for(s._times.unshift(n);100<s._times.length;)s._times.pop()};var t=window,e=t.performance.now||t.performance.mozNow||t.performance.msNow||t.performance.oNow||t.performance.webkitNow;s._getTime=function(){return(e&&e.call(t.performance)||(new Date).getTime())-s._startTime},R.Ticker=s}(),function(){"use strict";function t(t){this.readyState=t.readyState,this._video=t,this._canvas=null,this._lastTime=-1,this.readyState<2&&t.addEventListener("canplaythrough",this._videoReady.bind(this))}var e=t.prototype;e.getImage=function(){if(!(this.readyState<2)){var t,e=this._canvas,i=this._video;return e||((e=this._canvas=R.createCanvas?R.createCanvas():document.createElement("canvas")).width=i.videoWidth,e.height=i.videoHeight),2<=i.readyState&&i.currentTime!==this._lastTime&&((t=e.getContext("2d")).clearRect(0,0,e.width,e.height),t.drawImage(i,0,0,e.width,e.height),this._lastTime=i.currentTime),e}},e._videoReady=function(){this.readyState=2},R.VideoBuffer=t}(),function(){"use strict";function t(t,e,i,n,r,s,a,o,h,l,u){this.Event_constructor(t,e,i),this.stageX=n,this.stageY=r,this.rawX=null==h?n:h,this.rawY=null==l?r:l,this.nativeEvent=s,this.pointerID=a,this.primary=!!o,this.relatedTarget=u}var e=R.extend(t,R.Event);e._get_localX=function(){return this.currentTarget.globalToLocal(this.rawX,this.rawY).x},e._get_localY=function(){return this.currentTarget.globalToLocal(this.rawX,this.rawY).y},e._get_isTouch=function(){return-1!==this.pointerID};try{Object.defineProperties(e,{localX:{get:e._get_localX},localY:{get:e._get_localY},isTouch:{get:e._get_isTouch}})}catch(t){}e.clone=function(){return new t(this.type,this.bubbles,this.cancelable,this.stageX,this.stageY,this.nativeEvent,this.pointerID,this.primary,this.rawX,this.rawY)},e.toString=function(){return"[MouseEvent (type="+this.type+" stageX="+this.stageX+" stageY="+this.stageY+")]"},R.MouseEvent=R.promote(t,"Event")}(),function(){"use strict";function c(t,e,i,n,r,s){this.setValues(t,e,i,n,r,s)}var t=c.prototype;c.DEG_TO_RAD=Math.PI/180,c.identity=null,t.setValues=function(t,e,i,n,r,s){return this.a=null==t?1:t,this.b=e||0,this.c=i||0,this.d=null==n?1:n,this.tx=r||0,this.ty=s||0,this},t.append=function(t,e,i,n,r,s){var a=this.a,o=this.b,h=this.c,l=this.d;return 1==t&&0==e&&0==i&&1==n||(this.a=a*t+h*e,this.b=o*t+l*e,this.c=a*i+h*n,this.d=o*i+l*n),this.tx=a*r+h*s+this.tx,this.ty=o*r+l*s+this.ty,this},t.prepend=function(t,e,i,n,r,s){var a=this.a,o=this.c,h=this.tx;return this.a=t*a+i*this.b,this.b=e*a+n*this.b,this.c=t*o+i*this.d,this.d=e*o+n*this.d,this.tx=t*h+i*this.ty+r,this.ty=e*h+n*this.ty+s,this},t.appendMatrix=function(t){return this.append(t.a,t.b,t.c,t.d,t.tx,t.ty)},t.prependMatrix=function(t){return this.prepend(t.a,t.b,t.c,t.d,t.tx,t.ty)},t.appendTransform=function(t,e,i,n,r,s,a,o,h){var l,u=r%360?(u=r*c.DEG_TO_RAD,l=Math.cos(u),Math.sin(u)):(l=1,0);return s||a?(s*=c.DEG_TO_RAD,a*=c.DEG_TO_RAD,this.append(Math.cos(a),Math.sin(a),-Math.sin(s),Math.cos(s),t,e),this.append(l*i,u*i,-u*n,l*n,0,0)):this.append(l*i,u*i,-u*n,l*n,t,e),(o||h)&&(this.tx-=o*this.a+h*this.c,this.ty-=o*this.b+h*this.d),this},t.prependTransform=function(t,e,i,n,r,s,a,o,h){var l,u=r%360?(u=r*c.DEG_TO_RAD,l=Math.cos(u),Math.sin(u)):(l=1,0);return(o||h)&&(this.tx-=o,this.ty-=h),s||a?(s*=c.DEG_TO_RAD,a*=c.DEG_TO_RAD,this.prepend(l*i,u*i,-u*n,l*n,0,0),this.prepend(Math.cos(a),Math.sin(a),-Math.sin(s),Math.cos(s),t,e)):this.prepend(l*i,u*i,-u*n,l*n,t,e),this},t.rotate=function(t){t*=c.DEG_TO_RAD;var e=Math.cos(t),i=Math.sin(t),n=this.a,t=this.b;return this.a=n*e+this.c*i,this.b=t*e+this.d*i,this.c=-n*i+this.c*e,this.d=-t*i+this.d*e,this},t.skew=function(t,e){return t*=c.DEG_TO_RAD,e*=c.DEG_TO_RAD,this.append(Math.cos(e),Math.sin(e),-Math.sin(t),Math.cos(t),0,0),this},t.scale=function(t,e){return this.a*=t,this.b*=t,this.c*=e,this.d*=e,this},t.translate=function(t,e){return this.tx+=this.a*t+this.c*e,this.ty+=this.b*t+this.d*e,this},t.identity=function(){return this.a=this.d=1,this.b=this.c=this.tx=this.ty=0,this},t.invert=function(){var t=this.a,e=this.b,i=this.c,n=this.d,r=this.tx,s=t*n-e*i;return this.a=n/s,this.b=-e/s,this.c=-i/s,this.d=t/s,this.tx=(i*this.ty-n*r)/s,this.ty=-(t*this.ty-e*r)/s,this},t.isIdentity=function(){return 0===this.tx&&0===this.ty&&1===this.a&&0===this.b&&0===this.c&&1===this.d},t.equals=function(t){return this.tx===t.tx&&this.ty===t.ty&&this.a===t.a&&this.b===t.b&&this.c===t.c&&this.d===t.d},t.transformPoint=function(t,e,i){return(i=i||{}).x=t*this.a+e*this.c+this.tx,i.y=t*this.b+e*this.d+this.ty,i},t.decompose=function(t){(t=null==t?{}:t).x=this.tx,t.y=this.ty,t.scaleX=Math.sqrt(this.a*this.a+this.b*this.b),t.scaleY=Math.sqrt(this.c*this.c+this.d*this.d);var e=Math.atan2(-this.c,this.d),i=Math.atan2(this.b,this.a);return Math.abs(1-e/i)<1e-5?(t.rotation=i/c.DEG_TO_RAD,this.a<0&&0<=this.d&&(t.rotation+=t.rotation<=0?180:-180),t.skewX=t.skewY=0):(t.skewX=e/c.DEG_TO_RAD,t.skewY=i/c.DEG_TO_RAD),t},t.copy=function(t){return this.setValues(t.a,t.b,t.c,t.d,t.tx,t.ty)},t.clone=function(){return new c(this.a,this.b,this.c,this.d,this.tx,this.ty)},t.toString=function(){return"[Matrix2D (a="+this.a+" b="+this.b+" c="+this.c+" d="+this.d+" tx="+this.tx+" ty="+this.ty+")]"},c.identity=new c,R.Matrix2D=c}(),function(){"use strict";function t(t,e,i,n,r){this.setValues(t,e,i,n,r)}var e=t.prototype;e.setValues=function(t,e,i,n,r){return this.visible=null==t||!!t,this.alpha=null==e?1:e,this.shadow=i,this.compositeOperation=n,this.matrix=r||this.matrix&&this.matrix.identity()||new R.Matrix2D,this},e.append=function(t,e,i,n,r){return this.alpha*=e,this.shadow=i||this.shadow,this.compositeOperation=n||this.compositeOperation,this.visible=this.visible&&t,r&&this.matrix.appendMatrix(r),this},e.prepend=function(t,e,i,n,r){return this.alpha*=e,this.shadow=this.shadow||i,this.compositeOperation=this.compositeOperation||n,this.visible=this.visible&&t,r&&this.matrix.prependMatrix(r),this},e.identity=function(){return this.visible=!0,this.alpha=1,this.shadow=this.compositeOperation=null,this.matrix.identity(),this},e.clone=function(){return new t(this.alpha,this.shadow,this.compositeOperation,this.visible,this.matrix.clone())},R.DisplayProps=t}(),function(){"use strict";function t(t,e){this.setValues(t,e)}var e=t.prototype;e.setValues=function(t,e){return this.x=t||0,this.y=e||0,this},e.copy=function(t){return this.x=t.x,this.y=t.y,this},e.clone=function(){return new t(this.x,this.y)},e.toString=function(){return"[Point (x="+this.x+" y="+this.y+")]"},R.Point=t}(),function(){"use strict";function r(t,e,i,n){this.setValues(t,e,i,n)}var t=r.prototype;t.setValues=function(t,e,i,n){return this.x=t||0,this.y=e||0,this.width=i||0,this.height=n||0,this},t.extend=function(t,e,i,n){return n=n||0,t+(i=i||0)>this.x+this.width&&(this.width=t+i-this.x),e+n>this.y+this.height&&(this.height=e+n-this.y),t<this.x&&(this.width+=this.x-t,this.x=t),e<this.y&&(this.height+=this.y-e,this.y=e),this},t.pad=function(t,e,i,n){return this.x-=e,this.y-=t,this.width+=e+n,this.height+=t+i,this},t.copy=function(t){return this.setValues(t.x,t.y,t.width,t.height)},t.contains=function(t,e,i,n){return i=i||0,n=n||0,t>=this.x&&t+i<=this.x+this.width&&e>=this.y&&e+n<=this.y+this.height},t.union=function(t){return this.clone().extend(t.x,t.y,t.width,t.height)},t.intersection=function(t){var e=t.x,i=t.y,n=e+t.width,t=i+t.height;return this.x>e&&(e=this.x),this.y>i&&(i=this.y),this.x+this.width<n&&(n=this.x+this.width),this.y+this.height<t&&(t=this.y+this.height),n<=e||t<=i?null:new r(e,i,n-e,t-i)},t.intersects=function(t){return t.x<=this.x+this.width&&this.x<=t.x+t.width&&t.y<=this.y+this.height&&this.y<=t.y+t.height},t.isEmpty=function(){return this.width<=0||this.height<=0},t.clone=function(){return new r(this.x,this.y,this.width,this.height)},t.toString=function(){return"[Rectangle (x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+")]"},R.Rectangle=r}(),function(){"use strict";function t(t,e,i,n,r,s,a){t.addEventListener&&(this.target=t,this.overLabel=null==i?"over":i,this.outLabel=null==e?"out":e,this.downLabel=null==n?"down":n,this.play=r,this._isPressed=!1,this._isOver=!1,this._enabled=!1,t.mouseChildren=!1,this.enabled=!0,this.handleEvent({}),s&&(a&&(s.actionsEnabled=!1,s.gotoAndStop&&s.gotoAndStop(a)),t.hitArea=s))}var e=t.prototype;e._setEnabled=function(t){var e;t!=this._enabled&&(e=this.target,(this._enabled=t)?(e.cursor="pointer",e.addEventListener("rollover",this),e.addEventListener("rollout",this),e.addEventListener("mousedown",this),e.addEventListener("pressup",this),e._reset&&(e.__reset=e._reset,e._reset=this._reset)):(e.cursor=null,e.removeEventListener("rollover",this),e.removeEventListener("rollout",this),e.removeEventListener("mousedown",this),e.removeEventListener("pressup",this),e.__reset&&(e._reset=e.__reset,delete e.__reset)))},e.setEnabled=R.deprecate(e._setEnabled,"ButtonHelper.setEnabled"),e._getEnabled=function(){return this._enabled},e.getEnabled=R.deprecate(e._getEnabled,"ButtonHelper.getEnabled");try{Object.defineProperties(e,{enabled:{get:e._getEnabled,set:e._setEnabled}})}catch(t){}e.toString=function(){return"[ButtonHelper]"},e.handleEvent=function(t){var e=this.target,t=t.type,t="mousedown"==t?(this._isPressed=!0,this.downLabel):"pressup"==t?(this._isPressed=!1,this._isOver?this.overLabel:this.outLabel):"rollover"==t?(this._isOver=!0,this._isPressed?this.downLabel:this.overLabel):(this._isOver=!1,this._isPressed?this.overLabel:this.outLabel);this.play?e.gotoAndPlay&&e.gotoAndPlay(t):e.gotoAndStop&&e.gotoAndStop(t)},e._reset=function(){var t=this.paused;this.__reset(),this.paused=t},R.ButtonHelper=t}(),function(){"use strict";function t(t,e,i,n){this.color=t||"black",this.offsetX=e||0,this.offsetY=i||0,this.blur=n||0}var e=t.prototype;t.identity=new t("transparent",0,0,0),e.toString=function(){return"[Shadow]"},e.clone=function(){return new t(this.color,this.offsetX,this.offsetY,this.blur)},R.Shadow=t}(),function(){"use strict";function t(t){this.EventDispatcher_constructor(),this.complete=!0,this.framerate=0,this._animations=null,this._frames=null,this._images=null,this._data=null,this._loadCount=0,this._frameHeight=0,this._frameWidth=0,this._numFrames=0,this._regX=0,this._regY=0,this._spacing=0,this._margin=0,this._parseData(t)}var e=R.extend(t,R.EventDispatcher);e._getAnimations=function(){return this._animations.slice()},e.getAnimations=R.deprecate(e._getAnimations,"SpriteSheet.getAnimations");try{Object.defineProperties(e,{animations:{get:e._getAnimations}})}catch(t){}e.getNumFrames=function(t){if(null==t)return this._frames?this._frames.length:this._numFrames||0;t=this._data[t];return null==t?0:t.frames.length},e.getAnimation=function(t){return this._data[t]},e.getFrame=function(t){var e;return this._frames&&(e=this._frames[t])?e:null},e.getFrameBounds=function(t,e){t=this.getFrame(t);return t?(e||new R.Rectangle).setValues(-t.regX,-t.regY,t.rect.width,t.rect.height):null},e.toString=function(){return"[SpriteSheet]"},e.clone=function(){throw"SpriteSheet cannot be cloned."},e._parseData=function(t){var e,i,n,r;if(null!=t){if(this.framerate=t.framerate||0,t.images&&0<(i=t.images.length))for(c=this._images=[],e=0;e<i;e++){var s,a=t.images[e];"string"==typeof a&&(s=a,(a=document.createElement("img")).src=s),c.push(a),a.getContext||a.naturalWidth||(this._loadCount++,this.complete=!1,function(t,e){a.onload=function(){t._handleImageLoad(e)}}(this,s),function(t,e){a.onerror=function(){t._handleImageError(e)}}(this,s))}if(null!=t.frames)if(Array.isArray(t.frames))for(this._frames=[],e=0,i=(c=t.frames).length;e<i;e++){var o=c[e];this._frames.push({image:this._images[o[4]||0],rect:new R.Rectangle(o[0],o[1],o[2],o[3]),regX:o[5]||0,regY:o[6]||0})}else n=t.frames,this._frameWidth=n.width,this._frameHeight=n.height,this._regX=n.regX||0,this._regY=n.regY||0,this._spacing=n.spacing||0,this._margin=n.margin||0,this._numFrames=n.count,0==this._loadCount&&this._calculateFrames();if(this._animations=[],null!=(n=t.animations))for(r in this._data={},n){var h={name:r},l=n[r];if("number"==typeof l)c=h.frames=[l];else if(Array.isArray(l))if(1==l.length)h.frames=[l[0]];else for(h.speed=l[3],h.next=l[2],c=h.frames=[],e=l[0];e<=l[1];e++)c.push(e);else{h.speed=l.speed,h.next=l.next;var u=l.frames,c=h.frames="number"==typeof u?[u]:u.slice(0)}!0!==h.next&&void 0!==h.next||(h.next=r),(!1===h.next||c.length<2&&h.next==r)&&(h.next=null),h.speed||(h.speed=1),this._animations.push(r),this._data[r]=h}}},e._handleImageLoad=function(t){0==--this._loadCount&&(this._calculateFrames(),this.complete=!0,this.dispatchEvent("complete"))},e._handleImageError=function(t){var e=new R.Event("error");e.src=t,this.dispatchEvent(e),0==--this._loadCount&&this.dispatchEvent("complete")},e._calculateFrames=function(){if(!this._frames&&0!=this._frameWidth){this._frames=[];var t=this._numFrames||1e5,e=0,i=this._frameWidth,n=this._frameHeight,r=this._spacing,s=this._margin;t:for(var a=0,o=this._images;a<o.length;a++)for(var h=o[a],l=h.width||h.naturalWidth,u=h.height||h.naturalHeight,c=s;c<=u-s-n;){for(var d=s;d<=l-s-i;){if(t<=e)break t;e++,this._frames.push({image:h,rect:new R.Rectangle(d,c,i,n),regX:this._regX,regY:this._regY}),d+=i+r}c+=n+r}this._numFrames=e}},R.SpriteSheet=R.promote(t,"EventDispatcher")}(),function(){"use strict";function v(){this.command=null,this._stroke=null,this._strokeStyle=null,this._oldStrokeStyle=null,this._strokeDash=null,this._oldStrokeDash=null,this._strokeIgnoreScale=!1,this._fill=null,this._instructions=[],this._commitIndex=0,this._activeInstructions=[],this._dirty=!1,this._storeIndex=0,this.clear()}var t=v.prototype,h=v;v.getRGB=function(t,e,i,n){return null!=t&&null==i&&(n=e,i=255&t,e=t>>8&255,t=t>>16&255),null==n?"rgb("+t+","+e+","+i+")":"rgba("+t+","+e+","+i+","+n+")"},v.getHSL=function(t,e,i,n){return null==n?"hsl("+t%360+","+e+"%,"+i+"%)":"hsla("+t%360+","+e+"%,"+i+"%,"+n+")"},v.BASE_64={A:0,B:1,C:2,D:3,E:4,F:5,G:6,H:7,I:8,J:9,K:10,L:11,M:12,N:13,O:14,P:15,Q:16,R:17,S:18,T:19,U:20,V:21,W:22,X:23,Y:24,Z:25,a:26,b:27,c:28,d:29,e:30,f:31,g:32,h:33,i:34,j:35,k:36,l:37,m:38,n:39,o:40,p:41,q:42,r:43,s:44,t:45,u:46,v:47,w:48,x:49,y:50,z:51,0:52,1:53,2:54,3:55,4:56,5:57,6:58,7:59,8:60,9:61,"+":62,"/":63},v.STROKE_CAPS_MAP=["butt","round","square"],v.STROKE_JOINTS_MAP=["miter","round","bevel"];var e=R.createCanvas?R.createCanvas():document.createElement("canvas");e.getContext&&(v._ctx=e.getContext("2d"),e.width=e.height=1),t._getInstructions=function(){return this._updateInstructions(),this._instructions},t.getInstructions=R.deprecate(t._getInstructions,"Graphics.getInstructions");try{Object.defineProperties(t,{instructions:{get:t._getInstructions}})}catch(t){}t.isEmpty=function(){return!(this._instructions.length||this._activeInstructions.length)},t.draw=function(t,e){this._updateInstructions();for(var i=this._instructions,n=this._storeIndex,r=i.length;n<r;n++)i[n].exec(t,e)},t.drawAsPath=function(t){this._updateInstructions();for(var e,i=this._instructions,n=this._storeIndex,r=i.length;n<r;n++)!1!==(e=i[n]).path&&e.exec(t)},t.moveTo=function(t,e){return this.append(new h.MoveTo(t,e),!0)},t.lineTo=function(t,e){return this.append(new h.LineTo(t,e))},t.arcTo=function(t,e,i,n,r){return this.append(new h.ArcTo(t,e,i,n,r))},t.arc=function(t,e,i,n,r,s){return this.append(new h.Arc(t,e,i,n,r,s))},t.quadraticCurveTo=function(t,e,i,n){return this.append(new h.QuadraticCurveTo(t,e,i,n))},t.bezierCurveTo=function(t,e,i,n,r,s){return this.append(new h.BezierCurveTo(t,e,i,n,r,s))},t.rect=function(t,e,i,n){return this.append(new h.Rect(t,e,i,n))},t.closePath=function(){return this._activeInstructions.length?this.append(new h.ClosePath):this},t.clear=function(){return this._instructions.length=this._activeInstructions.length=this._commitIndex=0,this._strokeStyle=this._oldStrokeStyle=this._stroke=this._fill=this._strokeDash=this._oldStrokeDash=null,this._dirty=this._strokeIgnoreScale=!1,this},t.beginFill=function(t){return this._setFill(t?new h.Fill(t):null)},t.beginLinearGradientFill=function(t,e,i,n,r,s){return this._setFill((new h.Fill).linearGradient(t,e,i,n,r,s))},t.beginRadialGradientFill=function(t,e,i,n,r,s,a,o){return this._setFill((new h.Fill).radialGradient(t,e,i,n,r,s,a,o))},t.beginBitmapFill=function(t,e,i){return this._setFill(new h.Fill(null,i).bitmap(t,e))},t.endFill=function(){return this.beginFill()},t.setStrokeStyle=function(t,e,i,n,r){return this._updateInstructions(!0),this._strokeStyle=this.command=new h.StrokeStyle(t,e,i,n,r),this._stroke&&(this._stroke.ignoreScale=r),this._strokeIgnoreScale=r,this},t.setStrokeDash=function(t,e){return this._updateInstructions(!0),this._strokeDash=this.command=new h.StrokeDash(t,e),this},t.beginStroke=function(t){return this._setStroke(t?new h.Stroke(t):null)},t.beginLinearGradientStroke=function(t,e,i,n,r,s){return this._setStroke((new h.Stroke).linearGradient(t,e,i,n,r,s))},t.beginRadialGradientStroke=function(t,e,i,n,r,s,a,o){return this._setStroke((new h.Stroke).radialGradient(t,e,i,n,r,s,a,o))},t.beginBitmapStroke=function(t,e){return this._setStroke((new h.Stroke).bitmap(t,e))},t.endStroke=function(){return this.beginStroke()},t.curveTo=t.quadraticCurveTo,t.drawRect=t.rect,t.drawRoundRect=function(t,e,i,n,r){return this.drawRoundRectComplex(t,e,i,n,r,r,r,r)},t.drawRoundRectComplex=function(t,e,i,n,r,s,a,o){return this.append(new h.RoundRect(t,e,i,n,r,s,a,o))},t.drawCircle=function(t,e,i){return this.append(new h.Circle(t,e,i))},t.drawEllipse=function(t,e,i,n){return this.append(new h.Ellipse(t,e,i,n))},t.drawPolyStar=function(t,e,i,n,r,s){return this.append(new h.PolyStar(t,e,i,n,r,s))},t.append=function(t,e){return this._activeInstructions.push(t),this.command=t,e||(this._dirty=!0),this},t.decodePath=function(t){for(var e=[this.moveTo,this.lineTo,this.quadraticCurveTo,this.bezierCurveTo,this.closePath],i=[2,2,4,6,0],n=0,r=t.length,s=[],a=0,o=0,h=v.BASE_64;n<r;){var l=t.charAt(n),u=h[l],c=u>>3,d=e[c];if(!d||3&u)throw"bad path data (@"+n+"): "+l;var p=i[c];c||(a=o=0),n++;for(var _=2+(u>>2&1),f=s.length=0;f<p;f++){var g=(m=h[t.charAt(n)])>>5?-1:1,m=(31&m)<<6|h[t.charAt(n+1)];m=g*(m=3==_?m<<6|h[t.charAt(n+2)]:m)/10,f%2?a=m+=a:o=m+=o,s[f]=m,n+=_}d.apply(this,s)}return this},t.store=function(){return this._updateInstructions(!0),this._storeIndex=this._instructions.length,this},t.unstore=function(){return this._storeIndex=0,this},t.clone=function(){var t=new v;return t.command=this.command,t._stroke=this._stroke,t._strokeStyle=this._strokeStyle,t._strokeDash=this._strokeDash,t._strokeIgnoreScale=this._strokeIgnoreScale,t._fill=this._fill,t._instructions=this._instructions.slice(),t._commitIndex=this._commitIndex,t._activeInstructions=this._activeInstructions.slice(),t._dirty=this._dirty,t._storeIndex=this._storeIndex,t},t.toString=function(){return"[Graphics]"},t.mt=t.moveTo,t.lt=t.lineTo,t.at=t.arcTo,t.bt=t.bezierCurveTo,t.qt=t.quadraticCurveTo,t.a=t.arc,t.r=t.rect,t.cp=t.closePath,t.c=t.clear,t.f=t.beginFill,t.lf=t.beginLinearGradientFill,t.rf=t.beginRadialGradientFill,t.bf=t.beginBitmapFill,t.ef=t.endFill,t.ss=t.setStrokeStyle,t.sd=t.setStrokeDash,t.s=t.beginStroke,t.ls=t.beginLinearGradientStroke,t.rs=t.beginRadialGradientStroke,t.bs=t.beginBitmapStroke,t.es=t.endStroke,t.dr=t.drawRect,t.rr=t.drawRoundRect,t.rc=t.drawRoundRectComplex,t.dc=t.drawCircle,t.de=t.drawEllipse,t.dp=t.drawPolyStar,t.p=t.decodePath,t._updateInstructions=function(t){var e=this._instructions,i=this._activeInstructions,n=this._commitIndex;if(this._dirty&&i.length){e.length=n,e.push(v.beginCmd);var r=i.length,s=e.length;e.length=s+r;for(var a=0;a<r;a++)e[a+s]=i[a];this._fill&&e.push(this._fill),this._stroke&&(this._strokeDash!==this._oldStrokeDash&&e.push(this._strokeDash),this._strokeStyle!==this._oldStrokeStyle&&e.push(this._strokeStyle),t&&(this._oldStrokeStyle=this._strokeStyle,this._oldStrokeDash=this._strokeDash),e.push(this._stroke)),this._dirty=!1}t&&(i.length=0,this._commitIndex=e.length)},t._setFill=function(t){return this._updateInstructions(!0),this.command=this._fill=t,this},t._setStroke=function(t){return this._updateInstructions(!0),(this.command=this._stroke=t)&&(t.ignoreScale=this._strokeIgnoreScale),this},(h.LineTo=function(t,e){this.x=t,this.y=e}).prototype.exec=function(t){t.lineTo(this.x,this.y)},(h.MoveTo=function(t,e){this.x=t,this.y=e}).prototype.exec=function(t){t.moveTo(this.x,this.y)},(h.ArcTo=function(t,e,i,n,r){this.x1=t,this.y1=e,this.x2=i,this.y2=n,this.radius=r}).prototype.exec=function(t){t.arcTo(this.x1,this.y1,this.x2,this.y2,this.radius)},(h.Arc=function(t,e,i,n,r,s){this.x=t,this.y=e,this.radius=i,this.startAngle=n,this.endAngle=r,this.anticlockwise=!!s}).prototype.exec=function(t){t.arc(this.x,this.y,this.radius,this.startAngle,this.endAngle,this.anticlockwise)},(h.QuadraticCurveTo=function(t,e,i,n){this.cpx=t,this.cpy=e,this.x=i,this.y=n}).prototype.exec=function(t){t.quadraticCurveTo(this.cpx,this.cpy,this.x,this.y)},(h.BezierCurveTo=function(t,e,i,n,r,s){this.cp1x=t,this.cp1y=e,this.cp2x=i,this.cp2y=n,this.x=r,this.y=s}).prototype.exec=function(t){t.bezierCurveTo(this.cp1x,this.cp1y,this.cp2x,this.cp2y,this.x,this.y)},(h.Rect=function(t,e,i,n){this.x=t,this.y=e,this.w=i,this.h=n}).prototype.exec=function(t){t.rect(this.x,this.y,this.w,this.h)},(h.ClosePath=function(){}).prototype.exec=function(t){t.closePath()},(h.BeginPath=function(){}).prototype.exec=function(t){t.beginPath()},(t=(h.Fill=function(t,e){this.style=t,this.matrix=e}).prototype).exec=function(t){var e;this.style&&(t.fillStyle=this.style,(e=this.matrix)&&(t.save(),t.transform(e.a,e.b,e.c,e.d,e.tx,e.ty)),t.fill(),e&&t.restore())},t.linearGradient=function(t,e,i,n,r,s){for(var a=this.style=v._ctx.createLinearGradient(i,n,r,s),o=0,h=t.length;o<h;o++)a.addColorStop(e[o],t[o]);return a.props={colors:t,ratios:e,x0:i,y0:n,x1:r,y1:s,type:"linear"},this},t.radialGradient=function(t,e,i,n,r,s,a,o){for(var h=this.style=v._ctx.createRadialGradient(i,n,r,s,a,o),l=0,u=t.length;l<u;l++)h.addColorStop(e[l],t[l]);return h.props={colors:t,ratios:e,x0:i,y0:n,r0:r,x1:s,y1:a,r1:o,type:"radial"},this},t.bitmap=function(t,e){return(t.naturalWidth||t.getContext||2<=t.readyState)&&((this.style=v._ctx.createPattern(t,e||"")).props={image:t,repetition:e,type:"bitmap"}),this},t.path=!1,(t=(h.Stroke=function(t,e){this.style=t,this.ignoreScale=e}).prototype).exec=function(t){this.style&&(t.strokeStyle=this.style,this.ignoreScale&&(t.save(),t.setTransform(1,0,0,1,0,0)),t.stroke(),this.ignoreScale&&t.restore())},t.linearGradient=h.Fill.prototype.linearGradient,t.radialGradient=h.Fill.prototype.radialGradient,t.bitmap=h.Fill.prototype.bitmap,t.path=!1,(t=(h.StrokeStyle=function(t,e,i,n,r){this.width=t,this.caps=e,this.joints=i,this.miterLimit=n,this.ignoreScale=r}).prototype).exec=function(t){t.lineWidth=null==this.width?"1":this.width,t.lineCap=null==this.caps?"butt":isNaN(this.caps)?this.caps:v.STROKE_CAPS_MAP[this.caps],t.lineJoin=null==this.joints?"miter":isNaN(this.joints)?this.joints:v.STROKE_JOINTS_MAP[this.joints],t.miterLimit=null==this.miterLimit?"10":this.miterLimit,t.ignoreScale=null!=this.ignoreScale&&this.ignoreScale},t.path=!1,(h.StrokeDash=function(t,e){this.segments=t,this.offset=e||0}).prototype.exec=function(t){t.setLineDash&&(t.setLineDash(this.segments||h.StrokeDash.EMPTY_SEGMENTS),t.lineDashOffset=this.offset||0)},h.StrokeDash.EMPTY_SEGMENTS=[],(h.RoundRect=function(t,e,i,n,r,s,a,o){this.x=t,this.y=e,this.w=i,this.h=n,this.radiusTL=r,this.radiusTR=s,this.radiusBR=a,this.radiusBL=o}).prototype.exec=function(t){var e=(h<l?h:l)/2,i=0,n=0,r=0,s=0,a=this.x,o=this.y,h=this.w,l=this.h,u=this.radiusTL,c=this.radiusTR,d=this.radiusBR,p=this.radiusBL;u<0&&(u*=i=-1),e<u&&(u=e),c<0&&(c*=n=-1),d<0&&(d*=r=-1),e<d&&(d=e),p<0&&(p*=s=-1),e<p&&(p=e),t.moveTo(a+h-(c=e<c?e:c),o),t.arcTo(a+h+c*n,o-c*n,a+h,o+c,c),t.lineTo(a+h,o+l-d),t.arcTo(a+h+d*r,o+l+d*r,a+h-d,o+l,d),t.lineTo(a+p,o+l),t.arcTo(a-p*s,o+l+p*s,a,o+l-p,p),t.lineTo(a,o+u),t.arcTo(a-u*i,o-u*i,a+u,o,u),t.closePath()},(h.Circle=function(t,e,i){this.x=t,this.y=e,this.radius=i}).prototype.exec=function(t){t.arc(this.x,this.y,this.radius,0,2*Math.PI)},(h.Ellipse=function(t,e,i,n){this.x=t,this.y=e,this.w=i,this.h=n}).prototype.exec=function(t){var e=this.x,i=this.y,n=this.w,r=this.h,s=n/2*.5522848,a=r/2*.5522848,o=e+n,h=i+r,n=e+n/2,r=i+r/2;t.moveTo(e,r),t.bezierCurveTo(e,r-a,n-s,i,n,i),t.bezierCurveTo(n+s,i,o,r-a,o,r),t.bezierCurveTo(o,r+a,n+s,h,n,h),t.bezierCurveTo(n-s,h,e,r+a,e,r)},(h.PolyStar=function(t,e,i,n,r,s){this.x=t,this.y=e,this.radius=i,this.sides=n,this.pointSize=r,this.angle=s}).prototype.exec=function(t){var e=this.x,i=this.y,n=this.radius,r=(this.angle||0)/180*Math.PI,s=this.sides,a=1-(this.pointSize||0),o=Math.PI/s;t.moveTo(e+Math.cos(r)*n,i+Math.sin(r)*n);for(var h=0;h<s;h++)r+=o,1!=a&&t.lineTo(e+Math.cos(r)*n*a,i+Math.sin(r)*n*a),r+=o,t.lineTo(e+Math.cos(r)*n,i+Math.sin(r)*n);t.closePath()},v.beginCmd=new h.BeginPath,R.Graphics=v}(),function(){"use strict";function s(){this.EventDispatcher_constructor(),this.alpha=1,this.cacheCanvas=null,this.bitmapCache=null,this.id=R.UID.get(),this.mouseEnabled=!0,this.tickEnabled=!0,this.name=null,this.parent=null,this.regX=0,this.regY=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.skewX=0,this.skewY=0,this.shadow=null,this.visible=!0,this.x=0,this.y=0,this.transformMatrix=null,this.compositeOperation=null,this.snapToPixel=!0,this.filters=null,this.mask=null,this.hitArea=null,this.cursor=null,this._props=new R.DisplayProps,this._rectangle=new R.Rectangle,this._bounds=null,this._webGLRenderStyle=s._StageGL_NONE}var t=R.extend(s,R.EventDispatcher);s._MOUSE_EVENTS=["click","dblclick","mousedown","mouseout","mouseover","pressmove","pressup","rollout","rollover"],s.suppressCrossDomainErrors=!1,s._snapToPixelEnabled=!1,s._StageGL_NONE=0,s._StageGL_SPRITE=1,s._StageGL_BITMAP=2;var e=R.createCanvas?R.createCanvas():document.createElement("canvas");e.getContext&&(s._hitTestCanvas=e,s._hitTestContext=e.getContext("2d"),e.width=e.height=1),t._getStage=function(){for(var t=this,e=R.Stage;t.parent;)t=t.parent;return t instanceof e?t:null},t.getStage=R.deprecate(t._getStage,"DisplayObject.getStage");try{Object.defineProperties(t,{stage:{get:t._getStage},cacheID:{get:function(){return this.bitmapCache&&this.bitmapCache.cacheID},set:function(t){this.bitmapCache&&(this.bitmapCache.cacheID=t)}},scale:{get:function(){return this.scaleX},set:function(t){this.scaleX=this.scaleY=t}}})}catch(t){}t.isVisible=function(){return!!(this.visible&&0<this.alpha&&0!=this.scaleX&&0!=this.scaleY)},t.draw=function(t,e){var i=this.bitmapCache;return!(!i||e)&&i.draw(t)},t.updateContext=function(t){var e=this,i=e.mask,n=e._props.matrix;i&&i.graphics&&!i.graphics.isEmpty()&&(i.getMatrix(n),t.transform(n.a,n.b,n.c,n.d,n.tx,n.ty),i.graphics.drawAsPath(t),t.clip(),n.invert(),t.transform(n.a,n.b,n.c,n.d,n.tx,n.ty)),this.getMatrix(n);var r=n.tx,i=n.ty;s._snapToPixelEnabled&&e.snapToPixel&&(r=r+(r<0?-.5:.5)|0,i=i+(i<0?-.5:.5)|0),t.transform(n.a,n.b,n.c,n.d,r,i),t.globalAlpha*=e.alpha,e.compositeOperation&&(t.globalCompositeOperation=e.compositeOperation),e.shadow&&this._applyShadow(t,e.shadow)},t.cache=function(t,e,i,n,r,s){this.bitmapCache||(this.bitmapCache=new R.BitmapCache),this.bitmapCache.define(this,t,e,i,n,r,s)},t.updateCache=function(t){if(!this.bitmapCache)throw"cache() must be called before updateCache()";this.bitmapCache.update(t)},t.uncache=function(){this.bitmapCache&&(this.bitmapCache.release(),this.bitmapCache=void 0)},t.getCacheDataURL=function(){return this.bitmapCache?this.bitmapCache.getDataURL():null},t.localToGlobal=function(t,e,i){return this.getConcatenatedMatrix(this._props.matrix).transformPoint(t,e,i||new R.Point)},t.globalToLocal=function(t,e,i){return this.getConcatenatedMatrix(this._props.matrix).invert().transformPoint(t,e,i||new R.Point)},t.localToLocal=function(t,e,i,n){return n=this.localToGlobal(t,e,n),i.globalToLocal(n.x,n.y,n)},t.setTransform=function(t,e,i,n,r,s,a,o,h){return this.x=t||0,this.y=e||0,this.scaleX=null==i?1:i,this.scaleY=null==n?1:n,this.rotation=r||0,this.skewX=s||0,this.skewY=a||0,this.regX=o||0,this.regY=h||0,this},t.getMatrix=function(t){var e=this,t=t&&t.identity()||new R.Matrix2D;return e.transformMatrix?t.copy(e.transformMatrix):t.appendTransform(e.x,e.y,e.scaleX,e.scaleY,e.rotation,e.skewX,e.skewY,e.regX,e.regY)},t.getConcatenatedMatrix=function(t){for(var e=this,i=this.getMatrix(t);e=e.parent;)i.prependMatrix(e.getMatrix(e._props.matrix));return i},t.getConcatenatedDisplayProps=function(t){t=t?t.identity():new R.DisplayProps;for(var e=this,i=e.getMatrix(t.matrix);t.prepend(e.visible,e.alpha,e.shadow,e.compositeOperation),e!=this&&i.prependMatrix(e.getMatrix(e._props.matrix)),e=e.parent;);return t},t.hitTest=function(t,e){var i=s._hitTestContext;i.setTransform(1,0,0,1,-t,-e),this.draw(i);e=this._testHit(i);return i.setTransform(1,0,0,1,0,0),i.clearRect(0,0,2,2),e},t.set=function(t){for(var e in t)this[e]=t[e];return this},t.getBounds=function(){if(this._bounds)return this._rectangle.copy(this._bounds);var t=this.cacheCanvas;if(t){var e=this._cacheScale;return this._rectangle.setValues(this._cacheOffsetX,this._cacheOffsetY,t.width/e,t.height/e)}return null},t.getTransformedBounds=function(){return this._getBounds()},t.setBounds=function(t,e,i,n){this._bounds=null!=t?(this._bounds||new R.Rectangle).setValues(t,e,i,n):t},t.clone=function(){return this._cloneProps(new s)},t.toString=function(){return"[DisplayObject (name="+this.name+")]"},t._updateState=null,t._cloneProps=function(t){return t.alpha=this.alpha,t.mouseEnabled=this.mouseEnabled,t.tickEnabled=this.tickEnabled,t.name=this.name,t.regX=this.regX,t.regY=this.regY,t.rotation=this.rotation,t.scaleX=this.scaleX,t.scaleY=this.scaleY,t.shadow=this.shadow,t.skewX=this.skewX,t.skewY=this.skewY,t.visible=this.visible,t.x=this.x,t.y=this.y,t.compositeOperation=this.compositeOperation,t.snapToPixel=this.snapToPixel,t.filters=null==this.filters?null:this.filters.slice(0),t.mask=this.mask,t.hitArea=this.hitArea,t.cursor=this.cursor,t._bounds=this._bounds,t},t._applyShadow=function(t,e){e=e||Shadow.identity,t.shadowColor=e.color,t.shadowOffsetX=e.offsetX,t.shadowOffsetY=e.offsetY,t.shadowBlur=e.blur},t._tick=function(t){var e=this._listeners;e&&e.tick&&(t.target=null,t.propagationStopped=t.immediatePropagationStopped=!1,this.dispatchEvent(t))},t._testHit=function(t){try{var e=1<t.getImageData(0,0,1,1).data[3]}catch(t){if(!s.suppressCrossDomainErrors)throw"An error has occurred. This is most likely due to security restrictions on reading canvas pixel data with local or cross-domain images."}return e},t._getBounds=function(t,e){return this._transformBounds(this.getBounds(),t,e)},t._transformBounds=function(t,e,i){if(!t)return t;var n=t.x,r=t.y,s=t.width,a=t.height,o=this._props.matrix,o=i?o.identity():this.getMatrix(o);(n||r)&&o.appendTransform(0,0,1,1,0,0,0,-n,-r),e&&o.prependMatrix(e);var h=s*o.a,l=s*o.b,u=a*o.c,c=a*o.d,d=o.tx,i=o.ty,e=d,s=d,a=i,o=i;return(n=h+d)<e?e=n:s<n&&(s=n),(n=h+u+d)<e?e=n:s<n&&(s=n),(n=u+d)<e?e=n:s<n&&(s=n),(r=l+i)<a?a=r:o<r&&(o=r),(r=l+c+i)<a?a=r:o<r&&(o=r),(r=c+i)<a?a=r:o<r&&(o=r),t.setValues(e,a,s-e,o-a)},t._hasMouseEventListener=function(){for(var t=s._MOUSE_EVENTS,e=0,i=t.length;e<i;e++)if(this.hasEventListener(t[e]))return!0;return!!this.cursor},R.DisplayObject=R.promote(s,"EventDispatcher")}(),function(){"use strict";function b(){this.DisplayObject_constructor(),this.children=[],this.mouseChildren=!0,this.tickChildren=!0}var t=R.extend(b,R.DisplayObject);t._getNumChildren=function(){return this.children.length},t.getNumChildren=R.deprecate(t._getNumChildren,"Container.getNumChildren");try{Object.defineProperties(t,{numChildren:{get:t._getNumChildren}})}catch(t){}t.initialize=b,t.isVisible=function(){var t=this.cacheCanvas||this.children.length;return!!(this.visible&&0<this.alpha&&0!=this.scaleX&&0!=this.scaleY&&t)},t.draw=function(t,e){if(this.DisplayObject_draw(t,e))return!0;for(var i=this.children.slice(),n=0,r=i.length;n<r;n++){var s=i[n];s.isVisible()&&(t.save(),s.updateContext(t),s.draw(t),t.restore())}return!0},t.addChild=function(t){if(null==t)return t;var e=arguments.length;if(1<e){for(var i=0;i<e;i++)this.addChild(arguments[i]);return arguments[e-1]}var n=t.parent,r=n===this;return n&&n._removeChildAt(R.indexOf(n.children,t),r),(t.parent=this).children.push(t),r||t.dispatchEvent("added"),t},t.addChildAt=function(t,e){var i=arguments.length,n=arguments[i-1];if(n<0||n>this.children.length)return arguments[i-2];if(2<i){for(var r=0;r<i-1;r++)this.addChildAt(arguments[r],n+r);return arguments[i-2]}var s=t.parent,a=s===this;return s&&s._removeChildAt(R.indexOf(s.children,t),a),(t.parent=this).children.splice(e,0,t),a||t.dispatchEvent("added"),t},t.removeChild=function(t){var e=arguments.length;if(1<e){for(var i=!0,n=0;n<e;n++)i=i&&this.removeChild(arguments[n]);return i}return this._removeChildAt(R.indexOf(this.children,t))},t.removeChildAt=function(t){var e=arguments.length;if(1<e){for(var i=[],n=0;n<e;n++)i[n]=arguments[n];i.sort(function(t,e){return e-t});for(var r=!0,n=0;n<e;n++)r=r&&this._removeChildAt(i[n]);return r}return this._removeChildAt(t)},t.removeAllChildren=function(){for(var t=this.children;t.length;)this._removeChildAt(0)},t.getChildAt=function(t){return this.children[t]},t.getChildByName=function(t){for(var e=this.children,i=0,n=e.length;i<n;i++)if(e[i].name==t)return e[i];return null},t.sortChildren=function(t){this.children.sort(t)},t.getChildIndex=function(t){return R.indexOf(this.children,t)},t.swapChildrenAt=function(t,e){var i=this.children,n=i[t],r=i[e];n&&r&&(i[t]=r,i[e]=n)},t.swapChildren=function(t,e){for(var i,n,r=this.children,s=0,a=r.length;s<a&&(r[s]==t&&(i=s),r[s]==e&&(n=s),null==i||null==n);s++);s!=a&&(r[i]=e,r[n]=t)},t.setChildIndex=function(t,e){var i=this.children,n=i.length;if(!(t.parent!=this||e<0||n<=e)){for(var r=0;r<n&&i[r]!=t;r++);r!=n&&r!=e&&(i.splice(r,1),i.splice(e,0,t))}},t.contains=function(t){for(;t;){if(t==this)return!0;t=t.parent}return!1},t.hitTest=function(t,e){return null!=this.getObjectUnderPoint(t,e)},t.getObjectsUnderPoint=function(t,e,i){var n=[],e=this.localToGlobal(t,e);return this._getObjectsUnderPoint(e.x,e.y,n,0<i,1==i),n},t.getObjectUnderPoint=function(t,e,i){e=this.localToGlobal(t,e);return this._getObjectsUnderPoint(e.x,e.y,null,0<i,1==i)},t.getBounds=function(){return this._getBounds(null,!0)},t.getTransformedBounds=function(){return this._getBounds()},t.clone=function(t){var e=this._cloneProps(new b);return t&&this._cloneChildren(e),e},t.toString=function(){return"[Container (name="+this.name+")]"},t._tick=function(t){if(this.tickChildren)for(var e=this.children.length-1;0<=e;e--){var i=this.children[e];i.tickEnabled&&i._tick&&i._tick(t)}this.DisplayObject__tick(t)},t._cloneChildren=function(t){t.children.length&&t.removeAllChildren();for(var e=t.children,i=0,n=this.children.length;i<n;i++){var r=this.children[i].clone(!0);r.parent=t,e.push(r)}},t._removeChildAt=function(t,e){if(t<0||t>this.children.length-1)return!1;var i=this.children[t];return i&&(i.parent=null),this.children.splice(t,1),e||i.dispatchEvent("removed"),!0},t._getObjectsUnderPoint=function(t,e,i,n,r,s){if(!(s=s||0)&&!this._testMask(this,t,e))return null;var a=R.DisplayObject._hitTestContext;r=r||n&&this._hasMouseEventListener();for(var o=this.children,h=o.length-1;0<=h;h--){var l=o[h],u=l.hitArea;if(l.visible&&(u||l.isVisible())&&(!n||l.mouseEnabled)&&(u||this._testMask(l,t,e))){if(R.lastMouseWorldPos&&l.lank&&l.lank.thang&&l.lank.thang.pos&&l.lank.thang.pos.distanceSquared){var c=l.lank.thang,d=c.pos,p=Math.abs(d.x-R.lastMouseWorldPos.x),_=Math.abs(d.y+((c.depth||1)/2*.88+(c.height||1)/2)-R.lastMouseWorldPos.y),f=Math.min(10,1.25*Math.max(c.width||1)+1),g=1.25*Math.max((c.height||1)+.88*(c.depth||1),1)+1,m=c.scaleFactorX||c.scaleFactor,d=c.scaleFactorY||c.scaleFactor;if(1<m&&(f*=m),1<d&&(g*=d),g+=.88*(c.pos.z-(c.depth||1)/2),g+=.88*(2*c.bobHeight||0),f<p||g<_)continue}if(!u&&l instanceof b){var v=l._getObjectsUnderPoint(t,e,i,n,r,s+1);if(!i&&v)return n&&!this.mouseChildren?this:v}else if(!n||r||l._hasMouseEventListener()){_=l.getConcatenatedDisplayProps(l._props),v=_.matrix;if(u&&(v.appendMatrix(u.getMatrix(u._props.matrix)),_.alpha=u.alpha),a.globalAlpha=_.alpha,a.setTransform(v.a,v.b,v.c,v.d,v.tx-t,v.ty-e),(u||l).draw(a),this._testHit(a)){if(a.setTransform(1,0,0,1,0,0),a.clearRect(0,0,2,2),!i)return n&&!this.mouseChildren?this:l;i.push(l)}}}}return null},t._testMask=function(t,e,i){var n=t.mask;if(!n||!n.graphics||n.graphics.isEmpty())return!0;var r=this._props.matrix,t=t.parent,r=t?t.getConcatenatedMatrix(r):r.identity();r=n.getMatrix(n._props.matrix).prependMatrix(r);t=R.DisplayObject._hitTestContext;return t.setTransform(r.a,r.b,r.c,r.d,r.tx-e,r.ty-i),n.graphics.drawAsPath(t),t.fillStyle="#000",t.fill(),!!this._testHit(t)&&(t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,2,2),!0)},t._getBounds=function(t,e){var i=this.DisplayObject_getBounds();if(i)return this._transformBounds(i,t,e);var n=this._props.matrix,n=e?n.identity():this.getMatrix(n);t&&n.prependMatrix(t);for(var r=this.children.length,s=null,a=0;a<r;a++){var o=this.children[a];o.visible&&(i=o._getBounds(n))&&(s?s.extend(i.x,i.y,i.width,i.height):s=i.clone())}return s},R.Container=R.promote(b,"DisplayObject")}(),function(){"use strict";function t(t){this.Container_constructor(),this.autoClear=!0,this.canvas="string"==typeof t?document.getElementById(t):t,this.mouseX=0,this.mouseY=0,this.drawRect=null,this.snapToPixelEnabled=!1,this.mouseInBounds=!1,this.tickOnUpdate=!0,this.mouseMoveOutside=!1,this.preventSelection=!0,this._pointerData={},this._pointerCount=0,this._primaryPointerID=null,this._mouseOverIntervalID=null,this._nextStage=null,this._prevStage=null,this.enableDOMEvents(!0)}var e=R.extend(t,R.Container);e._get_nextStage=function(){return this._nextStage},e._set_nextStage=function(t){this._nextStage&&(this._nextStage._prevStage=null),t&&(t._prevStage=this),this._nextStage=t};try{Object.defineProperties(e,{nextStage:{get:e._get_nextStage,set:e._set_nextStage}})}catch(t){}e.update=function(t){var e;this.canvas&&(this.tickOnUpdate&&this.tick(t),!1!==this.dispatchEvent("drawstart",!1,!0)&&(R.DisplayObject._snapToPixelEnabled=this.snapToPixelEnabled,e=this.drawRect,(t=this.canvas.getContext("2d")).setTransform(1,0,0,1,0,0),this.autoClear&&(e?t.clearRect(e.x,e.y,e.width,e.height):t.clearRect(0,0,this.canvas.width+1,this.canvas.height+1)),t.save(),this.drawRect&&(t.beginPath(),t.rect(e.x,e.y,e.width,e.height),t.clip()),this.updateContext(t),this.draw(t,!1),t.restore(),this.dispatchEvent("drawend")))},e.tick=function(t){if(this.tickEnabled&&!1!==this.dispatchEvent("tickstart",!1,!0)){var e=new R.Event("tick");if(t)for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);this._tick(e),this.dispatchEvent("tickend")}},e.handleEvent=function(t){"tick"==t.type&&this.update(t)},e.clear=function(){var t;this.canvas&&((t=this.canvas.getContext("2d")).setTransform(1,0,0,1,0,0),t.clearRect(0,0,this.canvas.width+1,this.canvas.height+1))},e.toDataURL=function(t,e){var i,n,r=this.canvas.getContext("2d"),s=this.canvas.width,a=this.canvas.height;t&&(i=r.getImageData(0,0,s,a),n=r.globalCompositeOperation,r.globalCompositeOperation="destination-over",r.fillStyle=t,r.fillRect(0,0,s,a));e=this.canvas.toDataURL(e||"image/png");return t&&(r.putImageData(i,0,0),r.globalCompositeOperation=n),e},e.enableMouseOver=function(t){if(this._mouseOverIntervalID&&(clearInterval(this._mouseOverIntervalID),this._mouseOverIntervalID=null,0==t&&this._testMouseOver(!0)),null==t)t=20;else if(t<=0)return;var e=this;this._mouseOverIntervalID=setInterval(function(){e._testMouseOver()},1e3/Math.min(50,t))},e.enableDOMEvents=function(t){var e,i,n=this._eventListeners;if(!(t=null==t?!0:t)&&n){for(e in n)(i=n[e]).t.removeEventListener(e,i.f,!1);this._eventListeners=null}else if(t&&!n&&this.canvas){var t=window.addEventListener?window:document,r=this;for(e in(n=this._eventListeners={}).mouseup={t:t,f:function(t){r._handleMouseUp(t)}},n.mousemove={t:t,f:function(t){r._handleMouseMove(t)}},n.dblclick={t:this.canvas,f:function(t){r._handleDoubleClick(t)}},n.mousedown={t:this.canvas,f:function(t){r._handleMouseDown(t)}},n)(i=n[e]).t.addEventListener(e,i.f,!1)}},e.clone=function(){throw"Stage cannot be cloned."},e.toString=function(){return"[Stage (name="+this.name+")]"},e._getElementRect=function(e){var i;try{i=e.getBoundingClientRect()}catch(t){i={top:e.offsetTop,left:e.offsetLeft,width:e.offsetWidth,height:e.offsetHeight}}var t=(window.pageXOffset||document.scrollLeft||0)-(document.clientLeft||document.body.clientLeft||0),n=(window.pageYOffset||document.scrollTop||0)-(document.clientTop||document.body.clientTop||0),r=window.getComputedStyle?getComputedStyle(e,null):e.currentStyle,s=parseInt(r.paddingLeft)+parseInt(r.borderLeftWidth),a=parseInt(r.paddingTop)+parseInt(r.borderTopWidth),e=parseInt(r.paddingRight)+parseInt(r.borderRightWidth),r=parseInt(r.paddingBottom)+parseInt(r.borderBottomWidth);return{left:i.left+t+s,right:i.right+t-e,top:i.top+n+a,bottom:i.bottom+n-r}},e._getPointerData=function(t){return this._pointerData[t]||(this._pointerData[t]={x:0,y:0})},e._handleMouseMove=function(t){t=t||window.event,this._handlePointerMove(-1,t,t.pageX,t.pageY)},e._handlePointerMove=function(t,e,i,n,r){var s,a;this._prevStage&&void 0===r||this.canvas&&(s=this._nextStage,r=(a=this._getPointerData(t)).inBounds,this._updatePointerPosition(t,e,i,n),(r||a.inBounds||this.mouseMoveOutside)&&(-1===t&&a.inBounds==!r&&this._dispatchMouseEvent(this,r?"mouseleave":"mouseenter",!1,t,a,e),this._dispatchMouseEvent(this,"stagemousemove",!1,t,a,e),this._dispatchMouseEvent(a.target,"pressmove",!0,t,a,e)),s&&s._handlePointerMove(t,e,i,n,null))},e._updatePointerPosition=function(t,e,i,n){var r=this._getElementRect(this.canvas);i-=r.left,n-=r.top;var s=this.canvas.width,a=this.canvas.height;i/=(r.right-r.left)/s,n/=(r.bottom-r.top)/a;r=this._getPointerData(t);(r.inBounds=0<=i&&0<=n&&i<=s-1&&n<=a-1)?(r.x=i,r.y=n):this.mouseMoveOutside&&(r.x=i<0?0:s-1<i?s-1:i,r.y=n<0?0:a-1<n?a-1:n),r.posEvtObj=e,r.rawX=i,r.rawY=n,t!==this._primaryPointerID&&-1!==t||(this.mouseX=r.x,this.mouseY=r.y,this.mouseInBounds=r.inBounds)},e._handleMouseUp=function(t){this._handlePointerUp(-1,t,!1)},e._handlePointerUp=function(t,e,i,n){var r,s,a=this._nextStage,o=this._getPointerData(t);this._prevStage&&void 0===n||(r=null,s=o.target,n||!s&&!a||(r=this._getObjectsUnderPoint(o.x,o.y,null,!0)),o.down&&(this._dispatchMouseEvent(this,"stagemouseup",!1,t,o,e,r),o.down=!1),r==s&&this._dispatchMouseEvent(s,"click",!0,t,o,e),this._dispatchMouseEvent(s,"pressup",!0,t,o,e),i?(t==this._primaryPointerID&&(this._primaryPointerID=null),delete this._pointerData[t]):o.target=null,a&&a._handlePointerUp(t,e,i,n||r&&this))},e._handleMouseDown=function(t){this._handlePointerDown(-1,t,t.pageX,t.pageY)},e._handlePointerDown=function(t,e,i,n,r){this.preventSelection&&e.preventDefault(),null!=this._primaryPointerID&&-1!==t||(this._primaryPointerID=t),null!=n&&this._updatePointerPosition(t,e,i,n);var s=null,a=this._nextStage,o=this._getPointerData(t);r||(s=o.target=this._getObjectsUnderPoint(o.x,o.y,null,!0)),o.inBounds&&(this._dispatchMouseEvent(this,"stagemousedown",!1,t,o,e,s),o.down=!0),this._dispatchMouseEvent(s,"mousedown",!0,t,o,e),a&&a._handlePointerDown(t,e,i,n,r||s&&this)},e._testMouseOver=function(t,e,i){if(!this._prevStage||void 0!==e){var n=this._nextStage;if(this._mouseOverIntervalID){var r=this._getPointerData(-1);if(r&&(t||this.mouseX!=this._mouseOverX||this.mouseY!=this._mouseOverY||!this.mouseInBounds)){var s,a,o=r.posEvtObj,h=i||o&&o.target==this.canvas,l=null,u=-1,c="";!e&&(t||this.mouseInBounds&&h)&&(l=this._getObjectsUnderPoint(this.mouseX,this.mouseY,null,!0),this._mouseOverX=this.mouseX,this._mouseOverY=this.mouseY);for(var d=this._mouseOverTarget||[],p=d[d.length-1],_=this._mouseOverTarget=[],f=l;f;)_.unshift(f),c=c||f.cursor,f=f.parent;for(this.canvas.style.cursor=c,!e&&i&&(i.canvas.style.cursor=c),s=0,a=_.length;s<a&&_[s]==d[s];s++)u=s;for(p!=l&&this._dispatchMouseEvent(p,"mouseout",!0,-1,r,o,l),s=d.length-1;u<s;s--)this._dispatchMouseEvent(d[s],"rollout",!1,-1,r,o,l);for(s=_.length-1;u<s;s--)this._dispatchMouseEvent(_[s],"rollover",!1,-1,r,o,p);p!=l&&this._dispatchMouseEvent(l,"mouseover",!0,-1,r,o,p),n&&n._testMouseOver(t,e||l&&this,i||h&&this)}}else n&&n._testMouseOver(t,e,i)}},e._handleDoubleClick=function(t,e){var i=null,n=this._nextStage,r=this._getPointerData(-1);e||(i=this._getObjectsUnderPoint(r.x,r.y,null,!0),this._dispatchMouseEvent(i,"dblclick",!0,-1,r,t)),n&&n._handleDoubleClick(t,e||i&&this)},e._dispatchMouseEvent=function(t,e,i,n,r,s,a){t&&(i||t.hasEventListener(e))&&(a=new R.MouseEvent(e,i,!1,r.x,r.y,s,n,n===this._primaryPointerID||-1===n,r.rawX,r.rawY,a),t.dispatchEvent(a))},R.Stage=R.promote(t,"Container")}(),function(){"use strict";function A(t,e){if(this.Stage_constructor(t),void 0!==e){if("object"!=typeof e)throw"Invalid options object";var i=e.premultiply,n=e.transparent,r=e.antialias,s=e.preserveBuffer,a=e.autoPurge}this.vocalDebug=!1,this._preserveBuffer=s||!1,this._antialias=r||!1,this._transparent=n||!1,this._premultiply=i||!1,this._autoPurge=void 0,this.autoPurge=a,this._viewportWidth=0,this._viewportHeight=0,this._projectionMatrix=null,this._webGLContext=null,this._clearColor={r:.5,g:.5,b:.5,a:0},this._maxCardsPerBatch=A.DEFAULT_MAX_BATCH_SIZE,this._activeShader=null,this._vertices=null,this._vertexPositionBuffer=null,this._uvs=null,this._uvPositionBuffer=null,this._indices=null,this._textureIndexBuffer=null,this._alphas=null,this._alphaBuffer=null,this._textureDictionary=[],this._textureIDs={},this._batchTextures=[],this._baseTextures=[],this._batchTextureCount=8,this._lastTextureInsert=-1,this._batchID=0,this._drawID=0,this._slotBlacklist=[],this._isDrawing=0,this._lastTrackedCanvas=0,this.isCacheControlled=!1,this._cacheContainer=new R.Container,this._initializeWebGL()}var t=R.extend(A,R.Stage);A.buildUVRects=function(t,e,i){if(!t||!t._frames)return null;void 0===i&&(i=!1);for(var n=-1!=(e=void 0===e?-1:e)&&i?e+1:t._frames.length,r=-1!=e&&i?e:0;r<n;r++){var s,a=t._frames[r];a.uvRect||a.image.width<=0||a.image.height<=0||(s=a.rect,a.uvRect={t:s.y/a.image.height,l:s.x/a.image.width,b:(s.y+s.height)/a.image.height,r:(s.x+s.width)/a.image.width})}return t._frames[-1!=e?e:0].uvRect||{t:0,l:0,b:1,r:1}},A.isWebGLActive=function(t){return t&&t instanceof WebGLRenderingContext&&"undefined"!=typeof WebGLRenderingContext},A.VERTEX_PROPERTY_COUNT=6,A.INDICIES_PER_CARD=6,A.DEFAULT_MAX_BATCH_SIZE=1e4,A.WEBGL_MAX_INDEX_NUM=Math.pow(2,16),A.UV_RECT={t:0,l:0,b:1,r:1};try{A.COVER_VERT=new Float32Array([-1,1,1,1,-1,-1,1,1,1,-1,-1,-1]),A.COVER_UV=new Float32Array([0,0,1,0,0,1,1,0,1,1,0,1]),A.COVER_UV_FLIP=new Float32Array([0,1,1,1,0,0,1,1,1,0,0,0])}catch(t){}A.REGULAR_VERTEX_HEADER=(A.REGULAR_VARYING_HEADER="precision mediump float;varying vec2 vTextureCoord;varying lowp float indexPicker;varying lowp float alphaValue;")+"attribute vec2 vertexPosition;attribute vec2 uvPosition;attribute lowp float textureIndex;attribute lowp float objectAlpha;uniform mat4 pMatrix;",A.REGULAR_FRAGMENT_HEADER=A.REGULAR_VARYING_HEADER+"uniform sampler2D uSampler[{{count}}];",A.REGULAR_VERTEX_BODY="void main(void) {gl_Position = vec4((vertexPosition.x * pMatrix[0][0]) + pMatrix[3][0],(vertexPosition.y * pMatrix[1][1]) + pMatrix[3][1],pMatrix[3][2],1.0);alphaValue = objectAlpha;indexPicker = textureIndex;vTextureCoord = uvPosition;}",A.REGULAR_FRAGMENT_BODY="void main(void) {vec4 color = vec4(1.0, 0.0, 0.0, 1.0);if (indexPicker <= 0.5) {color = texture2D(uSampler[0], vTextureCoord);{{alternates}}}{{fragColor}}}",A.REGULAR_FRAG_COLOR_NORMAL="gl_FragColor = vec4(color.rgb, color.a * alphaValue);",A.REGULAR_FRAG_COLOR_PREMULTIPLY="if(color.a > 0.0035) {gl_FragColor = vec4(color.rgb/color.a, color.a * alphaValue);} else {gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);}",A.PARTICLE_VERTEX_BODY=A.REGULAR_VERTEX_BODY,A.PARTICLE_FRAGMENT_BODY=A.REGULAR_FRAGMENT_BODY,A.COVER_VERTEX_HEADER=(A.COVER_VARYING_HEADER="precision mediump float;varying highp vec2 vRenderCoord;varying highp vec2 vTextureCoord;")+"attribute vec2 vertexPosition;attribute vec2 uvPosition;uniform float uUpright;",A.COVER_FRAGMENT_HEADER=A.COVER_VARYING_HEADER+"uniform sampler2D uSampler;",A.COVER_VERTEX_BODY="void main(void) {gl_Position = vec4(vertexPosition.x, vertexPosition.y, 0.0, 1.0);vRenderCoord = uvPosition;vTextureCoord = vec2(uvPosition.x, abs(uUpright - uvPosition.y));}",A.COVER_FRAGMENT_BODY="void main(void) {vec4 color = texture2D(uSampler, vRenderCoord);gl_FragColor = color;}",t._get_isWebGL=function(){return!!this._webGLContext},t._set_autoPurge=function(t){t=isNaN(t)?1200:t,this._autoPurge=t=-1!=t?t<10?10:t:t},t._get_autoPurge=function(){return Number(this._autoPurge)};try{Object.defineProperties(t,{isWebGL:{get:t._get_isWebGL},autoPurge:{get:t._get_autoPurge,set:t._set_autoPurge}})}catch(t){}t._initializeWebGL=function(){if(this.canvas){if(!this._webGLContext||this._webGLContext.canvas!==this.canvas){var t={depth:!1,alpha:this._transparent,stencil:!0,antialias:this._antialias,premultipliedAlpha:this._premultiply,preserveDrawingBuffer:this._preserveBuffer},t=this._webGLContext=this._fetchWebGLContext(this.canvas,t);if(!t)return null;this.updateSimultaneousTextureCount(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)),this._maxTextureSlots=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS),this._createBuffers(t),this._initTextures(t),t.disable(t.DEPTH_TEST),t.enable(t.BLEND),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this._premultiply),this._webGLContext.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearColor.a),this.updateViewport(this._viewportWidth||this.canvas.width,this._viewportHeight||this.canvas.height)}}else this._webGLContext=null;return this._webGLContext},t.update=function(t){this.canvas&&(this.tickOnUpdate&&this.tick(t),this.dispatchEvent("drawstart"),this.autoClear&&this.clear(),this._webGLContext?(this._batchDraw(this,this._webGLContext),-1==this._autoPurge||this._drawID%(this._autoPurge/2|0)||this.purgeTextures(this._autoPurge)):((t=this.canvas.getContext("2d")).save(),this.updateContext(t),this.draw(t,!1),t.restore()),this.dispatchEvent("drawend"))},t.clear=function(){var t,e,i;this.canvas&&(A.isWebGLActive(this._webGLContext)?(t=this._webGLContext,e=this._clearColor,i=this._transparent?e.a:1,this._webGLContext.clearColor(e.r*i,e.g*i,e.b*i,i),t.clear(t.COLOR_BUFFER_BIT),this._webGLContext.clearColor(e.r,e.g,e.b,e.a)):this.Stage_clear())},t.draw=function(t,e){if(t===this._webGLContext&&A.isWebGLActive(this._webGLContext)){var i=this._webGLContext;return this._batchDraw(this,i,e),!0}return this.Stage_draw(t,e)},t.cacheDraw=function(t,e,i){if(A.isWebGLActive(this._webGLContext)){var n=this._webGLContext;return this._cacheDraw(n,t,e,i),!0}return!1},t.protectTextureSlot=function(t,e){if(t>this._maxTextureSlots||t<0)throw"Slot outside of acceptable range";this._slotBlacklist[t]=!!e},t.getTargetRenderTexture=function(t,e,i){var n=!1,r=this._webGLContext;if(!(r=(n=void 0!==t.__lastRT&&t.__lastRT===t.__rtA?!0:n)?(void 0===t.__rtB?t.__rtB=this.getRenderBufferTexture(e,i):(e==t.__rtB._width&&i==t.__rtB._height||this.resizeTexture(t.__rtB,e,i),this.setTextureParams(r)),t.__rtB):(void 0===t.__rtA?t.__rtA=this.getRenderBufferTexture(e,i):(e==t.__rtA._width&&i==t.__rtA._height||this.resizeTexture(t.__rtA,e,i),this.setTextureParams(r)),t.__rtA)))throw"Problems creating render textures, known causes include using too much VRAM by not releasing WebGL texture instances";return t.__lastRT=r},t.releaseTexture=function(t){var e,i;if(t){if(t.children)for(e=0,i=t.children.length;e<i;e++)this.releaseTexture(t.children[e]);t.cacheCanvas&&t.uncache();var n=void 0;if(void 0!==t._storeID){if(t===this._textureDictionary[t._storeID])return this._killTextureObject(t),void(t._storeID=void 0);n=t}else if(2===t._webGLRenderStyle)n=t.image;else if(1===t._webGLRenderStyle){for(e=0,i=t.spriteSheet._images.length;e<i;e++)this.releaseTexture(t.spriteSheet._images[e]);return}void 0!==n?(this._killTextureObject(this._textureDictionary[n._storeID]),n._storeID=void 0):this.vocalDebug&&console.log("No associated texture found on release")}},t.purgeTextures=function(t){null==t&&(t=100);for(var e=this._textureDictionary,i=e.length,n=0;n<i;n++){var r=e[n];r&&r._drawID+t<=this._drawID&&this._killTextureObject(r)}},t.updateSimultaneousTextureCount=function(t){var e=this._webGLContext,i=!1;for((t<1||isNaN(t))&&(t=1),this._batchTextureCount=t;!i;)try{this._activeShader=this._fetchShaderProgram(e),i=!0}catch(t){if(1==this._batchTextureCount)throw"Cannot compile shader "+t;this._batchTextureCount-=4,this._batchTextureCount<1&&(this._batchTextureCount=1),this.vocalDebug&&console.log("Reducing desired texture count due to errors: "+this._batchTextureCount)}},t.updateViewport=function(t,e){this._viewportWidth=0|t,this._viewportHeight=0|e;e=this._webGLContext;e&&(e.viewport(0,0,this._viewportWidth,this._viewportHeight),this._projectionMatrix=new Float32Array([2/this._viewportWidth,0,0,0,0,-2/this._viewportHeight,1,0,0,0,1,0,-1,1,.1,0]),this._projectionMatrixFlip=new Float32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),this._projectionMatrixFlip.set(this._projectionMatrix),this._projectionMatrixFlip[5]*=-1,this._projectionMatrixFlip[13]*=-1)},t.getFilterShader=function(t){var e=this._webGLContext,i=this._activeShader;if((t=t||this)._builtShader)i=t._builtShader,t.shaderParamSetup&&(e.useProgram(i),t.shaderParamSetup(e,this,i));else try{i=this._fetchShaderProgram(e,"filter",t.VTX_SHADER_BODY,t.FRAG_SHADER_BODY,t.shaderParamSetup&&t.shaderParamSetup.bind(t)),(t._builtShader=i)._name=t.toString()}catch(t){console&&console.log("SHADER SWITCH FAILURE",t)}return i},t.getBaseTexture=function(t,e){var i=Math.ceil(0<t?t:1)||1,n=Math.ceil(0<e?e:1)||1,t=this._webGLContext,e=t.createTexture();return this.resizeTexture(e,i,n),this.setTextureParams(t,!1),e},t.resizeTexture=function(t,e,i){var n=this._webGLContext;n.bindTexture(n.TEXTURE_2D,t),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,e,i,0,n.RGBA,n.UNSIGNED_BYTE,null),t.width=e,t.height=i},t.getRenderBufferTexture=function(t,e){var i=this._webGLContext,n=this.getBaseTexture(t,e);if(!n)return null;var r=i.createFramebuffer();return r?(n.width=t,n.height=e,i.bindFramebuffer(i.FRAMEBUFFER,r),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,n,0),(r._renderTexture=n)._frameBuffer=r,n._storeID=this._textureDictionary.length,this._textureDictionary[n._storeID]=n,i.bindFramebuffer(i.FRAMEBUFFER,null),n):null},t.setTextureParams=function(t,e){e&&this._antialias?(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR)):(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST)),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)},t.setClearColor=function(t){var e,i,n,r,s;"string"==typeof t?0==t.indexOf("#")?(4==t.length&&(t="#"+t.charAt(1)+t.charAt(1)+t.charAt(2)+t.charAt(2)+t.charAt(3)+t.charAt(3)),e=Number("0x"+t.slice(1,3))/255,i=Number("0x"+t.slice(3,5))/255,n=Number("0x"+t.slice(5,7))/255,r=Number("0x"+t.slice(7,9))/255):0==t.indexOf("rgba(")&&(s=t.slice(5,-1).split(","),e=Number(s[0])/255,i=Number(s[1])/255,n=Number(s[2])/255,r=Number(s[3])):(e=((4278190080&t)>>>24)/255,i=((16711680&t)>>>16)/255,n=((65280&t)>>>8)/255,r=(255&t)/255),this._clearColor.r=e||0,this._clearColor.g=i||0,this._clearColor.b=n||0,this._clearColor.a=r||0,this._webGLContext&&this._webGLContext.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearColor.a)},t.toString=function(){return"[StageGL (name="+this.name+")]"},t._fetchWebGLContext=function(t,e){var i;try{i=t.getContext("webgl",e)||t.getContext("experimental-webgl",e)}catch(t){}return i?(i.viewportWidth=t.width,i.viewportHeight=t.height):(t="Could not initialize WebGL",console.error?console.error(t):console.log(t)),i},t._fetchShaderProgram=function(t,e,i,n,r){var s,a;switch(t.useProgram(null),e){case"filter":a=A.COVER_VERTEX_HEADER+(i||A.COVER_VERTEX_BODY),s=A.COVER_FRAGMENT_HEADER+(n||A.COVER_FRAGMENT_BODY);break;case"particle":a=A.REGULAR_VERTEX_HEADER+A.PARTICLE_VERTEX_BODY,s=A.REGULAR_FRAGMENT_HEADER+A.PARTICLE_FRAGMENT_BODY;break;case"override":a=A.REGULAR_VERTEX_HEADER+(i||A.REGULAR_VERTEX_BODY),s=A.REGULAR_FRAGMENT_HEADER+(n||A.REGULAR_FRAGMENT_BODY);break;case"regular":default:a=A.REGULAR_VERTEX_HEADER+A.REGULAR_VERTEX_BODY,s=A.REGULAR_FRAGMENT_HEADER+A.REGULAR_FRAGMENT_BODY}var o=this._createShader(t,t.VERTEX_SHADER,a),h=this._createShader(t,t.FRAGMENT_SHADER,s),l=t.createProgram();if(t.attachShader(l,o),t.attachShader(l,h),t.linkProgram(l),l._type=e,!t.getProgramParameter(l,t.LINK_STATUS))throw t.useProgram(this._activeShader),t.getProgramInfoLog(l);switch(t.useProgram(l),e){case"filter":l.vertexPositionAttribute=t.getAttribLocation(l,"vertexPosition"),t.enableVertexAttribArray(l.vertexPositionAttribute),l.uvPositionAttribute=t.getAttribLocation(l,"uvPosition"),t.enableVertexAttribArray(l.uvPositionAttribute),l.samplerUniform=t.getUniformLocation(l,"uSampler"),t.uniform1i(l.samplerUniform,0),l.uprightUniform=t.getUniformLocation(l,"uUpright"),t.uniform1f(l.uprightUniform,0),r&&r(t,this,l);break;case"override":case"particle":case"regular":default:l.vertexPositionAttribute=t.getAttribLocation(l,"vertexPosition"),t.enableVertexAttribArray(l.vertexPositionAttribute),l.uvPositionAttribute=t.getAttribLocation(l,"uvPosition"),t.enableVertexAttribArray(l.uvPositionAttribute),l.textureIndexAttribute=t.getAttribLocation(l,"textureIndex"),t.enableVertexAttribArray(l.textureIndexAttribute),l.alphaAttribute=t.getAttribLocation(l,"objectAlpha"),t.enableVertexAttribArray(l.alphaAttribute);for(var u=[],c=0;c<this._batchTextureCount;c++)u[c]=c;l.samplerData=u,l.samplerUniform=t.getUniformLocation(l,"uSampler"),t.uniform1iv(l.samplerUniform,u),l.pMatrixUniform=t.getUniformLocation(l,"pMatrix")}return t.useProgram(this._activeShader),l},t._createShader=function(t,e,i){i=i.replace(/{{count}}/g,this._batchTextureCount);for(var n="",r=1;r<this._batchTextureCount;r++)n+="} else if (indexPicker <= "+r+".5) { color = texture2D(uSampler["+r+"], vTextureCoord);";i=(i=i.replace(/{{alternates}}/g,n)).replace(/{{fragColor}}/g,this._premultiply?A.REGULAR_FRAG_COLOR_PREMULTIPLY:A.REGULAR_FRAG_COLOR_NORMAL);e=t.createShader(e);if(t.shaderSource(e,i),t.compileShader(e),!t.getShaderParameter(e,t.COMPILE_STATUS))throw t.getShaderInfoLog(e);return e},t._createBuffers=function(t){var e=this._maxCardsPerBatch*A.INDICIES_PER_CARD,i=this._vertexPositionBuffer=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,i);for(var n=2,r=this._vertices=new Float32Array(e*n),s=0,a=r.length;s<a;s+=n)r[s]=r[s+1]=0;t.bufferData(t.ARRAY_BUFFER,r,t.DYNAMIC_DRAW),i.itemSize=n,i.numItems=e;i=this._uvPositionBuffer=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,i),n=2;var o=this._uvs=new Float32Array(e*n);for(s=0,a=o.length;s<a;s+=n)o[s]=o[s+1]=0;t.bufferData(t.ARRAY_BUFFER,o,t.DYNAMIC_DRAW),i.itemSize=n,i.numItems=e;i=this._textureIndexBuffer=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,i),n=1;var h=this._indices=new Float32Array(e*n);for(s=0,a=h.length;s<a;s++)h[s]=0;t.bufferData(t.ARRAY_BUFFER,h,t.DYNAMIC_DRAW),i.itemSize=n,i.numItems=e;i=this._alphaBuffer=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,i),n=1;var l=this._alphas=new Float32Array(e*n);for(s=0,a=l.length;s<a;s++)l[s]=1;t.bufferData(t.ARRAY_BUFFER,l,t.DYNAMIC_DRAW),i.itemSize=n,i.numItems=e},t._initTextures=function(){this._lastTextureInsert=-1,this._textureDictionary=[],this._textureIDs={},this._baseTextures=[],this._batchTextures=[];for(var t=0;t<this._batchTextureCount;t++){var e=this.getBaseTexture();if(!(this._baseTextures[t]=this._batchTextures[t]=e))throw"Problems creating basic textures, known causes include using too much VRAM by not releasing WebGL texture instances"}},t._loadTextureImage=function(t,e){var i=e.src;i||(e._isCanvas=!0,i=e.src="canvas_"+this._lastTrackedCanvas++);var n=this._textureIDs[i];void 0===n&&(n=this._textureIDs[i]=this._textureDictionary.length),void 0===this._textureDictionary[n]&&(this._textureDictionary[n]=this.getBaseTexture());i=this._textureDictionary[n];return i?(i._batchID=this._batchID,i._storeID=n,i._imageData=e,this._insertTextureInBatch(t,i),e._storeID=n,e.complete||e.naturalWidth||e._isCanvas?this._updateTextureImageData(t,e):e.addEventListener("load",this._updateTextureImageData.bind(this,t,e))):(e="Problem creating desired texture, known causes include using too much VRAM by not releasing WebGL texture instances",console.error&&console.error(e)||console.log(e),(i=this._baseTextures[0])._batchID=this._batchID,i._storeID=-1,i._imageData=i,this._insertTextureInBatch(t,i)),i},t._updateTextureImageData=function(t,e){var i=e.width&e.width-1||e.height&e.height-1,n=this._textureDictionary[e._storeID];t.activeTexture(t.TEXTURE0+n._activeIndex),t.bindTexture(t.TEXTURE_2D,n),n.isPOT=!i,this.setTextureParams(t,n.isPOT);try{t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e)}catch(t){var r="\nAn error has occurred. This is most likely due to security restrictions on WebGL images with local or cross-domain origins";console.error?(console.error(r),console.error(t)):console&&(console.log(r),console.log(t))}e._invalid=!1,n._w=e.width,n._h=e.height,this.vocalDebug&&(i&&console.warn("NPOT(Non Power of Two) Texture: "+e.src),(e.width>t.MAX_TEXTURE_SIZE||e.height>t.MAX_TEXTURE_SIZE)&&console&&console.error("Oversized Texture: "+e.width+"x"+e.height+" vs "+t.MAX_TEXTURE_SIZE+"max"))},t._insertTextureInBatch=function(t,e){if(this._batchTextures[e._activeIndex]!==e){var i=-1,n=(this._lastTextureInsert+1)%this._batchTextureCount,r=n;do{if(this._batchTextures[r]._batchID!=this._batchID&&!this._slotBlacklist[r]){i=r;break}}while((r=(r+1)%this._batchTextureCount)!==n);-1===i&&(this.batchReason="textureOverflow",this._drawBuffers(t),this.batchCardCount=0,i=n),(this._batchTextures[i]=e)._activeIndex=i,(s=e._imageData)&&s._invalid&&void 0!==e._drawID?this._updateTextureImageData(t,s):(t.activeTexture(t.TEXTURE0+i),t.bindTexture(t.TEXTURE_2D,e),this.setTextureParams(t)),this._lastTextureInsert=i}else{var s=e._imageData;null!=e._storeID&&s&&s._invalid&&this._updateTextureImageData(t,s)}e._drawID=this._drawID,e._batchID=this._batchID},t._killTextureObject=function(t){if(t){var e=this._webGLContext;if(void 0!==t._storeID&&0<=t._storeID){for(var i in this._textureDictionary[t._storeID]=void 0,this._textureIDs)this._textureIDs[i]==t._storeID&&delete this._textureIDs[i];t._imageData&&(t._imageData._storeID=void 0),t._imageData=t._storeID=void 0}void 0!==t._activeIndex&&this._batchTextures[t._activeIndex]===t&&(this._batchTextures[t._activeIndex]=this._baseTextures[t._activeIndex]);try{t._frameBuffer&&e.deleteFramebuffer(t._frameBuffer),t._frameBuffer=void 0}catch(t){this.vocalDebug&&console.log(t)}try{e.deleteTexture(t)}catch(t){this.vocalDebug&&console.log(t)}}},t._backupBatchTextures=function(t,e){var i=this._webGLContext;this._backupTextures||(this._backupTextures=[]),void 0===e&&(e=this._backupTextures);for(var n=0;n<this._batchTextureCount;n++)i.activeTexture(i.TEXTURE0+n),t?this._batchTextures[n]=e[n]:(e[n]=this._batchTextures[n],this._batchTextures[n]=this._baseTextures[n]),i.bindTexture(i.TEXTURE_2D,this._batchTextures[n]),this.setTextureParams(i,this._batchTextures[n].isPOT);t&&e===this._backupTextures&&(this._backupTextures=[])},t._batchDraw=function(t,e,i){0<this._isDrawing&&this._drawBuffers(e),this._isDrawing++,this._drawID++,this.batchCardCount=0,this.depth=0,this._appendToBatchGroup(t,e,new R.Matrix2D,this.alpha,i),this.batchReason="drawFinish",this._drawBuffers(e),this._isDrawing--},t._cacheDraw=function(t,e,i,n){var r=this._activeShader,s=this._slotBlacklist,a=this._maxTextureSlots-1,o=this._viewportWidth,h=this._viewportHeight;this.protectTextureSlot(a,!0);var l=e.getMatrix();(l=l.clone()).scale(1/n.scale,1/n.scale),(l=l.invert()).translate(-n.offX/n.scale*e.scaleX,-n.offY/n.scale*e.scaleY);var u=this._cacheContainer;u.children=[e],u.transformMatrix=l,this._backupBatchTextures(!1),i&&i.length?this._drawFilters(e,i,n):this.isCacheControlled?(t.clear(t.COLOR_BUFFER_BIT),this._batchDraw(u,t,!0)):(t.activeTexture(t.TEXTURE0+a),e.cacheCanvas=this.getTargetRenderTexture(e,n._drawWidth,n._drawHeight),e=e.cacheCanvas,t.bindFramebuffer(t.FRAMEBUFFER,e._frameBuffer),this.updateViewport(n._drawWidth,n._drawHeight),this._projectionMatrix=this._projectionMatrixFlip,t.clear(t.COLOR_BUFFER_BIT),this._batchDraw(u,t,!0),t.bindFramebuffer(t.FRAMEBUFFER,null),this.updateViewport(o,h)),this._backupBatchTextures(!0),this.protectTextureSlot(a,!1),this._activeShader=r,this._slotBlacklist=s},t._drawFilters=function(t,e,i){var n,r=this._webGLContext,s=this._maxTextureSlots-1,a=this._viewportWidth,o=this._viewportHeight,h=this._cacheContainer,l=e.length;r.activeTexture(r.TEXTURE0+s),n=this.getTargetRenderTexture(t,i._drawWidth,i._drawHeight),r.bindFramebuffer(r.FRAMEBUFFER,n._frameBuffer),this.updateViewport(i._drawWidth,i._drawHeight),r.clear(r.COLOR_BUFFER_BIT),this._batchDraw(h,r,!0),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,n),this.setTextureParams(r);for(var u=!1,c=0,d=e[c];this._activeShader=this.getFilterShader(d),this._activeShader&&(r.activeTexture(r.TEXTURE0+s),n=this.getTargetRenderTexture(t,i._drawWidth,i._drawHeight),r.bindFramebuffer(r.FRAMEBUFFER,n._frameBuffer),r.viewport(0,0,i._drawWidth,i._drawHeight),r.clear(r.COLOR_BUFFER_BIT),this._drawCover(r,u),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,n),this.setTextureParams(r),(1<l||e[0]._multiPass)&&(u=!u),d=null!==d._multiPass?d._multiPass:e[++c]),d;);this.isCacheControlled?(r.bindFramebuffer(r.FRAMEBUFFER,null),this.updateViewport(a,o),this._activeShader=this.getFilterShader(this),r.clear(r.COLOR_BUFFER_BIT),this._drawCover(r,u)):(u&&(r.activeTexture(r.TEXTURE0+s),n=this.getTargetRenderTexture(t,i._drawWidth,i._drawHeight),r.bindFramebuffer(r.FRAMEBUFFER,n._frameBuffer),this._activeShader=this.getFilterShader(this),r.viewport(0,0,i._drawWidth,i._drawHeight),r.clear(r.COLOR_BUFFER_BIT),this._drawCover(r,!u)),r.bindFramebuffer(r.FRAMEBUFFER,null),this.updateViewport(a,o),t.cacheCanvas=n)},t._appendToBatchGroup=function(t,e,i,n,r){t._glMtx||(t._glMtx=new R.Matrix2D);var s,a,o,h,l=t._glMtx;l.copy(i),t.transformMatrix?l.appendMatrix(t.transformMatrix):l.appendTransform(t.x,t.y,t.scaleX,t.scaleY,t.rotation,t.skewX,t.skewY,t.regX,t.regY);for(var u=t.children.length,c=0;c<u;c++){var d=t.children[c];if(d.visible&&n)if(d.cacheCanvas&&!r||(d._updateState&&d._updateState(),!d.children)){this.batchCardCount+1>this._maxCardsPerBatch&&(this.batchReason="vertexOverflow",this._drawBuffers(e),this.batchCardCount=0),d._glMtx||(d._glMtx=new R.Matrix2D);var p,_,f,g,m=d._glMtx;m.copy(l),d.transformMatrix?m.appendMatrix(d.transformMatrix):m.appendTransform(d.x,d.y,d.scaleX,d.scaleY,d.rotation,d.skewX,d.skewY,d.regX,d.regY);var v=d.cacheCanvas&&!r;if(2===d._webGLRenderStyle||v)p=!r&&d.cacheCanvas||d.image;else{if(1!==d._webGLRenderStyle)continue;if(null===(_=d.spriteSheet.getFrame(d.currentFrame)))continue;p=_.image}var b=this._uvs,y=this._vertices,T=this._indices,S=this._alphas;if(p){if(void 0===p._storeID)f=this._loadTextureImage(e,p),this._insertTextureInBatch(e,f);else{if(!(f=this._textureDictionary[p._storeID])){this.vocalDebug&&console.log("Texture should not be looked up while not being stored.");continue}f._batchID!==this._batchID&&this._insertTextureInBatch(e,f)}var E,w=f._activeIndex;2===d._webGLRenderStyle||v?h=!v&&d.sourceRect?(d._uvRect||(d._uvRect={}),g=d.sourceRect,(E=d._uvRect).t=g.y/p.height,E.l=g.x/p.width,E.b=(g.y+g.height)/p.height,E.r=(g.x+g.width)/p.width,o=g.width+(s=0),g.height+(a=0)):(E=A.UV_RECT,v?(s=(g=d.bitmapCache).x+g._filterOffX/g.scale,a=g.y+g._filterOffY/g.scale,o=g._drawWidth/g.scale+s,g._drawHeight/g.scale+a):(o=p.width+(s=0),p.height+(a=0))):1===d._webGLRenderStyle&&(x=_.rect,E=(E=_.uvRect)||A.buildUVRects(d.spriteSheet,d.currentFrame,!1),s=-_.regX,a=-_.regY,o=x.width-_.regX,h=x.height-_.regY);var v=this.batchCardCount*A.INDICIES_PER_CARD,x=2*v;y[x]=s*m.a+a*m.c+m.tx,y[1+x]=s*m.b+a*m.d+m.ty,y[2+x]=s*m.a+h*m.c+m.tx,y[3+x]=s*m.b+h*m.d+m.ty,y[4+x]=o*m.a+a*m.c+m.tx,y[5+x]=o*m.b+a*m.d+m.ty,y[6+x]=y[2+x],y[7+x]=y[3+x],y[8+x]=y[4+x],y[9+x]=y[5+x],y[10+x]=o*m.a+h*m.c+m.tx,y[11+x]=o*m.b+h*m.d+m.ty,b[x]=E.l,b[1+x]=E.t,b[2+x]=E.l,b[3+x]=E.b,b[4+x]=E.r,b[5+x]=E.t,b[6+x]=E.l,b[7+x]=E.b,b[8+x]=E.r,b[9+x]=E.t,b[10+x]=E.r,b[11+x]=E.b,T[v]=T[1+v]=T[2+v]=T[3+v]=T[4+v]=T[5+v]=w,S[v]=S[1+v]=S[2+v]=S[3+v]=S[4+v]=S[5+v]=d.alpha*n,this.batchCardCount++}}else this._appendToBatchGroup(d,e,l,d.alpha*n)}},t._drawBuffers=function(t){if(!(this.batchCardCount<=0)){this.vocalDebug&&console.log("Draw["+this._drawID+":"+this._batchID+"] : "+this.batchReason);var e=this._activeShader,i=this._vertexPositionBuffer,n=this._textureIndexBuffer,r=this._uvPositionBuffer,s=this._alphaBuffer;t.useProgram(e),t.bindBuffer(t.ARRAY_BUFFER,i),t.vertexAttribPointer(e.vertexPositionAttribute,i.itemSize,t.FLOAT,!1,0,0),t.bufferSubData(t.ARRAY_BUFFER,0,this._vertices),t.bindBuffer(t.ARRAY_BUFFER,n),t.vertexAttribPointer(e.textureIndexAttribute,n.itemSize,t.FLOAT,!1,0,0),t.bufferSubData(t.ARRAY_BUFFER,0,this._indices),t.bindBuffer(t.ARRAY_BUFFER,r),t.vertexAttribPointer(e.uvPositionAttribute,r.itemSize,t.FLOAT,!1,0,0),t.bufferSubData(t.ARRAY_BUFFER,0,this._uvs),t.bindBuffer(t.ARRAY_BUFFER,s),t.vertexAttribPointer(e.alphaAttribute,s.itemSize,t.FLOAT,!1,0,0),t.bufferSubData(t.ARRAY_BUFFER,0,this._alphas),t.uniformMatrix4fv(e.pMatrixUniform,t.FALSE,this._projectionMatrix);for(var a=0;a<this._batchTextureCount;a++){var o=this._batchTextures[a];t.activeTexture(t.TEXTURE0+a),t.bindTexture(t.TEXTURE_2D,o),this.setTextureParams(t,o.isPOT)}t.drawArrays(t.TRIANGLES,0,this.batchCardCount*A.INDICIES_PER_CARD),this._batchID++}},t._drawCover=function(t,e){0<this._isDrawing&&this._drawBuffers(t),this.vocalDebug&&console.log("Draw["+this._drawID+":"+this._batchID+"] : Cover");var i=this._activeShader,n=this._vertexPositionBuffer,r=this._uvPositionBuffer;t.clear(t.COLOR_BUFFER_BIT),t.useProgram(i),t.bindBuffer(t.ARRAY_BUFFER,n),t.vertexAttribPointer(i.vertexPositionAttribute,n.itemSize,t.FLOAT,!1,0,0),t.bufferSubData(t.ARRAY_BUFFER,0,A.COVER_VERT),t.bindBuffer(t.ARRAY_BUFFER,r),t.vertexAttribPointer(i.uvPositionAttribute,r.itemSize,t.FLOAT,!1,0,0),t.bufferSubData(t.ARRAY_BUFFER,0,e?A.COVER_UV_FLIP:A.COVER_UV),t.uniform1i(i.samplerUniform,0),t.uniform1f(i.uprightUniform,e?0:1),t.drawArrays(t.TRIANGLES,0,A.INDICIES_PER_CARD)},R.StageGL=R.promote(A,"Stage")}(),(e=R.extend(n,R.DisplayObject)).initialize=n,e.isVisible=function(){var t=this.image,t=this.cacheCanvas||t&&(t.naturalWidth||t.getContext||2<=t.readyState);return!!(this.visible&&0<this.alpha&&0!=this.scaleX&&0!=this.scaleY&&t)},e.draw=function(t,e){if(this.DisplayObject_draw(t,e))return!0;var i,n,r,s,a,o,h=this.image,l=this.sourceRect;return(h=h.getImage?h.getImage():h)&&(l?(i=l.x,n=l.y,r=i+l.width,s=n+l.height,a=h.width,o=h.height,i<(l=e=0)&&(e-=i,i=0),n<0&&(l-=n,n=0),t.drawImage(h,i,n,(r=a<r?a:r)-i,(s=o<s?o:s)-n,e,l,r-i,s-n)):t.drawImage(h,0,0)),!0},e.getBounds=function(){var t=this.DisplayObject_getBounds();if(t)return t;var e=this.image,t=this.sourceRect||e;return e&&(e.naturalWidth||e.getContext||2<=e.readyState)?this._rectangle.setValues(0,0,t.width,t.height):null},e.clone=function(t){var e=this.image,e=new n(e=e&&t?e.cloneNode():e);return this.sourceRect&&(e.sourceRect=this.sourceRect.clone()),this._cloneProps(e),e},e.toString=function(){return"[Bitmap (name="+this.name+")]"},R.Bitmap=R.promote(n,"DisplayObject"),function(){"use strict";function t(t,e){this.DisplayObject_constructor(),this.currentFrame=0,this.currentAnimation=null,this.paused=!0,this.spriteSheet=t,this.currentAnimationFrame=0,this.framerate=0,this._animation=null,this._currentFrame=null,this._skipAdvance=!1,this._webGLRenderStyle=R.DisplayObject._StageGL_SPRITE,null!=e&&this.gotoAndPlay(e)}var e=R.extend(t,R.DisplayObject);e.initialize=t,e.isVisible=function(){var t=this.cacheCanvas||this.spriteSheet.complete;return!!(this.visible&&0<this.alpha&&0!=this.scaleX&&0!=this.scaleY&&t)},e.draw=function(t,e){if(this.DisplayObject_draw(t,e))return!0;this._normalizeFrame();var i=this.spriteSheet.getFrame(0|this._currentFrame);if(!i)return!1;e=i.rect;return e.width&&e.height&&t.drawImage(i.image,e.x,e.y,e.width,e.height,-i.regX,-i.regY,e.width,e.height),!0},e.play=function(){this.paused=!1},e.stop=function(){this.paused=!0},e.gotoAndPlay=function(t){this.paused=!1,this._skipAdvance=!0,this._goto(t)},e.gotoAndStop=function(t){this.paused=!0,this._goto(t)},e.advance=function(t){var e=this.framerate||this.spriteSheet.framerate;this._normalizeFrame(e&&null!=t?t/(1e3/e):1)},e.getBounds=function(){return this.DisplayObject_getBounds()||this.spriteSheet.getFrameBounds(this.currentFrame,this._rectangle)},e.clone=function(){return this._cloneProps(new t(this.spriteSheet))},e.toString=function(){return"[Sprite (name="+this.name+")]"},e._cloneProps=function(t){return this.DisplayObject__cloneProps(t),t.currentFrame=this.currentFrame,t.currentAnimation=this.currentAnimation,t.paused=this.paused,t.currentAnimationFrame=this.currentAnimationFrame,t.framerate=this.framerate,t._animation=this._animation,t._currentFrame=this._currentFrame,t._skipAdvance=this._skipAdvance,t},e._tick=function(t){this.paused||(this._skipAdvance||this.advance(t&&t.delta),this._skipAdvance=!1),this.DisplayObject__tick(t)},e._normalizeFrame=function(t){t=t||0;var e=this._animation,i=this.paused,n=this._currentFrame;if(e){var r,s=e.speed||1,a=this.currentAnimationFrame;if((r=e.frames.length)<=a+t*s){var o=e.next;if(this._dispatchAnimationEnd(e,n,i,o,r-1))return;if(o)return this._goto(o,t-(r-a)/s);this.paused=!0,a=e.frames.length-1}else a+=t*s;this.currentAnimationFrame=a,this._currentFrame=e.frames[0|a]}else if(n=this._currentFrame+=t,(r=this.spriteSheet.getNumFrames())<=n&&0<r&&!this._dispatchAnimationEnd(e,n,i,r-1)&&(this._currentFrame-=r)>=r)return this._normalizeFrame();n=0|this._currentFrame,this.currentFrame!=n&&(this.currentFrame=n,this.dispatchEvent("change"))},e._dispatchAnimationEnd=function(t,e,i,n,r){var s,a=t?t.name:null;this.hasEventListener("animationend")&&((s=new R.Event("animationend")).name=a,s.next=n,this.dispatchEvent(s));e=this._animation!=t||this._currentFrame!=e;return e||i||!this.paused||(this.currentAnimationFrame=r,e=!0),e},e._goto=function(t,e){var i;this.currentAnimationFrame=0,isNaN(t)?(i=this.spriteSheet.getAnimation(t))&&(this._animation=i,this.currentAnimation=t,this._normalizeFrame(e)):(this.currentAnimation=this._animation=null,this._currentFrame=t,this._normalizeFrame())},R.Sprite=R.promote(t,"DisplayObject")}(),function(){"use strict";function e(t){this.DisplayObject_constructor(),this.graphics=t||new R.Graphics}var t=R.extend(e,R.DisplayObject);t.isVisible=function(){var t=this.cacheCanvas||this.graphics&&!this.graphics.isEmpty();return!!(this.visible&&0<this.alpha&&0!=this.scaleX&&0!=this.scaleY&&t)},t.draw=function(t,e){return this.DisplayObject_draw(t,e)||this.graphics.draw(t,this),!0},t.clone=function(t){t=t&&this.graphics?this.graphics.clone():this.graphics;return this._cloneProps(new e(t))},t.toString=function(){return"[Shape (name="+this.name+")]"},R.Shape=R.promote(e,"DisplayObject")}(),function(){"use strict";function g(t,e,i){this.DisplayObject_constructor(),this.text=t,this.font=e,this.color=i,this.textAlign="left",this.textBaseline="top",this.maxWidth=null,this.outline=0,this.lineHeight=0,this.lineWidth=null}var t=R.extend(g,R.DisplayObject),e=R.createCanvas?R.createCanvas():document.createElement("canvas");e.getContext&&(g._workingContext=e.getContext("2d"),e.width=e.height=1),g.H_OFFSETS={start:0,left:0,center:-.5,end:-1,right:-1},g.V_OFFSETS={top:0,hanging:-.01,middle:-.4,alphabetic:-.8,ideographic:-.85,bottom:-1},t.isVisible=function(){var t=this.cacheCanvas||null!=this.text&&""!==this.text;return!!(this.visible&&0<this.alpha&&0!=this.scaleX&&0!=this.scaleY&&t)},t.draw=function(t,e){if(this.DisplayObject_draw(t,e))return!0;e=this.color||"#000";return this.outline?(t.strokeStyle=e,t.lineWidth=+this.outline):t.fillStyle=e,this._drawText(this._prepContext(t)),!0},t.getMeasuredWidth=function(){return this._getMeasuredWidth(this.text)},t.getMeasuredLineHeight=function(){return 1.2*this._getMeasuredWidth("M")},t.getMeasuredHeight=function(){return this._drawText(null,{}).height},t.getBounds=function(){var t=this.DisplayObject_getBounds();if(t)return t;if(null==this.text||""===this.text)return null;var e=this._drawText(null,{}),i=this.maxWidth&&this.maxWidth<e.width?this.maxWidth:e.width,n=i*g.H_OFFSETS[this.textAlign||"left"],t=(this.lineHeight||this.getMeasuredLineHeight())*g.V_OFFSETS[this.textBaseline||"top"];return this._rectangle.setValues(n,t,i,e.height)},t.getMetrics=function(){var t={lines:[]};return t.lineHeight=this.lineHeight||this.getMeasuredLineHeight(),t.vOffset=t.lineHeight*g.V_OFFSETS[this.textBaseline||"top"],this._drawText(null,t,t.lines)},t.clone=function(){return this._cloneProps(new g(this.text,this.font,this.color))},t.toString=function(){return"[Text (text="+(20<this.text.length?this.text.substr(0,17)+"...":this.text)+")]"},t._cloneProps=function(t){return this.DisplayObject__cloneProps(t),t.textAlign=this.textAlign,t.textBaseline=this.textBaseline,t.maxWidth=this.maxWidth,t.outline=this.outline,t.lineHeight=this.lineHeight,t.lineWidth=this.lineWidth,t},t._prepContext=function(t){return t.font=this.font||"10px sans-serif",t.textAlign=this.textAlign||"left",t.textBaseline=this.textBaseline||"top",t.lineJoin="miter",t.miterLimit=2.5,t},t._drawText=function(t,e,i){var n=!!t;n||((t=g._workingContext).save(),this._prepContext(t));for(var r=this.lineHeight||this.getMeasuredLineHeight(),s=0,a=0,o=String(this.text).split(/(?:\r\n|\r|\n)/),h=0,l=o.length;h<l;h++){var u=o[h],c=null;if(null!=this.lineWidth&&(c=t.measureText(u).width)>this.lineWidth)for(var d=u.split(/(\s)/),u=d[0],c=t.measureText(u).width,p=1,_=d.length;p<_;p+=2){var f=t.measureText(d[p]+d[p+1]).width;c+f>this.lineWidth?(n&&this._drawTextLine(t,u,a*r),i&&i.push(u),s<c&&(s=c),u=d[p+1],c=t.measureText(u).width,a++):(u+=d[p]+d[p+1],c+=f)}n&&this._drawTextLine(t,u,a*r),i&&i.push(u),s<(c=e&&null==c?t.measureText(u).width:c)&&(s=c),a++}return e&&(e.width=s,e.height=a*r),n||t.restore(),e},t._drawTextLine=function(t,e,i){this.outline?t.strokeText(e,0,i,this.maxWidth||65535):t.fillText(e,0,i,this.maxWidth||65535)},t._getMeasuredWidth=function(t){var e=g._workingContext;e.save();t=this._prepContext(e).measureText(t).width;return e.restore(),t},R.Text=R.promote(g,"DisplayObject")}(),function(){"use strict";function v(t,e){this.Container_constructor(),this.text=t||"",this.spriteSheet=e,this.lineHeight=0,this.letterSpacing=0,this.spaceWidth=0,this._oldProps={text:0,spriteSheet:0,lineHeight:0,letterSpacing:0,spaceWidth:0},this._oldStage=null,this._drawAction=null}var t=R.extend(v,R.Container);v.maxPoolSize=100,v._spritePool=[],t.draw=function(t,e){this.DisplayObject_draw(t,e)||(this._updateState(),this.Container_draw(t,e))},t.getBounds=function(){return this._updateText(),this.Container_getBounds()},t.isVisible=function(){var t=this.cacheCanvas||this.spriteSheet&&this.spriteSheet.complete&&this.text;return!!(this.visible&&0<this.alpha&&0!==this.scaleX&&0!==this.scaleY&&t)},t.clone=function(){return this._cloneProps(new v(this.text,this.spriteSheet))},t.addChild=t.addChildAt=t.removeChild=t.removeChildAt=t.removeAllChildren=function(){},t._updateState=function(){this._updateText()},t._cloneProps=function(t){return this.Container__cloneProps(t),t.lineHeight=this.lineHeight,t.letterSpacing=this.letterSpacing,t.spaceWidth=this.spaceWidth,t},t._getFrameIndex=function(t,e){var i,n=e.getAnimation(t);return n||(i=t==(i=t.toUpperCase())&&t==(i=t.toLowerCase())?null:i)&&(n=e.getAnimation(i)),n&&n.frames[0]},t._getFrame=function(t,e){t=this._getFrameIndex(t,e);return null==t?t:e.getFrame(t)},t._getLineHeight=function(t){t=this._getFrame("1",t)||this._getFrame("T",t)||this._getFrame("L",t)||t.getFrame(0);return t?t.rect.height:1},t._getSpaceWidth=function(t){t=this._getFrame("1",t)||this._getFrame("l",t)||this._getFrame("e",t)||this._getFrame("a",t)||t.getFrame(0);return t?t.rect.width:1},t._updateText=function(){var t,e,i=0,n=0,r=this._oldProps,s=!1,a=this.spaceWidth,o=this.lineHeight,h=this.spriteSheet,l=v._spritePool,u=this.children,c=0,d=u.length;for(e in r)r[e]!=this[e]&&(r[e]=this[e],s=!0);if(s){var p=!!this._getFrame(" ",h);p||a||(a=this._getSpaceWidth(h));for(var o=o||this._getLineHeight(h),_=0,f=this.text.length;_<f;_++){var g,m=this.text.charAt(_);" "!=m||p?"\n"!=m&&"\r"!=m?null!=(g=this._getFrameIndex(m,h))&&(c<d?t=u[c]:(u.push(t=l.length?l.pop():new R.Sprite),t.parent=this,d++),t.spriteSheet=h,t.gotoAndStop(g),t.x=i,t.y=n,c++,i+=t.getBounds().width+this.letterSpacing):("\r"==m&&"\n"==this.text.charAt(_+1)&&_++,i=0,n+=o):i+=a}for(;c<d;)l.push(t=u.pop()),t.parent=null,d--;l.length>v.maxPoolSize&&(l.length=v.maxPoolSize)}},R.BitmapText=R.promote(v,"Container")}(),function(){"use strict";function s(t){var e,i,n,r;this.Container_constructor(),s.inited||s.init(),t instanceof String||1<arguments.length?(e=t,i=arguments[1],n=arguments[2],r=arguments[3],null==n&&(n=-1),t=null):t&&(e=t.mode,i=t.startPosition,n=t.loop,r=t.labels),t=t||{labels:r},this.mode=e||s.INDEPENDENT,this.startPosition=i||0,this.loop=!0===n?-1:n||0,this.currentFrame=0,this.paused=t.paused||!1,this.actionsEnabled=!0,this.autoReset=!0,this.frameBounds=this.frameBounds||t.frameBounds,this.framerate=null,t.useTicks=t.paused=!0,this.timeline=new R.Timeline(t),this._synchOffset=0,this._rawPosition=-1,this._bound_resolveState=this._resolveState.bind(this),this._t=0,this._managed={}}var t=R.extend(s,R.Container);s.INDEPENDENT="independent",s.SINGLE_FRAME="single",s.SYNCHED="synched",s.inited=!1,s.init=function(){s.inited||(n.install(),s.inited=!0)},t._getLabels=function(){return this.timeline.getLabels()},t.getLabels=R.deprecate(t._getLabels,"MovieClip.getLabels"),t._getCurrentLabel=function(){return this.timeline.currentLabel},t.getCurrentLabel=R.deprecate(t._getCurrentLabel,"MovieClip.getCurrentLabel"),t._getDuration=function(){return this.timeline.duration},t.getDuration=R.deprecate(t._getDuration,"MovieClip.getDuration");try{Object.defineProperties(t,{labels:{get:t._getLabels},currentLabel:{get:t._getCurrentLabel},totalFrames:{get:t._getDuration},duration:{get:t._getDuration}})}catch(t){}function n(){throw"MovieClipPlugin cannot be instantiated."}t.initialize=s,t.isVisible=function(){return!!(this.visible&&0<this.alpha&&0!=this.scaleX&&0!=this.scaleY)},t.draw=function(t,e){return this.DisplayObject_draw(t,e)||(this._updateState(),this.Container_draw(t,e)),!0},t.play=function(){this.paused=!1},t.stop=function(){this.paused=!0},t.gotoAndPlay=function(t){this.paused=!1,this._goto(t)},t.gotoAndStop=function(t){this.paused=!0,this._goto(t)},t.advance=function(t){var e=s.INDEPENDENT;if(this.mode===e){for(var i=this,n=i.framerate;(i=i.parent)&&null===n;)i.mode===e&&(n=i._framerate);if(this._framerate=n,!this.paused){var t=null!==n&&-1!==n&&null!==t?t/(1e3/n)+this._t:1,r=0|t;for(this._t=t-r;r--;)this._updateTimeline(this._rawPosition+1,!1)}}},t.clone=function(){throw"MovieClip cannot be cloned."},t.toString=function(){return"[MovieClip (name="+this.name+")]"},t._updateState=function(){-1!==this._rawPosition&&this.mode===s.INDEPENDENT||this._updateTimeline(-1)},t._tick=function(t){this.advance(t&&t.delta),this.Container__tick(t)},t._goto=function(t){t=this.timeline.resolve(t);null!=t&&(this._t=0,this._updateTimeline(t,!0))},t._reset=function(){this._rawPosition=-1,this._t=this.currentFrame=0,this.paused=!1},t._updateTimeline=function(t,e){var i=this.mode!==s.INDEPENDENT,n=this.timeline;i&&(t=this.startPosition+(this.mode===s.SINGLE_FRAME?0:this._synchOffset)),this._rawPosition===(t=t<0?0:t)&&!i||(this._rawPosition=t,n.loop=this.loop,n.setPosition(t,i||!this.actionsEnabled,e,this._bound_resolveState))},t._renderFirstFrame=function(){var t=this.timeline,e=t.rawPosition;t.setPosition(0,!0,!0,this._bound_resolveState),t.rawPosition=e},t._resolveState=function(){var t,e=this.timeline;for(t in this.currentFrame=e.position,this._managed)this._managed[t]=1;for(var i=e.tweens,n=0,r=i.length;n<r;n++){var s=i[n],a=s.target;a===this||s.passive||(s=s._stepPosition,a instanceof R.DisplayObject?this._addManagedChild(a,s):this._setState(a.state,s))}for(var o=this.children,n=o.length-1;0<=n;n--){var h=o[n].id;1===this._managed[h]&&(this.removeChildAt(n),delete this._managed[h])}},t._setState=function(t,e){if(t)for(var i=t.length-1;0<=i;i--){var n,r=t[i],s=r.t,a=r.p;for(n in a)s[n]=a[n];this._addManagedChild(s,e)}},t._addManagedChild=function(t,e){t._off||(this.addChildAt(t,0),t instanceof s&&(t._synchOffset=e,t.mode===s.INDEPENDENT&&t.autoReset&&!this._managed[t.id]&&t._reset()),this._managed[t.id]=2)},t._getBounds=function(t,e){var i=this.DisplayObject_getBounds();return i||this.frameBounds&&(i=this._rectangle.copy(this.frameBounds[this.currentFrame])),i?this._transformBounds(i,t,e):this.Container__getBounds(t,e)},R.MovieClip=R.promote(s,"Container"),n.priority=100,n.ID="MovieClip",n.install=function(){R.Tween._installPlugin(n)},n.init=function(t,e,i){"startPosition"===e&&t.target instanceof s&&t._addPlugin(n)},n.step=function(t,e,i){},n.change=function(t,e,i,n,r,s){if("startPosition"===i)return(1===r?e:e.prev).props[i]}}(),function(){"use strict";function E(){throw"SpriteSheetUtils cannot be instantiated"}var t=R.createCanvas?R.createCanvas():document.createElement("canvas");t.getContext&&(E._workingCanvas=t,E._workingContext=t.getContext("2d"),t.width=t.height=1),E.extractFrame=function(t,e){isNaN(e)&&(e=t.getAnimation(e).frames[0]);var i=t.getFrame(e);if(!i)return null;t=i.rect,e=E._workingCanvas;e.width=t.width,e.height=t.height,E._workingContext.drawImage(i.image,t.x,t.y,t.width,t.height,0,0,t.width,t.height);t=document.createElement("img");return t.src=e.toDataURL("image/png"),t},E.addFlippedFrames=R.deprecate(null,"SpriteSheetUtils.addFlippedFrames"),E.mergeAlpha=R.deprecate(null,"SpriteSheetUtils.mergeAlpha"),E._flip=function(t,e,i,n){for(var r=t._images,s=E._workingCanvas,a=E._workingContext,o=r.length/e,h=0;h<o;h++){var l=r[h];l.__tmp=h,a.setTransform(1,0,0,1,0,0),a.clearRect(0,0,s.width+1,s.height+1),s.width=l.width,s.height=l.height,a.setTransform(i?-1:1,0,0,n?-1:1,i?l.width:0,n?l.height:0),a.drawImage(l,0,0);var u=document.createElement("img");u.src=s.toDataURL("image/png"),u.width=l.width||l.naturalWidth,u.height=l.height||l.naturalHeight,r.push(u)}for(var c=(y=t._frames).length/e,h=0;h<c;h++){var d=(l=y[h]).rect.clone(),p={image:u=r[l.image.__tmp+o*e],rect:d,regX:l.regX,regY:l.regY};i&&(d.x=(u.width||u.naturalWidth)-d.x-d.width,p.regX=d.width-l.regX),n&&(d.y=(u.height||u.naturalHeight)-d.y-d.height,p.regY=d.height-l.regY),y.push(p)}var _="_"+(i?"h":"")+(n?"v":""),f=t._animations,g=t._data,m=f.length/e;for(h=0;h<m;h++){var v=f[h],b={name:v+_,speed:(l=g[v]).speed,next:l.next,frames:[]};l.next&&(b.next+=_);for(var y,T=0,S=(y=l.frames).length;T<S;T++)b.frames.push(y[T]+c*e);g[b.name]=b,f.push(b.name)}},R.SpriteSheetUtils=E}(),function(){"use strict";function T(t){this.EventDispatcher_constructor(),this.maxWidth=2048,this.maxHeight=2048,this.spriteSheet=null,this.scale=1,this.padding=1,this.timeSlice=.3,this.progress=-1,this.framerate=t||0,this._frames=[],this._animations={},this._data=null,this._nextFrameIndex=0,this._index=0,this._timerID=null,this._scale=1}var t=R.extend(T,R.EventDispatcher);T.ERR_DIMENSIONS="frame dimensions exceed max spritesheet dimensions",T.ERR_RUNNING="a build is already running",t.addFrame=function(t,e,i,n,r){if(this._data)throw T.ERR_RUNNING;e=e||t.bounds||t.nominalBounds;return(e=!e&&t.getBounds?t.getBounds():e)?this._frames.push({source:t,sourceRect:e,scale:i=i||1,funct:n,data:r,index:this._frames.length,height:e.height*i})-1:null},t.addAnimation=function(t,e,i,n){if(this._data)throw T.ERR_RUNNING;this._animations[t]={frames:e,next:i,speed:n}},t.addMovieClip=function(t,e,i,n,r,s){if(this._data)throw T.ERR_RUNNING;var a=t.frameBounds,o=e||t.bounds||t.nominalBounds;if((o=!o&&t.getBounds?t.getBounds():o)||a){for(var h,l=this._frames.length,u=t.timeline.duration,c=0;c<u;c++){var d=a&&a[c]?a[c]:o;this.addFrame(t,d,i,this._setupMovieClipFrame,{i:c,f:n,d:r})}var p,_=t.timeline._labels,f=[];for(p in _)f.push({index:_[p],label:p});if(f.length)for(f.sort(function(t,e){return t.index-e.index}),c=0,h=f.length;c<h;c++){for(var g=f[c].label,m=l+f[c].index,v=l+(c==h-1?u:f[c+1].index),b=[],y=m;y<v;y++)b.push(y);s&&!(g=s(g,t,m,v))||this.addAnimation(g,b,!0)}}},t.build=function(){if(this._data)throw T.ERR_RUNNING;for(this._startBuild();this._drawNext(););return this._endBuild(),this.spriteSheet},t.buildAsync=function(t){if(this._data)throw T.ERR_RUNNING;this.timeSlice=t,this._startBuild();var e=this;this._timerID=setTimeout(function(){e._run()},50-50*Math.max(.01,Math.min(.99,this.timeSlice||.3)))},t.stopAsync=function(){clearTimeout(this._timerID),this._data=null},t.clone=function(){throw"SpriteSheetBuilder cannot be cloned."},t.toString=function(){return"[SpriteSheetBuilder]"},t._startBuild=function(){var t=this.padding||0;this.progress=0,this.spriteSheet=null,this._index=0,this._scale=this.scale;var e=[];this._data={images:[],frames:e,framerate:this.framerate,animations:this._animations};var i=this._frames.slice();if(i.sort(function(t,e){return t.height<=e.height?-1:1}),i[i.length-1].height+2*t>this.maxHeight)throw T.ERR_DIMENSIONS;for(var n=0,r=0,s=0;i.length;){var a,o=this._fillRow(i,n,s,e,t);o.w>r&&(r=o.w),n+=o.h,o.h&&i.length||((a=R.createCanvas?R.createCanvas():document.createElement("canvas")).width=this._getSize(r,this.maxWidth),a.height=this._getSize(n,this.maxHeight),this._data.images[s]=a,o.h||(r=n=0,s++))}},t._setupMovieClipFrame=function(t,e){var i=t.actionsEnabled;t.actionsEnabled=!1,t.gotoAndStop(e.i),t.actionsEnabled=i,e.f&&e.f(t,e.d,e.i)},t._getSize=function(t,e){for(var i=4;Math.pow(2,++i)<t;);return Math.min(e,Math.pow(2,i))},t._fillRow=function(t,e,i,n,r){for(var s=this.maxWidth,a=this.maxHeight-(e+=r),o=r,h=0,l=t.length-1;0<=l;l--){var u=t[l],c=this._scale*u.scale,d=u.sourceRect,p=u.source,_=Math.floor(c*d.x-r),f=Math.floor(c*d.y-r),g=Math.ceil(c*d.height+2*r),d=Math.ceil(c*d.width+2*r);if(s<d)throw T.ERR_DIMENSIONS;a<g||s<o+d||(u.img=i,u.rect=new R.Rectangle(o,e,d,g),h=h||g,t.splice(l,1),n[u.index]=[o,e,d,g,i,Math.round(-_+c*p.regX-r),Math.round(-f+c*p.regY-r)],o+=d)}return{w:o,h:h}},t._endBuild=function(){this.spriteSheet=new R.SpriteSheet(this._data),this._data=null,this.progress=1,this.dispatchEvent("complete")},t._run=function(){for(var t,e=50*Math.max(.01,Math.min(.99,this.timeSlice||.3)),i=(new Date).getTime()+e,n=!1;i>(new Date).getTime();)if(!this._drawNext()){n=!0;break}n?this._endBuild():(t=this)._timerID=setTimeout(function(){t._run()},50-e);var r=this.progress=this._index/this._frames.length;this.hasEventListener("progress")&&((e=new R.Event("progress")).progress=r,this.dispatchEvent(e))},t._drawNext=function(){var t=this._frames[this._index],e=t.scale*this._scale,i=t.rect,n=t.sourceRect,r=this._data.images[t.img].getContext("2d");return t.funct&&t.funct(t.source,t.data),r.save(),r.beginPath(),r.rect(i.x,i.y,i.width,i.height),r.clip(),r.translate(Math.ceil(i.x-n.x*e),Math.ceil(i.y-n.y*e)),r.scale(e,e),t.source.draw(r),r.restore(),++this._index<this._frames.length},R.SpriteSheetBuilder=R.promote(T,"EventDispatcher")}(),function(){"use strict";function t(t){this.DisplayObject_constructor(),"string"==typeof t&&(t=document.getElementById(t)),this.mouseEnabled=!1;var e=t.style;e.position="absolute",e.transformOrigin=e.WebkitTransformOrigin=e.msTransformOrigin=e.MozTransformOrigin=e.OTransformOrigin="0% 0%",this.htmlElement=t,this._oldProps=null,this._oldStage=null,this._drawAction=null}var e=R.extend(t,R.DisplayObject);e.isVisible=function(){return null!=this.htmlElement},e.draw=function(t,e){return!0},e.cache=function(){},e.uncache=function(){},e.updateCache=function(){},e.hitTest=function(){},e.localToGlobal=function(){},e.globalToLocal=function(){},e.localToLocal=function(){},e.clone=function(){throw"DOMElement cannot be cloned."},e.toString=function(){return"[DOMElement (name="+this.name+")]"},e._tick=function(t){var e=this.stage;e&&e!==this._oldStage&&(this._drawAction&&e.off("drawend",this._drawAction),this._drawAction=e.on("drawend",this._handleDrawEnd,this),this._oldStage=e),this.DisplayObject__tick(t)},e._handleDrawEnd=function(t){var e,i,n,r,s,a=this.htmlElement;a&&(e=a.style,n=(i=this.getConcatenatedDisplayProps(this._props)).matrix,(s=i.visible?"visible":"hidden")!=e.visibility&&(e.visibility=s),i.visible&&(r=1e4,(s=(a=this._oldProps)&&a.matrix)&&s.equals(n)||(s="matrix("+(n.a*r|0)/r+","+(n.b*r|0)/r+","+(n.c*r|0)/r+","+(n.d*r|0)/r+","+(n.tx+.5|0),e.transform=e.WebkitTransform=e.OTransform=e.msTransform=s+","+(n.ty+.5|0)+")",e.MozTransform=s+"px,"+(n.ty+.5|0)+"px)",(a=a||(this._oldProps=new R.DisplayProps(!0,null))).matrix.copy(n)),a.alpha!=i.alpha&&(e.opacity=""+(i.alpha*r|0)/r,a.alpha=i.alpha)))},R.DOMElement=R.promote(t,"DisplayObject")}(),function(){"use strict";function t(){this.usesContext=!1,this._multiPass=null,this.VTX_SHADER_BODY=null,this.FRAG_SHADER_BODY=null}var e=t.prototype;e.getBounds=function(t){return t},e.shaderParamSetup=function(t,e,i){},e.applyFilter=function(t,e,i,n,r,s,a,o){s=s||t,null==a&&(a=e),null==o&&(o=i);try{var h=t.getImageData(e,i,n,r)}catch(t){return!1}return!!this._applyFilter(h)&&(s.putImageData(h,a,o),!0)},e.toString=function(){return"[Filter]"},e.clone=function(){return new t},e._applyFilter=function(t){return!0},R.Filter=t}(),function(){"use strict";function n(){this.width=void 0,this.height=void 0,this.x=void 0,this.y=void 0,this.scale=1,this.offX=0,this.offY=0,this.cacheID=0,this._filterOffX=0,this._filterOffY=0,this._cacheDataURLID=0,this._cacheDataURL=null,this._drawWidth=0,this._drawHeight=0}var t=n.prototype;n.getFilterBounds=function(t,e){e=e||new R.Rectangle;var i=t.filters,n=i&&i.length;if(!!n<=0)return e;for(var r=0;r<n;r++){var s=i[r];s&&s.getBounds&&((s=s.getBounds())&&(0==r?e.setValues(s.x,s.y,s.width,s.height):e.extend(s.x,s.y,s.width,s.height)))}return e},t.toString=function(){return"[BitmapCache]"},t.define=function(t,e,i,n,r,s,a){if(!t)throw"No symbol to cache";this._options=a,this.target=t,this.width=1<=n?n:1,this.height=1<=r?r:1,this.x=e||0,this.y=i||0,this.scale=s||1,this.update()},t.update=function(t){if(!this.target)throw"define() must be called before update()";var e=n.getFilterBounds(this.target),i=this.target.cacheCanvas;this._drawWidth=Math.ceil(this.width*this.scale)+e.width,this._drawHeight=Math.ceil(this.height*this.scale)+e.height,i&&this._drawWidth==i.width&&this._drawHeight==i.height||this._updateSurface(),this._filterOffX=e.x,this._filterOffY=e.y,this.offX=this.x*this.scale+this._filterOffX,this.offY=this.y*this.scale+this._filterOffY,this._drawToCache(t),this.cacheID=this.cacheID?this.cacheID+1:1},t.release=function(){var t;this._webGLCache?(this._webGLCache.isCacheControlled||(this.__lastRT&&(this.__lastRT=void 0),this.__rtA&&this._webGLCache._killTextureObject(this.__rtA),this.__rtB&&this._webGLCache._killTextureObject(this.__rtB),this.target&&this.target.cacheCanvas&&this._webGLCache._killTextureObject(this.target.cacheCanvas)),this._webGLCache=!1):(t=this.target.stage)instanceof R.StageGL&&t.releaseTexture(this.target.cacheCanvas),this.target=this.target.cacheCanvas=null,this.cacheID=this._cacheDataURLID=this._cacheDataURL=void 0,this.width=this.height=this.x=this.y=this.offX=this.offY=0,this.scale=1},t.getCacheDataURL=function(){var t=this.target&&this.target.cacheCanvas;return t?(this.cacheID!=this._cacheDataURLID&&(this._cacheDataURLID=this.cacheID,this._cacheDataURL=t.toDataURL?t.toDataURL():null),this._cacheDataURL):null},t.draw=function(t){return!!this.target&&(t.drawImage(this.target.cacheCanvas,this.x+this._filterOffX/this.scale,this.y+this._filterOffY/this.scale,this._drawWidth/this.scale,this._drawHeight/this.scale),!0)},t._updateSurface=function(){if(!this._options||!this._options.useGL)return(e=(e=this.target.cacheCanvas)||(this.target.cacheCanvas=R.createCanvas?R.createCanvas():document.createElement("canvas"))).width=this._drawWidth,void(e.height=this._drawHeight);if(!this._webGLCache)if("stage"===this._options.useGL){if(!this.target.stage||!this.target.stage.isWebGL){var t="Cannot use 'stage' for cache because the object's parent stage is ";throw t+=this.target.stage?"non WebGL.":"not set, please addChild to the correct stage."}this.target.cacheCanvas=!0,this._webGLCache=this.target.stage}else if("new"===this._options.useGL)this.target.cacheCanvas=document.createElement("canvas"),this._webGLCache=new R.StageGL(this.target.cacheCanvas,{antialias:!0,transparent:!0,autoPurge:-1}),this._webGLCache.isCacheControlled=!0;else{if(!(this._options.useGL instanceof R.StageGL))throw"Invalid option provided to useGL, expected ['stage', 'new', StageGL, undefined], got "+this._options.useGL;this.target.cacheCanvas=!0,this._webGLCache=this._options.useGL,this._webGLCache.isCacheControlled=!0}var e=this.target.cacheCanvas,t=this._webGLCache;t.isCacheControlled&&(e.width=this._drawWidth,e.height=this._drawHeight,t.updateViewport(this._drawWidth,this._drawHeight)),this.target.filters?(t.getTargetRenderTexture(this.target,this._drawWidth,this._drawHeight),t.getTargetRenderTexture(this.target,this._drawWidth,this._drawHeight)):t.isCacheControlled||t.getTargetRenderTexture(this.target,this._drawWidth,this._drawHeight)},t._drawToCache=function(t){var e=this.target.cacheCanvas,i=this.target,n=this._webGLCache;n?(n.cacheDraw(i,i.filters,this),(e=this.target.cacheCanvas).width=this._drawWidth,e.height=this._drawHeight):(n=e.getContext("2d"),t||n.clearRect(0,0,this._drawWidth+1,this._drawHeight+1),n.save(),n.globalCompositeOperation=t,n.setTransform(this.scale,0,0,this.scale,-this._filterOffX,-this._filterOffY),n.translate(-this.x,-this.y),i.draw(n,!0),n.restore(),i.filters&&i.filters.length&&this._applyFilters(n)),e._invalid=!0},t._applyFilters=function(t){for(var e,i=this.target.filters,n=this._drawWidth,r=this._drawHeight,s=0,a=i[s];a.usesContext?(e&&(t.putImageData(e,0,0),e=null),a.applyFilter(t,0,0,n,r)):(e=e||t.getImageData(0,0,n,r),a._applyFilter(e)),a=null!==a._multiPass?a._multiPass:i[++s];);e&&t.putImageData(e,0,0)},R.BitmapCache=n}(),function(){"use strict";function U(t,e,i){this.Filter_constructor(),this._blurX=t,this._blurXTable=[],this._lastBlurX=null,this._blurY=e,this._blurYTable=[],this._lastBlurY=null,this._quality,this._lastQuality=null,this.FRAG_SHADER_TEMPLATE="uniform float xWeight[{{blurX}}];uniform float yWeight[{{blurY}}];uniform vec2 textureOffset;void main(void) {vec4 color = vec4(0.0);float xAdj = ({{blurX}}.0-1.0)/2.0;float yAdj = ({{blurY}}.0-1.0)/2.0;vec2 sampleOffset;for(int i=0; i<{{blurX}}; i++) {for(int j=0; j<{{blurY}}; j++) {sampleOffset = vRenderCoord + (textureOffset * vec2(float(i)-xAdj, float(j)-yAdj));color += texture2D(uSampler, sampleOffset) * (xWeight[i] * yWeight[j]);}}gl_FragColor = color.rgba;}",(isNaN(i)||i<1)&&(i=1),this.setQuality(0|i)}var t=R.extend(U,R.Filter);t.getBlurX=function(){return this._blurX},t.getBlurY=function(){return this._blurY},t.setBlurX=function(t){(isNaN(t)||t<0)&&(t=0),this._blurX=t},t.setBlurY=function(t){(isNaN(t)||t<0)&&(t=0),this._blurY=t},t.getQuality=function(){return this._quality},t.setQuality=function(t){(isNaN(t)||t<0)&&(t=0),this._quality=0|t},t._getShader=function(){var t=this._lastBlurX!==this._blurX,e=this._lastBlurY!==this._blurY,i=this._lastQuality!==this._quality;return t||e||i?((t||i)&&(this._blurXTable=this._getTable(this._blurX*this._quality)),(e||i)&&(this._blurYTable=this._getTable(this._blurY*this._quality)),this._updateShader(),this._lastBlurX=this._blurX,this._lastBlurY=this._blurY,void(this._lastQuality=this._quality)):this._compiledShader},t._setShader=function(){this._compiledShader};try{Object.defineProperties(t,{blurX:{get:t.getBlurX,set:t.setBlurX},blurY:{get:t.getBlurY,set:t.setBlurY},quality:{get:t.getQuality,set:t.setQuality},_builtShader:{get:t._getShader,set:t._setShader}})}catch(t){console.log(t)}t._getTable=function(t){if(t<=1)return[1];for(var e=[],t=Math.ceil(2*t),i=(t+=t%2?0:1)/2|0,n=-i;n<=i;n++){var r=n/i*4.2;e.push(1/Math.sqrt(2*Math.PI)*Math.pow(Math.E,-Math.pow(r,2)/4))}var s=e.reduce(function(t,e){return t+e});return e.map(function(t,e,i){return t/s})},t._updateShader=function(){var t;void 0!==this._blurX&&void 0!==this._blurY&&(t=(t=(t=this.FRAG_SHADER_TEMPLATE).replace(/\{\{blurX\}\}/g,this._blurXTable.length.toFixed(0))).replace(/\{\{blurY\}\}/g,this._blurYTable.length.toFixed(0)),this.FRAG_SHADER_BODY=t)},t.shaderParamSetup=function(t,e,i){t.uniform1fv(t.getUniformLocation(i,"xWeight"),this._blurXTable),t.uniform1fv(t.getUniformLocation(i,"yWeight"),this._blurYTable),t.uniform2f(t.getUniformLocation(i,"textureOffset"),2/(e._viewportWidth*this._quality),2/(e._viewportHeight*this._quality))},U.MUL_TABLE=[1,171,205,293,57,373,79,137,241,27,391,357,41,19,283,265,497,469,443,421,25,191,365,349,335,161,155,149,9,278,269,261,505,245,475,231,449,437,213,415,405,395,193,377,369,361,353,345,169,331,325,319,313,307,301,37,145,285,281,69,271,267,263,259,509,501,493,243,479,118,465,459,113,446,55,435,429,423,209,413,51,403,199,393,97,3,379,375,371,367,363,359,355,351,347,43,85,337,333,165,327,323,5,317,157,311,77,305,303,75,297,294,73,289,287,71,141,279,277,275,68,135,67,133,33,262,260,129,511,507,503,499,495,491,61,121,481,477,237,235,467,232,115,457,227,451,7,445,221,439,218,433,215,427,425,211,419,417,207,411,409,203,202,401,399,396,197,49,389,387,385,383,95,189,47,187,93,185,23,183,91,181,45,179,89,177,11,175,87,173,345,343,341,339,337,21,167,83,331,329,327,163,81,323,321,319,159,79,315,313,39,155,309,307,153,305,303,151,75,299,149,37,295,147,73,291,145,289,287,143,285,71,141,281,35,279,139,69,275,137,273,17,271,135,269,267,133,265,33,263,131,261,130,259,129,257,1],U.SHG_TABLE=[0,9,10,11,9,12,10,11,12,9,13,13,10,9,13,13,14,14,14,14,10,13,14,14,14,13,13,13,9,14,14,14,15,14,15,14,15,15,14,15,15,15,14,15,15,15,15,15,14,15,15,15,15,15,15,12,14,15,15,13,15,15,15,15,16,16,16,15,16,14,16,16,14,16,13,16,16,16,15,16,13,16,15,16,14,9,16,16,16,16,16,16,16,16,16,13,14,16,16,15,16,16,10,16,15,16,14,16,16,14,16,16,14,16,16,14,15,16,16,16,14,15,14,15,13,16,16,15,17,17,17,17,17,17,14,15,17,17,16,16,17,16,15,17,16,17,11,17,16,17,16,17,16,17,17,16,17,17,16,17,17,16,16,17,17,17,16,14,17,17,17,17,15,16,14,16,15,16,13,16,15,16,14,16,15,16,12,16,15,16,17,17,17,17,17,13,16,15,17,17,17,16,15,17,17,17,16,15,17,17,14,16,17,17,16,17,17,16,15,17,16,14,17,16,15,17,16,17,17,16,17,15,16,17,14,17,16,15,17,16,17,13,17,16,17,17,16,17,14,17,16,17,16,17,16,17,9],t.getBounds=function(t){var e=0|this.blurX,i=0|this.blurY;if(e<=0&&i<=0)return t;var n=Math.pow(this.quality,.2);return(t||new R.Rectangle).pad(i*n+1,e*n+1,i*n+1,e*n+1)},t.clone=function(){return new U(this.blurX,this.blurY,this.quality)},t.toString=function(){return"[BlurFilter]"},t._applyFilter=function(t){var e=this._blurX>>1;if(isNaN(e)||e<0)return!1;var i=this._blurY>>1;if(isNaN(i)||i<0)return!1;if(0==e&&0==i)return!1;var n=this.quality;(isNaN(n)||n<1)&&(n=1),(n=3<(n|=0)?3:n)<1&&(n=1);for(var r=t.data,s=0,a=0,o=0,h=0,l=0,u=0,c=0,d=0,p=0,_=0,f=0,g=0,m=0,v=0,b=0,y=e+e+1|0,T=i+i+1|0,S=0|t.width,E=0|t.height,w=S-1|0,x=E-1|0,A=1+e|0,R=1+i|0,P={r:0,b:0,g:0,a:0},L=P,o=1;o<y;o++)L=L.n={r:0,b:0,g:0,a:0};L.n=P;var C={r:0,b:0,g:0,a:0},I=C;for(o=1;o<T;o++)I=I.n={r:0,b:0,g:0,a:0};I.n=C;for(var D=null,M=0|U.MUL_TABLE[e],O=0|U.SHG_TABLE[e],F=0|U.MUL_TABLE[i],N=0|U.SHG_TABLE[i];0<n--;){for(var c=u=0,k=M,B=O,a=E;-1<--a;){for(d=A*(g=r[0|u]),p=A*(m=r[u+1|0]),_=A*(v=r[u+2|0]),f=A*(b=r[u+3|0]),L=P,o=A;-1<--o;)L.r=g,L.g=m,L.b=v,L.a=b,L=L.n;for(o=1;o<A;o++)d+=L.r=r[h=u+((w<o?w:o)<<2)|0],p+=L.g=r[h+1],_+=L.b=r[h+2],f+=L.a=r[h+3],L=L.n;for(D=P,s=0;s<S;s++)r[u++]=d*k>>>B,r[u++]=p*k>>>B,r[u++]=_*k>>>B,r[u++]=f*k>>>B,h=c+((h=s+e+1)<w?h:w)<<2,d-=D.r-(D.r=r[h]),p-=D.g-(D.g=r[h+1]),_-=D.b-(D.b=r[h+2]),f-=D.a-(D.a=r[h+3]),D=D.n;c+=S}for(k=F,B=N,s=0;s<S;s++){for(d=R*(g=r[u=s<<2|0])|0,p=R*(m=r[u+1|0])|0,_=R*(v=r[u+2|0])|0,f=R*(b=r[u+3|0])|0,I=C,o=0;o<R;o++)I.r=g,I.g=m,I.b=v,I.a=b,I=I.n;for(l=S,o=1;o<=i;o++)d+=I.r=r[u=l+s<<2],p+=I.g=r[u+1],_+=I.b=r[u+2],f+=I.a=r[u+3],I=I.n,o<x&&(l+=S);if(u=s,D=C,0<n)for(a=0;a<E;a++)r[(h=u<<2)+3]=b=f*k>>>B,0<b?(r[h]=d*k>>>B,r[h+1]=p*k>>>B,r[h+2]=_*k>>>B):r[h]=r[h+1]=r[h+2]=0,h=s+((h=a+R)<x?h:x)*S<<2,d-=D.r-(D.r=r[h]),p-=D.g-(D.g=r[h+1]),_-=D.b-(D.b=r[h+2]),f-=D.a-(D.a=r[h+3]),D=D.n,u+=S;else for(a=0;a<E;a++)r[(h=u<<2)+3]=b=f*k>>>B,0<b?(r[h]=(d*k>>>B)*(b=255/b),r[h+1]=(p*k>>>B)*b,r[h+2]=(_*k>>>B)*b):r[h]=r[h+1]=r[h+2]=0,h=s+((h=a+R)<x?h:x)*S<<2,d-=D.r-(D.r=r[h]),p-=D.g-(D.g=r[h+1]),_-=D.b-(D.b=r[h+2]),f-=D.a-(D.a=r[h+3]),D=D.n,u+=S}}return!0},R.BlurFilter=R.promote(U,"Filter")}(),function(){"use strict";function e(t){this.Filter_constructor(),this.alphaMap=t,this._alphaMap=null,this._mapData=null,this._mapTexture=null,this.FRAG_SHADER_BODY="uniform sampler2D uAlphaSampler;void main(void) {vec4 color = texture2D(uSampler, vRenderCoord);vec4 alphaMap = texture2D(uAlphaSampler, vTextureCoord);gl_FragColor = vec4(color.rgb, color.a * (alphaMap.r * ceil(alphaMap.a)));}"}var t=R.extend(e,R.Filter);t.shaderParamSetup=function(t,e,i){this._mapTexture||(this._mapTexture=t.createTexture()),t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,this._mapTexture),e.setTextureParams(t),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,this.alphaMap),t.uniform1i(t.getUniformLocation(i,"uAlphaSampler"),1)},t.clone=function(){var t=new e(this.alphaMap);return t._alphaMap=this._alphaMap,t._mapData=this._mapData,t},t.toString=function(){return"[AlphaMapFilter]"},t._applyFilter=function(t){if(!this.alphaMap)return!0;if(!this._prepAlphaMap())return!1;for(var e=t.data,i=this._mapData,n=0,r=e.length;n<r;n+=4)e[n+3]=i[n]||0;return!0},t._prepAlphaMap=function(){if(!this.alphaMap)return!1;if(this.alphaMap==this._alphaMap&&this._mapData)return!0;this._mapData=null;var t,e=this._alphaMap=this.alphaMap,i=e;e instanceof HTMLCanvasElement?t=i.getContext("2d"):((i=R.createCanvas?R.createCanvas():document.createElement("canvas")).width=e.width,i.height=e.height,(t=i.getContext("2d")).drawImage(e,0,0));try{var n=t.getImageData(0,0,e.width,e.height)}catch(t){return!1}return this._mapData=n.data,!0},R.AlphaMapFilter=R.promote(e,"Filter")}(),function(){"use strict";function t(t){this.Filter_constructor(),this.mask=t,this.usesContext=!0,this.FRAG_SHADER_BODY="uniform sampler2D uAlphaSampler;void main(void) {vec4 color = texture2D(uSampler, vRenderCoord);vec4 alphaMap = texture2D(uAlphaSampler, vTextureCoord);gl_FragColor = vec4(color.rgb, color.a * alphaMap.a);}"}var e=R.extend(t,R.Filter);e.shaderParamSetup=function(t,e,i){this._mapTexture||(this._mapTexture=t.createTexture()),t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,this._mapTexture),e.setTextureParams(t),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,this.mask),t.uniform1i(t.getUniformLocation(i,"uAlphaSampler"),1)},e.applyFilter=function(t,e,i,n,r,s,a,o){return!this.mask||(null==a&&(a=e),null==o&&(o=i),(s=s||t).save(),t==s&&(s.globalCompositeOperation="destination-in",s.drawImage(this.mask,a,o),s.restore(),!0))},e.clone=function(){return new t(this.mask)},e.toString=function(){return"[AlphaMaskFilter]"},R.AlphaMaskFilter=R.promote(t,"Filter")}(),function(){"use strict";function t(t,e,i,n,r,s,a,o){this.Filter_constructor(),this.redMultiplier=null!=t?t:1,this.greenMultiplier=null!=e?e:1,this.blueMultiplier=null!=i?i:1,this.alphaMultiplier=null!=n?n:1,this.redOffset=r||0,this.greenOffset=s||0,this.blueOffset=a||0,this.alphaOffset=o||0,this.FRAG_SHADER_BODY="uniform vec4 uColorMultiplier;uniform vec4 uColorOffset;void main(void) {vec4 color = texture2D(uSampler, vRenderCoord);gl_FragColor = (color * uColorMultiplier) + uColorOffset;}"}var e=R.extend(t,R.Filter);e.shaderParamSetup=function(t,e,i){t.uniform4f(t.getUniformLocation(i,"uColorMultiplier"),this.redMultiplier,this.greenMultiplier,this.blueMultiplier,this.alphaMultiplier),t.uniform4f(t.getUniformLocation(i,"uColorOffset"),this.redOffset/255,this.greenOffset/255,this.blueOffset/255,this.alphaOffset/255)},e.toString=function(){return"[ColorFilter]"},e.clone=function(){return new t(this.redMultiplier,this.greenMultiplier,this.blueMultiplier,this.alphaMultiplier,this.redOffset,this.greenOffset,this.blueOffset,this.alphaOffset)},e._applyFilter=function(t){for(var e=t.data,i=e.length,n=0;n<i;n+=4)e[n]=e[n]*this.redMultiplier+this.redOffset,e[n+1]=e[n+1]*this.greenMultiplier+this.greenOffset,e[n+2]=e[n+2]*this.blueMultiplier+this.blueOffset,e[n+3]=e[n+3]*this.alphaMultiplier+this.alphaOffset;return!0},R.ColorFilter=R.promote(t,"Filter")}(),function(){"use strict";function n(t,e,i,n){this.setColor(t,e,i,n)}var t=n.prototype;n.DELTA_INDEX=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10],n.LENGTH=(n.IDENTITY_MATRIX=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1]).length,t.setColor=function(t,e,i,n){return this.reset().adjustColor(t,e,i,n)},t.reset=function(){return this.copy(n.IDENTITY_MATRIX)},t.adjustColor=function(t,e,i,n){return this.adjustHue(n),this.adjustContrast(e),this.adjustBrightness(t),this.adjustSaturation(i)},t.adjustBrightness=function(t){return 0==t||isNaN(t)||(t=this._cleanValue(t,255),this._multiplyMatrix([1,0,0,0,t,0,1,0,0,t,0,0,1,0,t,0,0,0,1,0,0,0,0,0,1])),this},t.adjustContrast=function(t){return 0==t||isNaN(t)||(e=(t=this._cleanValue(t,100))<0?127+t/100*127:127*(e=0==(e=t%1)?n.DELTA_INDEX[t]:n.DELTA_INDEX[t<<0]*(1-e)+n.DELTA_INDEX[1+(t<<0)]*e)+127,this._multiplyMatrix([e/127,0,0,0,.5*(127-e),0,e/127,0,0,.5*(127-e),0,0,e/127,0,.5*(127-e),0,0,0,1,0,0,0,0,0,1])),this;var e},t.adjustSaturation=function(t){if(0==t||isNaN(t))return this;t=1+(0<(t=this._cleanValue(t,100))?3*t/100:t/100);return this._multiplyMatrix([.3086*(1-t)+t,.6094*(1-t),.082*(1-t),0,0,.3086*(1-t),.6094*(1-t)+t,.082*(1-t),0,0,.3086*(1-t),.6094*(1-t),.082*(1-t)+t,0,0,0,0,0,1,0,0,0,0,0,1]),this},t.adjustHue=function(t){if(0==t||isNaN(t))return this;t=this._cleanValue(t,180)/180*Math.PI;var e=Math.cos(t),i=Math.sin(t),n=.213,r=.715,t=.072;return this._multiplyMatrix([n+.787*e+i*-n,r+e*-r+i*-r,t+e*-t+.928*i,0,0,n+e*-n+.143*i,r+e*(1-r)+.14*i,t+e*-t+-.283*i,0,0,n+e*-n+-.787*i,r+e*-r+i*r,t+.928*e+i*t,0,0,0,0,0,1,0,0,0,0,0,1]),this},t.concat=function(t){return(t=this._fixMatrix(t)).length!=n.LENGTH||this._multiplyMatrix(t),this},t.clone=function(){return(new n).copy(this)},t.toArray=function(){for(var t=[],e=0,i=n.LENGTH;e<i;e++)t[e]=this[e];return t},t.copy=function(t){for(var e=n.LENGTH,i=0;i<e;i++)this[i]=t[i];return this},t.toString=function(){return"[ColorMatrix]"},t._multiplyMatrix=function(t){for(var e,i=[],n=0;n<5;n++){for(e=0;e<5;e++)i[e]=this[e+5*n];for(e=0;e<5;e++){for(var r=0,s=0;s<5;s++)r+=t[e+5*s]*i[s];this[e+5*n]=r}}},t._cleanValue=function(t,e){return Math.min(e,Math.max(-e,t))},t._fixMatrix=function(t){return(t=t instanceof n?t.toArray():t).length<n.LENGTH?t=t.slice(0,t.length).concat(n.IDENTITY_MATRIX.slice(t.length,n.LENGTH)):t.length>n.LENGTH&&(t=t.slice(0,n.LENGTH)),t},R.ColorMatrix=n}(),function(){"use strict";function t(t){this.Filter_constructor(),this.matrix=t,this.FRAG_SHADER_BODY="uniform mat4 uColorMatrix;uniform vec4 uColorMatrixOffset;void main(void) {vec4 color = texture2D(uSampler, vRenderCoord);mat4 m = uColorMatrix;vec4 newColor = vec4(0,0,0,0);newColor.r = color.r*m[0][0] + color.g*m[0][1] + color.b*m[0][2] + color.a*m[0][3];newColor.g = color.r*m[1][0] + color.g*m[1][1] + color.b*m[1][2] + color.a*m[1][3];newColor.b = color.r*m[2][0] + color.g*m[2][1] + color.b*m[2][2] + color.a*m[2][3];newColor.a = color.r*m[3][0] + color.g*m[3][1] + color.b*m[3][2] + color.a*m[3][3];gl_FragColor = newColor + uColorMatrixOffset;}"}var e=R.extend(t,R.Filter);e.shaderParamSetup=function(t,e,i){var n=this.matrix,r=new Float32Array([n[0],n[1],n[2],n[3],n[5],n[6],n[7],n[8],n[10],n[11],n[12],n[13],n[15],n[16],n[17],n[18]]);t.uniformMatrix4fv(t.getUniformLocation(i,"uColorMatrix"),!1,r),t.uniform4f(t.getUniformLocation(i,"uColorMatrixOffset"),n[4]/255,n[9]/255,n[14]/255,n[19]/255)},e.toString=function(){return"[ColorMatrixFilter]"},e.clone=function(){return new t(this.matrix)},e._applyFilter=function(t){for(var e,i,n,r,s=t.data,a=s.length,t=this.matrix,o=t[0],h=t[1],l=t[2],u=t[3],c=t[4],d=t[5],p=t[6],_=t[7],f=t[8],g=t[9],m=t[10],v=t[11],b=t[12],y=t[13],T=t[14],S=t[15],E=t[16],w=t[17],x=t[18],A=t[19],R=0;R<a;R+=4)e=s[R],i=s[R+1],n=s[R+2],r=s[R+3],s[R]=e*o+i*h+n*l+r*u+c,s[R+1]=e*d+i*p+n*_+r*f+g,s[R+2]=e*m+i*v+n*b+r*y+T,s[R+3]=e*S+i*E+n*w+r*x+A;return!0},R.ColorMatrixFilter=R.promote(t,"Filter")}(),function(){"use strict";function n(){throw"Touch cannot be instantiated"}n.isSupported=function(){return!!("ontouchstart"in window||window.navigator.msPointerEnabled&&0<window.navigator.msMaxTouchPoints||window.navigator.pointerEnabled&&0<window.navigator.maxTouchPoints)},n.enable=function(t,e,i){return!!(t&&t.canvas&&n.isSupported())&&(t.__touch||(t.__touch={pointers:{},multitouch:!e,preventDefault:!i,count:0},"ontouchstart"in window?n._IOS_enable(t):(window.navigator.msPointerEnabled||window.navigator.pointerEnabled)&&n._IE_enable(t)),!0)},n.disable=function(t){t&&("ontouchstart"in window?n._IOS_disable(t):(window.navigator.msPointerEnabled||window.navigator.pointerEnabled)&&n._IE_disable(t),delete t.__touch)},n._IOS_enable=function(e){var t=e.canvas,i=e.__touch.f=function(t){n._IOS_handleEvent(e,t)};t.addEventListener("touchstart",i,!1),t.addEventListener("touchmove",i,!1),t.addEventListener("touchend",i,!1),t.addEventListener("touchcancel",i,!1)},n._IOS_disable=function(t){var e=t.canvas;e&&(t=t.__touch.f,e.removeEventListener("touchstart",t,!1),e.removeEventListener("touchmove",t,!1),e.removeEventListener("touchend",t,!1),e.removeEventListener("touchcancel",t,!1))},n._IOS_handleEvent=function(t,e){if(t){t.__touch.preventDefault&&e.preventDefault&&e.preventDefault();for(var i=e.changedTouches,n=e.type,r=0,s=i.length;r<s;r++){var a=i[r],o=a.identifier;a.target==t.canvas&&("touchstart"==n?this._handleStart(t,o,e,a.pageX,a.pageY):"touchmove"==n?this._handleMove(t,o,e,a.pageX,a.pageY):"touchend"!=n&&"touchcancel"!=n||this._handleEnd(t,o,e))}}},n._IE_enable=function(e){var t=e.canvas,i=e.__touch.f=function(t){n._IE_handleEvent(e,t)};void 0===window.navigator.pointerEnabled?(t.addEventListener("MSPointerDown",i,!1),window.addEventListener("MSPointerMove",i,!1),window.addEventListener("MSPointerUp",i,!1),window.addEventListener("MSPointerCancel",i,!1),e.__touch.preventDefault&&(t.style.msTouchAction="none")):(t.addEventListener("pointerdown",i,!1),window.addEventListener("pointermove",i,!1),window.addEventListener("pointerup",i,!1),window.addEventListener("pointercancel",i,!1),e.__touch.preventDefault&&(t.style.touchAction="none")),e.__touch.activeIDs={}},n._IE_disable=function(t){var e=t.__touch.f;void 0===window.navigator.pointerEnabled?(window.removeEventListener("MSPointerMove",e,!1),window.removeEventListener("MSPointerUp",e,!1),window.removeEventListener("MSPointerCancel",e,!1),t.canvas&&t.canvas.removeEventListener("MSPointerDown",e,!1)):(window.removeEventListener("pointermove",e,!1),window.removeEventListener("pointerup",e,!1),window.removeEventListener("pointercancel",e,!1),t.canvas&&t.canvas.removeEventListener("pointerdown",e,!1))},n._IE_handleEvent=function(t,e){var i,n,r;t&&(t.__touch.preventDefault&&e.preventDefault&&e.preventDefault(),i=e.type,n=e.pointerId,r=t.__touch.activeIDs,"MSPointerDown"==i||"pointerdown"==i?e.srcElement==t.canvas&&(r[n]=!0,this._handleStart(t,n,e,e.pageX,e.pageY)):r[n]&&("MSPointerMove"==i||"pointermove"==i?this._handleMove(t,n,e,e.pageX,e.pageY):"MSPointerUp"!=i&&"MSPointerCancel"!=i&&"pointerup"!=i&&"pointercancel"!=i||(delete r[n],this._handleEnd(t,n,e))))},n._handleStart=function(t,e,i,n,r){var s,a=t.__touch;!a.multitouch&&a.count||((s=a.pointers)[e]||(s[e]=!0,a.count++,t._handlePointerDown(e,i,n,r)))},n._handleMove=function(t,e,i,n,r){t.__touch.pointers[e]&&t._handlePointerMove(e,i,n,r)},n._handleEnd=function(t,e,i){var n=t.__touch,r=n.pointers;r[e]&&(n.count--,t._handlePointerUp(e,i,!0),delete r[e])},R.Touch=n}(),function(){"use strict";var t=R.EaselJS=R.EaselJS||{};t.version="1.0.0",t.buildDate="Thu, 12 Oct 2017 16:34:10 GMT"}(),function(){"use strict";var t=R.PreloadJS=R.PreloadJS||{};t.version="1.0.0",t.buildDate="Thu, 12 Oct 2017 16:34:05 GMT"}(),function(){"use strict";R.proxy=function(t,e){var i=Array.prototype.slice.call(arguments,2);return function(){return t.apply(e,Array.prototype.slice.call(arguments,0).concat(i))}}}(),function(){"use strict";function t(t,e,i){this.Event_constructor("error"),this.title=t,this.message=e,this.data=i}R.extend(t,R.Event).clone=function(){return new R.ErrorEvent(this.title,this.message,this.data)},R.ErrorEvent=R.promote(t,"Event")}(),function(){"use strict";function t(t,e){this.Event_constructor("progress"),this.loaded=t,this.total=null==e?1:e,this.progress=0==e?0:this.loaded/this.total}R.extend(t,R.Event).clone=function(){return new R.ProgressEvent(this.loaded,this.total)},R.ProgressEvent=R.promote(t,"Event")}(window),function(){var t,e,i,n,r=c(1477),N={function:!0,object:!0},s=N[typeof u]&&u&&!u.nodeType&&u,k=N[typeof window]&&window||this,a=s&&N[typeof o]&&o&&!o.nodeType&&"object"==typeof h&&h;function B(t,o){t=t||k.Object(),o=o||k.Object();var h=t.Number||k.Number,l=t.String||k.String,e=t.Object||k.Object,u=t.Date||k.Date,i=t.SyntaxError||k.SyntaxError,T=t.TypeError||k.TypeError,n=t.Math||k.Math,t=t.JSON||k.JSON;"object"==typeof t&&t&&(o.stringify=t.stringify,o.parse=t.parse);var S,E,w,c,x,A,R,d,P,r,L,p,C,I,D,_,f,g,m,v,s,a,b,y,e=e.prototype,M=e.toString,O=new u(-0xc782b5b800cec);try{O=-109252==O.getUTCFullYear()&&0===O.getUTCMonth()&&1===O.getUTCDate()&&10==O.getUTCHours()&&37==O.getUTCMinutes()&&6==O.getUTCSeconds()&&708==O.getUTCMilliseconds()}catch(t){}function F(t){if(F[t]!==w)return F[t];var e;if("bug-string-char-index"==t)e="a"!="a"[0];else if("json"==t)e=F("json-stringify")&&F("json-parse");else{var i='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==t){var n=o.stringify,r="function"==typeof n&&O;if(r){(s=function(){return 1}).toJSON=s;try{r="0"===n(0)&&"0"===n(new h)&&'""'==n(new l)&&n(M)===w&&n(w)===w&&n()===w&&"1"===n(s)&&"[1]"==n([s])&&"[null]"==n([w])&&"null"==n(null)&&"[null,null,null]"==n([w,M,null])&&n({a:[s,!0,!1,null,"\0\b\n\f\r\t"]})==i&&"1"===n(null,s)&&"[\n 1,\n 2\n]"==n([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==n(new u(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==n(new u(864e13))&&'"-000001-01-01T00:00:00.000Z"'==n(new u(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==n(new u(-1))}catch(t){r=!1}}e=r}if("json-parse"==t){r=o.parse;if("function"==typeof r)try{if(0===r("0")&&!r(!1)){var s,a=5==(s=r(i)).a.length&&1===s.a[0];if(a){try{a=!r('"\t"')}catch(t){}if(a)try{a=1!==r("01")}catch(t){}if(a)try{a=1!==r("1.")}catch(t){}}}}catch(t){a=!1}e=a}}return F[t]=!!e}return F("json")||(c="[object Function]",x="[object Number]",A="[object String]",R="[object Array]",d=F("bug-string-char-index"),O||(P=n.floor,r=[0,31,59,90,120,151,181,212,243,273,304,334],L=function(t,e){return r[e]+365*(t-1970)+P((t-1969+(e=+(1<e)))/4)-P((t-1901+e)/100)+P((t-1601+e)/400)}),(S=e.hasOwnProperty)||(S=function(t){var i,e={__proto__:null};return e.__proto__={toString:1},S=e.toString!=M?function(t){var e=this.__proto__,t=t in(this.__proto__=null,this);return this.__proto__=e,t}:(i=e.constructor,function(t){var e=(this.constructor||i).prototype;return t in this&&!(t in e&&this[t]===e[t])}),e=null,S.call(this,t)}),E=function(t,e){var i,a,n,r=0;for(n in(i=function(){this.valueOf=0}).prototype.valueOf=0,a=new i)S.call(a,n)&&r++;return a=null,(E=r?2==r?function(t,e){var i,n={},r=M.call(t)==c;for(i in t)r&&"prototype"==i||S.call(n,i)||!(n[i]=1)||!S.call(t,i)||e(i)}:function(t,e){var i,n,r=M.call(t)==c;for(i in t)r&&"prototype"==i||!S.call(t,i)||(n="constructor"===i)||e(i);(n||S.call(t,i="constructor"))&&e(i)}:(a=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],function(t,e){var i,n,r=M.call(t)==c,s=!r&&"function"!=typeof t.constructor&&N[typeof t.hasOwnProperty]&&t.hasOwnProperty||S;for(i in t)r&&"prototype"==i||!s.call(t,i)||e(i);for(n=a.length;i=a[--n];s.call(t,i)&&e(i));}))(t,e)},F("json-stringify")||(p={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},C=function(t,e){return("000000"+(e||0)).slice(-t)},I=function(t){for(var e='"',i=0,n=t.length,r=!d||10<n,s=r&&(d?t.split(""):t);i<n;i++){var a=t.charCodeAt(i);switch(a){case 8:case 9:case 10:case 12:case 13:case 34:case 92:e+=p[a];break;default:if(a<32){e+="\\u00"+C(2,a.toString(16));break}e+=r?s[i]:t.charAt(i)}}return e+'"'},D=function(t,e,i,n,r,s,a){var o,h,l,u,c,d,p,_,f,g,m,v,b,y;try{o=e[t]}catch(t){}if("object"==typeof o&&o)if("[object Date]"!=(h=M.call(o))||S.call(o,"toJSON"))"function"==typeof o.toJSON&&(h!=x&&h!=A&&h!=R||S.call(o,"toJSON"))&&(o=o.toJSON(t));else if(-1/0<o&&o<1/0){if(L){for(c=P(o/864e5),l=P(c/365.2425)+1970-1;L(l+1,0)<=c;l++);for(u=P((c-L(l,0))/30.42);L(l,u+1)<=c;u++);c=1+c-L(l,u),d=P((f=(o%864e5+864e5)%864e5)/36e5)%24,p=P(f/6e4)%60,_=P(f/1e3)%60,f=f%1e3}else l=o.getUTCFullYear(),u=o.getUTCMonth(),c=o.getUTCDate(),d=o.getUTCHours(),p=o.getUTCMinutes(),_=o.getUTCSeconds(),f=o.getUTCMilliseconds();o=(l<=0||1e4<=l?(l<0?"-":"+")+C(6,l<0?-l:l):C(4,l))+"-"+C(2,u+1)+"-"+C(2,c)+"T"+C(2,d)+":"+C(2,p)+":"+C(2,_)+"."+C(3,f)+"Z"}else o=null;if(null===(o=i?i.call(e,t,o):o))return"null";if("[object Boolean]"==(h=M.call(o)))return""+o;if(h==x)return-1/0<o&&o<1/0?""+o:"null";if(h==A)return I(""+o);if("object"==typeof o){for(b=a.length;b--;)if(a[b]===o)throw T();if(a.push(o),g=[],t=s,s+=r,h==R){for(v=0,b=o.length;v<b;v++)m=D(v,o,i,n,r,s,a),g.push(m===w?"null":m);y=g.length?r?"[\n"+s+g.join(",\n"+s)+"\n"+t+"]":"["+g.join(",")+"]":"[]"}else E(n||o,function(t){var e=D(t,o,i,n,r,s,a);e!==w&&g.push(I(t)+":"+(r?" ":"")+e)}),y=g.length?r?"{\n"+s+g.join(",\n"+s)+"\n"+t+"}":"{"+g.join(",")+"}":"{}";return a.pop(),y}},o.stringify=function(t,e,i){var n,r,s;if(N[typeof e]&&e)if((s=M.call(e))==c)r=e;else if(s==R)for(var a,o={},h=0,l=e.length;h<l;a=e[h++],(s=M.call(a))!=A&&s!=x||(o[a]=1));if(i)if((s=M.call(i))==x){if(0<(i-=i%1))for(n="",10<i&&(i=10);n.length<i;n+=" ");}else s==A&&(n=i.length<=10?i:i.slice(0,10));return D("",((a={})[""]=t,a),r,o,n,"",[])}),F("json-parse")||(_=l.fromCharCode,f={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},v=function(){throw g=m=null,i()},s=function(){for(var t,e,i,n,r,s=m,a=s.length;g<a;)switch(r=s.charCodeAt(g)){case 9:case 10:case 13:case 32:g++;break;case 123:case 125:case 91:case 93:case 58:case 44:return t=d?s.charAt(g):s[g],g++,t;case 34:for(t="@",g++;g<a;)if((r=s.charCodeAt(g))<32)v();else if(92==r)switch(r=s.charCodeAt(++g)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:t+=f[r],g++;break;case 117:for(e=++g,i=g+4;g<i;g++)48<=(r=s.charCodeAt(g))&&r<=57||97<=r&&r<=102||65<=r&&r<=70||v();t+=_("0x"+s.slice(e,g));break;default:v()}else{if(34==r)break;for(r=s.charCodeAt(g),e=g;32<=r&&92!=r&&34!=r;)r=s.charCodeAt(++g);t+=s.slice(e,g)}if(34==s.charCodeAt(g))return g++,t;v();default:if(e=g,45==r&&(n=!0,r=s.charCodeAt(++g)),48<=r&&r<=57){for(48==r&&(48<=(r=s.charCodeAt(g+1))&&r<=57)&&v(),n=!1;g<a&&(48<=(r=s.charCodeAt(g))&&r<=57);g++);if(46==s.charCodeAt(g)){for(i=++g;i<a&&(48<=(r=s.charCodeAt(i))&&r<=57);i++);i==g&&v(),g=i}if(101==(r=s.charCodeAt(g))||69==r){for(43!=(r=s.charCodeAt(++g))&&45!=r||g++,i=g;i<a&&(48<=(r=s.charCodeAt(i))&&r<=57);i++);i==g&&v(),g=i}return+s.slice(e,g)}if(n&&v(),"true"==s.slice(g,g+4))return g+=4,!0;if("false"==s.slice(g,g+5))return g+=5,!1;if("null"==s.slice(g,g+4))return g+=4,null;v()}return"$"},a=function(t){var e,i;if("$"==t&&v(),"string"==typeof t){if("@"==(d?t.charAt(0):t[0]))return t.slice(1);if("["==t){for(e=[];"]"!=(t=s());i=i||!0)!i||","==t&&"]"!=(t=s())||v(),","==t&&v(),e.push(a(t));return e}if("{"==t){for(e={};"}"!=(t=s());i=i||!0)!i||","==t&&"}"!=(t=s())||v(),","!=t&&"string"==typeof t&&"@"==(d?t.charAt(0):t[0])&&":"==s()||v(),e[t.slice(1)]=a(s());return e}v()}return t},b=function(t,e,i){i=y(t,e,i);i===w?delete t[e]:t[e]=i},y=function(t,e,i){var n,r=t[e];if("object"==typeof r&&r)if(M.call(r)==R)for(n=r.length;n--;)b(r,n,i);else E(r,function(t){b(r,t,i)});return i.call(t,e,r)},o.parse=function(t,e){var i;return g=0,m=""+t,i=a(s()),"$"!=s()&&v(),g=m=null,e&&M.call(e)==c?y(((t={})[""]=i,t),"",e):i})),o.runInContext=B,o}!a||a.global!==a&&a.window!==a&&a.self!==a||(k=a),s&&!r?B(k,s):(t=k.JSON,e=k.JSON3,i=!1,n=B(k,k.JSON3={noConflict:function(){return i||(i=!0,k.JSON=t,k.JSON3=e,t=e=null),n}}),k.JSON={parse:n.parse,stringify:n.stringify}),r&&(void 0===(l=function(){return n}.call(u,c,u,o))||(o.exports=l))}.call(this),t={a:function(){return t.el("a")},svg:function(){return t.el("svg")},object:function(){return t.el("object")},image:function(){return t.el("image")},img:function(){return t.el("img")},style:function(){return t.el("style")},link:function(){return t.el("link")},script:function(){return t.el("script")},audio:function(){return t.el("audio")},video:function(){return t.el("video")},text:function(t){return document.createTextNode(t)},el:function(t){return document.createElement(t)}},R.Elements=t,a={ABSOLUTE_PATT:/^(?:\w+:)?\/{2}/i,RELATIVE_PATT:/^[./]*?\//i,EXTENSION_PATT:/\/?[^/]+\.(\w{1,5})$/i,parseURI:function(t){var e={absolute:!1,relative:!1,protocol:null,hostname:null,port:null,pathname:null,search:null,hash:null,host:null};if(null==t)return e;var i,n=R.Elements.a();for(i in n.href=t,e)i in n&&(e[i]=n[i]);var r=t.indexOf("?");return-1<r&&(t=t.substr(0,r)),a.ABSOLUTE_PATT.test(t)?e.absolute=!0:a.RELATIVE_PATT.test(t)&&(e.relative=!0),(t=t.match(a.EXTENSION_PATT))&&(e.extension=t[1].toLowerCase()),e},formatQueryString:function(t,e){if(null==t)throw new Error("You must specify data.");var i,n=[];for(i in t)n.push(i+"="+escape(t[i]));return(n=e?n.concat(e):n).join("&")},buildURI:function(t,e){if(null==e)return t;var i,n=[],r=t.indexOf("?");return-1!=r&&(i=t.slice(r+1),n=n.concat(i.split("&"))),-1!=r?t.slice(0,r)+"?"+this.formatQueryString(e,n):t+"?"+this.formatQueryString(e,n)},isCrossDomain:function(t){var e=R.Elements.a();e.href=t.src;t=R.Elements.a();return t.href=location.href,""!=e.hostname&&(e.port!=t.port||e.protocol!=t.protocol||e.hostname!=t.hostname)},isLocal:function(t){var e=R.Elements.a();return e.href=t.src,""==e.hostname&&"file:"==e.protocol}},R.URLUtils=a,i={container:null,appendToHead:function(t){i.getHead().appendChild(t)},appendToBody:function(t){var e;null==i.container&&(i.container=document.createElement("div"),i.container.id="preloadjs-container",(e=i.container.style).visibility="hidden",e.position="absolute",e.width=i.container.style.height="10px",e.overflow="hidden",e.transform=e.msTransform=e.webkitTransform=e.oTransform="translate(-10px, -10px)",i.getBody().appendChild(i.container)),i.container.appendChild(t)},getHead:function(){return document.head||document.getElementsByTagName("head")[0]},getBody:function(){return document.body||document.getElementsByTagName("body")[0]},removeChild:function(t){t.parent&&t.parent.removeChild(t)},isImageTag:function(t){return t instanceof HTMLImageElement},isAudioTag:function(t){return!!window.HTMLAudioElement&&t instanceof HTMLAudioElement},isVideoTag:function(t){return!!window.HTMLVideoElement&&t instanceof HTMLVideoElement}},R.DomUtils=i,e={parseXML:function(t){var e=null;try{window.DOMParser&&(e=(new DOMParser).parseFromString(t,"text/xml"))}catch(t){}if(!e)try{(e=new ActiveXObject("Microsoft.XMLDOM")).async=!1,e.loadXML(t)}catch(t){e=null}return e},parseJSON:function(t){if(null==t)return null;try{return JSON.parse(t)}catch(t){throw t}}},R.DataUtils=e,e={BINARY:"binary",CSS:"css",FONT:"font",FONTCSS:"fontcss",IMAGE:"image",JAVASCRIPT:"javascript",JSON:"json",JSONP:"jsonp",MANIFEST:"manifest",SOUND:"sound",VIDEO:"video",SPRITESHEET:"spritesheet",SVG:"svg",TEXT:"text",XML:"xml"},R.Types=e,e={POST:"POST",GET:"GET"},R.Methods=e,function(){"use strict";function i(){this.src=null,this.type=null,this.id=null,this.maintainOrder=!1,this.callback=null,this.data=null,this.method=R.Methods.GET,this.values=null,this.headers=null,this.withCredentials=!1,this.mimeType=null,this.crossOrigin=null,this.loadTimeout=n.LOAD_TIMEOUT_DEFAULT}var t=i.prototype={},n=i;n.LOAD_TIMEOUT_DEFAULT=8e3,n.create=function(t){if("string"==typeof t){var e=new i;return e.src=t,e}if(t instanceof n)return t;if(t instanceof Object&&t.src)return null==t.loadTimeout&&(t.loadTimeout=n.LOAD_TIMEOUT_DEFAULT),t;throw new Error("Type not recognized.")},t.set=function(t){for(var e in t)this[e]=t[e];return this},R.LoadItem=n}(),e={isBinary:function(t){switch(t){case R.Types.IMAGE:case R.Types.BINARY:return!0;default:return!1}},isText:function(t){switch(t){case R.Types.TEXT:case R.Types.JSON:case R.Types.MANIFEST:case R.Types.XML:case R.Types.CSS:case R.Types.SVG:case R.Types.JAVASCRIPT:case R.Types.SPRITESHEET:return!0;default:return!1}},getTypeByExtension:function(t){if(null==t)return R.Types.TEXT;switch(t.toLowerCase()){case"jpeg":case"jpg":case"gif":case"png":case"webp":case"bmp":return R.Types.IMAGE;case"ogg":case"mp3":case"webm":return R.Types.SOUND;case"mp4":case"webm":case"ts":return R.Types.VIDEO;case"json":return R.Types.JSON;case"xml":return R.Types.XML;case"css":return R.Types.CSS;case"js":return R.Types.JAVASCRIPT;case"svg":return R.Types.SVG;default:return R.Types.TEXT}}},R.RequestUtils=e,function(){"use strict";function t(t,e,i){this.EventDispatcher_constructor(),this.loaded=!1,this.canceled=!1,this.progress=0,this.type=i,this.resultFormatter=null,this._item=t?R.LoadItem.create(t):null,this._preferXHR=e,this._result=null,this._rawResult=null,this._loadedItems=null,this._tagSrcAttribute=null,this._tag=null}var e=R.extend(t,R.EventDispatcher),i=t;try{Object.defineProperties(i,{POST:{get:R.deprecate(function(){return R.Methods.POST},"AbstractLoader.POST")},GET:{get:R.deprecate(function(){return R.Methods.GET},"AbstractLoader.GET")},BINARY:{get:R.deprecate(function(){return R.Types.BINARY},"AbstractLoader.BINARY")},CSS:{get:R.deprecate(function(){return R.Types.CSS},"AbstractLoader.CSS")},FONT:{get:R.deprecate(function(){return R.Types.FONT},"AbstractLoader.FONT")},FONTCSS:{get:R.deprecate(function(){return R.Types.FONTCSS},"AbstractLoader.FONTCSS")},IMAGE:{get:R.deprecate(function(){return R.Types.IMAGE},"AbstractLoader.IMAGE")},JAVASCRIPT:{get:R.deprecate(function(){return R.Types.JAVASCRIPT},"AbstractLoader.JAVASCRIPT")},JSON:{get:R.deprecate(function(){return R.Types.JSON},"AbstractLoader.JSON")},JSONP:{get:R.deprecate(function(){return R.Types.JSONP},"AbstractLoader.JSONP")},MANIFEST:{get:R.deprecate(function(){return R.Types.MANIFEST},"AbstractLoader.MANIFEST")},SOUND:{get:R.deprecate(function(){return R.Types.SOUND},"AbstractLoader.SOUND")},VIDEO:{get:R.deprecate(function(){return R.Types.VIDEO},"AbstractLoader.VIDEO")},SPRITESHEET:{get:R.deprecate(function(){return R.Types.SPRITESHEET},"AbstractLoader.SPRITESHEET")},SVG:{get:R.deprecate(function(){return R.Types.SVG},"AbstractLoader.SVG")},TEXT:{get:R.deprecate(function(){return R.Types.TEXT},"AbstractLoader.TEXT")},XML:{get:R.deprecate(function(){return R.Types.XML},"AbstractLoader.XML")}})}catch(t){}e.getItem=function(){return this._item},e.getResult=function(t){return t?this._rawResult:this._result},e.getTag=function(){return this._tag},e.setTag=function(t){this._tag=t},e.load=function(){this._createRequest(),this._request.on("complete",this,this),this._request.on("progress",this,this),this._request.on("loadStart",this,this),this._request.on("abort",this,this),this._request.on("timeout",this,this),this._request.on("error",this,this);var t=new R.Event("initialize");t.loader=this._request,this.dispatchEvent(t),this._request.load()},e.cancel=function(){this.canceled=!0,this.destroy()},e.destroy=function(){this._request&&(this._request.removeAllEventListeners(),this._request.destroy()),this._request=null,this._item=null,this._rawResult=null,this._result=null,this._loadItems=null,this.removeAllEventListeners()},e.getLoadedItems=function(){return this._loadedItems},e._createRequest=function(){this._preferXHR?this._request=new R.XHRRequest(this._item):this._request=new R.TagRequest(this._item,this._tag||this._createTag(),this._tagSrcAttribute)},e._createTag=function(t){return null},e._sendLoadStart=function(){this._isCanceled()||this.dispatchEvent("loadstart")},e._sendProgress=function(t){var e;this._isCanceled()||(e=null,"number"==typeof t?(this.progress=t,e=new R.ProgressEvent(this.progress)):(this.progress=(e=t).loaded/t.total,e.progress=this.progress,!isNaN(this.progress)&&this.progress!=1/0||(this.progress=0)),this.hasEventListener("progress")&&this.dispatchEvent(e))},e._sendComplete=function(){var t;this._isCanceled()||(this.loaded=!0,(t=new R.Event("complete")).rawResult=this._rawResult,null!=this._result&&(t.result=this._result),this.dispatchEvent(t))},e._sendError=function(t){!this._isCanceled()&&this.hasEventListener("error")&&(null==t&&(t=new R.ErrorEvent("PRELOAD_ERROR_EMPTY")),this.dispatchEvent(t))},e._isCanceled=function(){return!(null!=window.createjs&&!this.canceled)},e.resultFormatter=null,e.handleEvent=function(t){switch(t.type){case"complete":this._rawResult=t.target._response;var e=this.resultFormatter&&this.resultFormatter(this);e instanceof Function?e.call(this,R.proxy(this._resultFormatSuccess,this),R.proxy(this._resultFormatFailed,this)):(this._result=e||this._rawResult,this._sendComplete());break;case"progress":this._sendProgress(t);break;case"error":this._sendError(t);break;case"loadstart":this._sendLoadStart();break;case"abort":case"timeout":this._isCanceled()||this.dispatchEvent(new R.ErrorEvent("PRELOAD_"+t.type.toUpperCase()+"_ERROR"))}},e._resultFormatSuccess=function(t){this._result=t,this._sendComplete()},e._resultFormatFailed=function(t){this._sendError(t)},e.toString=function(){return"[PreloadJS AbstractLoader]"},R.AbstractLoader=R.promote(t,"EventDispatcher")}(),function(){"use strict";function t(t,e,i){this.AbstractLoader_constructor(t,e,i),this.resultFormatter=this._formatResult,this._tagSrcAttribute="src",this.on("initialize",this._updateXHR,this)}var e=R.extend(t,R.AbstractLoader);e.load=function(){this._tag||(this._tag=this._createTag(this._item.src)),this._tag.preload="auto",this._tag.load(),this.AbstractLoader_load()},e._createTag=function(){},e._createRequest=function(){this._preferXHR?this._request=new R.XHRRequest(this._item):this._request=new R.MediaTagRequest(this._item,this._tag||this._createTag(),this._tagSrcAttribute)},e._updateXHR=function(t){t.loader.setResponseType&&t.loader.setResponseType("blob")},e._formatResult=function(t){var e,i;return this._tag.removeEventListener&&this._tag.removeEventListener("canplaythrough",this._loadedHandler),this._tag.onstalled=null,this._preferXHR&&(e=window.URL||window.webkitURL,i=t.getResult(!0),t.getTag().src=e.createObjectURL(i)),t.getTag()},R.AbstractMediaLoader=R.promote(t,"AbstractLoader")}(),function(){"use strict";function t(t){this._item=t}var e=R.extend(t,R.EventDispatcher);e.load=function(){},e.destroy=function(){},e.cancel=function(){},R.AbstractRequest=R.promote(t,"EventDispatcher")}(),function(){"use strict";function t(t,e,i){this.AbstractRequest_constructor(t),this._tag=e,this._tagSrcAttribute=i,this._loadedHandler=R.proxy(this._handleTagComplete,this),this._addedToDOM=!1}var e=R.extend(t,R.AbstractRequest);e.load=function(){this._tag.onload=R.proxy(this._handleTagComplete,this),this._tag.onreadystatechange=R.proxy(this._handleReadyStateChange,this),this._tag.onerror=R.proxy(this._handleError,this);var t=new R.Event("initialize");t.loader=this._tag,this.dispatchEvent(t),this._loadTimeout=setTimeout(R.proxy(this._handleTimeout,this),this._item.loadTimeout),this._tag[this._tagSrcAttribute]=this._item.src,null==this._tag.parentNode&&(R.DomUtils.appendToBody(this._tag),this._addedToDOM=!0)},e.destroy=function(){this._clean(),this._tag=null,this.AbstractRequest_destroy()},e._handleReadyStateChange=function(){clearTimeout(this._loadTimeout);var t=this._tag;"loaded"!=t.readyState&&"complete"!=t.readyState||this._handleTagComplete()},e._handleError=function(){this._clean(),this.dispatchEvent("error")},e._handleTagComplete=function(){this._rawResult=this._tag,this._result=this.resultFormatter&&this.resultFormatter(this)||this._rawResult,this._clean(),this.dispatchEvent("complete")},e._handleTimeout=function(){this._clean(),this.dispatchEvent(new R.Event("timeout"))},e._clean=function(){this._tag.onload=null,this._tag.onreadystatechange=null,this._tag.onerror=null,this._addedToDOM&&null!=this._tag.parentNode&&this._tag.parentNode.removeChild(this._tag),clearTimeout(this._loadTimeout)},e._handleStalled=function(){},R.TagRequest=R.promote(t,"AbstractRequest")}(),function(){"use strict";function t(t,e,i){this.AbstractRequest_constructor(t),this._tag=e,this._tagSrcAttribute=i,this._loadedHandler=R.proxy(this._handleTagComplete,this)}var e=R.extend(t,R.TagRequest);e.load=function(){var t=R.proxy(this._handleStalled,this);this._stalledCallback=t;var e=R.proxy(this._handleProgress,this);this._handleProgress=e,this._tag.addEventListener("stalled",t),this._tag.addEventListener("progress",e),this._tag.addEventListener&&this._tag.addEventListener("canplaythrough",this._loadedHandler,!1),this.TagRequest_load()},e._handleReadyStateChange=function(){clearTimeout(this._loadTimeout);var t=this._tag;"loaded"!=t.readyState&&"complete"!=t.readyState||this._handleTagComplete()},e._handleStalled=function(){},e._handleProgress=function(t){!t||0<t.loaded&&0==t.total||(t=new R.ProgressEvent(t.loaded,t.total),this.dispatchEvent(t))},e._clean=function(){this._tag.removeEventListener&&this._tag.removeEventListener("canplaythrough",this._loadedHandler),this._tag.removeEventListener("stalled",this._stalledCallback),this._tag.removeEventListener("progress",this._progressCallback),this.TagRequest__clean()},R.MediaTagRequest=R.promote(t,"TagRequest")}(),function(){"use strict";function t(t){this.AbstractRequest_constructor(t),this._request=null,this._loadTimeout=null,this._xhrLevel=1,this._response=null,this._rawResponse=null,this._canceled=!1,this._handleLoadStartProxy=R.proxy(this._handleLoadStart,this),this._handleProgressProxy=R.proxy(this._handleProgress,this),this._handleAbortProxy=R.proxy(this._handleAbort,this),this._handleErrorProxy=R.proxy(this._handleError,this),this._handleTimeoutProxy=R.proxy(this._handleTimeout,this),this._handleLoadProxy=R.proxy(this._handleLoad,this),this._handleReadyStateChangeProxy=R.proxy(this._handleReadyStateChange,this),this._createXHR(t)}var e=R.extend(t,R.AbstractRequest);t.ACTIVEX_VERSIONS=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.5.0","Msxml2.XMLHTTP.4.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],e.getResult=function(t){return t&&this._rawResponse?this._rawResponse:this._response},e.cancel=function(){this.canceled=!0,this._clean(),this._request.abort()},e.load=function(){if(null!=this._request){null!=this._request.addEventListener?(this._request.addEventListener("loadstart",this._handleLoadStartProxy,!1),this._request.addEventListener("progress",this._handleProgressProxy,!1),this._request.addEventListener("abort",this._handleAbortProxy,!1),this._request.addEventListener("error",this._handleErrorProxy,!1),this._request.addEventListener("timeout",this._handleTimeoutProxy,!1),this._request.addEventListener("load",this._handleLoadProxy,!1),this._request.addEventListener("readystatechange",this._handleReadyStateChangeProxy,!1)):(this._request.onloadstart=this._handleLoadStartProxy,this._request.onprogress=this._handleProgressProxy,this._request.onabort=this._handleAbortProxy,this._request.onerror=this._handleErrorProxy,this._request.ontimeout=this._handleTimeoutProxy,this._request.onload=this._handleLoadProxy,this._request.onreadystatechange=this._handleReadyStateChangeProxy),1==this._xhrLevel&&(this._loadTimeout=setTimeout(R.proxy(this._handleTimeout,this),this._item.loadTimeout));try{this._item.values?this._request.send(R.URLUtils.formatQueryString(this._item.values)):this._request.send()}catch(t){this.dispatchEvent(new R.ErrorEvent("XHR_SEND",null,t))}}else this._handleError()},e.setResponseType=function(t){"blob"===t&&(t=window.URL?"blob":"arraybuffer",this._responseType=t),this._request.responseType=t},e.getAllResponseHeaders=function(){return this._request.getAllResponseHeaders instanceof Function?this._request.getAllResponseHeaders():null},e.getResponseHeader=function(t){return this._request.getResponseHeader instanceof Function?this._request.getResponseHeader(t):null},e._handleProgress=function(t){!t||0<t.loaded&&0==t.total||(t=new R.ProgressEvent(t.loaded,t.total),this.dispatchEvent(t))},e._handleLoadStart=function(t){clearTimeout(this._loadTimeout),this.dispatchEvent("loadstart")},e._handleAbort=function(t){this._clean(),this.dispatchEvent(new R.ErrorEvent("XHR_ABORTED",null,t))},e._handleError=function(t){this._clean(),this.dispatchEvent(new R.ErrorEvent(t.message))},e._handleReadyStateChange=function(t){4==this._request.readyState&&this._handleLoad()},e._handleLoad=function(t){if(!this.loaded){this.loaded=!0;var e=this._checkError();if(e)this._handleError(e);else{if(this._response=this._getResponse(),"arraybuffer"===this._responseType)try{this._response=new Blob([this._response])}catch(t){window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,"TypeError"===t.name&&window.BlobBuilder&&((e=new BlobBuilder).append(this._response),this._response=e.getBlob())}this._clean(),this.dispatchEvent(new R.Event("complete"))}}},e._handleTimeout=function(t){this._clean(),this.dispatchEvent(new R.ErrorEvent("PRELOAD_TIMEOUT",null,t))},e._checkError=function(){var t=parseInt(this._request.status);return 400<=t&&t<=599?new Error(t):0==t&&/^https?:/.test(location.protocol)?new Error(0):null},e._getResponse=function(){if(null!=this._response)return this._response;if(null!=this._request.response)return this._request.response;try{if(null!=this._request.responseText)return this._request.responseText}catch(t){}try{if(null!=this._request.responseXML)return this._request.responseXML}catch(t){}return null},e._createXHR=function(t){var e=R.URLUtils.isCrossDomain(t),i={},n=null;if(window.XMLHttpRequest)n=new XMLHttpRequest,e&&void 0===n.withCredentials&&window.XDomainRequest&&(n=new XDomainRequest);else{for(var r=0,a=s.ACTIVEX_VERSIONS.length;r<a;r++){var o=s.ACTIVEX_VERSIONS[r];try{n=new ActiveXObject(o);break}catch(t){}}if(null==n)return!1}null==t.mimeType&&R.RequestUtils.isText(t.type)&&(t.mimeType="text/plain; charset=utf-8"),t.mimeType&&n.overrideMimeType&&n.overrideMimeType(t.mimeType),this._xhrLevel="string"==typeof n.responseType?2:1;var h=null,h=t.method==R.Methods.GET?R.URLUtils.buildURI(t.src,t.values):t.src;if(n.open(t.method||R.Methods.GET,h,!0),e&&n instanceof XMLHttpRequest&&1==this._xhrLevel&&(i.Origin=location.origin),t.values&&t.method==R.Methods.POST&&(i["Content-Type"]="application/x-www-form-urlencoded"),e||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest"),t.headers)for(var l in t.headers)i[l]=t.headers[l];for(l in i)n.setRequestHeader(l,i[l]);return n instanceof XMLHttpRequest&&void 0!==t.withCredentials&&(n.withCredentials=t.withCredentials),this._request=n,!0},e._clean=function(){clearTimeout(this._loadTimeout),null!=this._request.removeEventListener?(this._request.removeEventListener("loadstart",this._handleLoadStartProxy),this._request.removeEventListener("progress",this._handleProgressProxy),this._request.removeEventListener("abort",this._handleAbortProxy),this._request.removeEventListener("error",this._handleErrorProxy),this._request.removeEventListener("timeout",this._handleTimeoutProxy),this._request.removeEventListener("load",this._handleLoadProxy),this._request.removeEventListener("readystatechange",this._handleReadyStateChangeProxy)):(this._request.onloadstart=null,this._request.onprogress=null,this._request.onabort=null,this._request.onerror=null,this._request.ontimeout=null,this._request.onload=null,this._request.onreadystatechange=null)},e.toString=function(){return"[PreloadJS XHRRequest]"},R.XHRRequest=R.promote(t,"AbstractRequest")}(),function(){"use strict";function t(t,e,i){this.AbstractLoader_constructor(),this._plugins=[],this._typeCallbacks={},this._extensionCallbacks={},this.next=null,this.maintainScriptOrder=!0,this.stopOnError=!1,this._maxConnections=1,this._availableLoaders=[R.FontLoader,R.ImageLoader,R.JavaScriptLoader,R.CSSLoader,R.JSONLoader,R.JSONPLoader,R.SoundLoader,R.ManifestLoader,R.SpriteSheetLoader,R.XMLLoader,R.SVGLoader,R.BinaryLoader,R.VideoLoader,R.TextLoader],this._defaultLoaderLength=this._availableLoaders.length,this.init(t,e,i)}var e=R.extend(t,R.AbstractLoader),h=t;try{Object.defineProperties(h,{POST:{get:R.deprecate(function(){return R.Methods.POST},"AbstractLoader.POST")},GET:{get:R.deprecate(function(){return R.Methods.GET},"AbstractLoader.GET")},BINARY:{get:R.deprecate(function(){return R.Types.BINARY},"AbstractLoader.BINARY")},CSS:{get:R.deprecate(function(){return R.Types.CSS},"AbstractLoader.CSS")},FONT:{get:R.deprecate(function(){return R.Types.FONT},"AbstractLoader.FONT")},FONTCSS:{get:R.deprecate(function(){return R.Types.FONTCSS},"AbstractLoader.FONTCSS")},IMAGE:{get:R.deprecate(function(){return R.Types.IMAGE},"AbstractLoader.IMAGE")},JAVASCRIPT:{get:R.deprecate(function(){return R.Types.JAVASCRIPT},"AbstractLoader.JAVASCRIPT")},JSON:{get:R.deprecate(function(){return R.Types.JSON},"AbstractLoader.JSON")},JSONP:{get:R.deprecate(function(){return R.Types.JSONP},"AbstractLoader.JSONP")},MANIFEST:{get:R.deprecate(function(){return R.Types.MANIFEST},"AbstractLoader.MANIFEST")},SOUND:{get:R.deprecate(function(){return R.Types.SOUND},"AbstractLoader.SOUND")},VIDEO:{get:R.deprecate(function(){return R.Types.VIDEO},"AbstractLoader.VIDEO")},SPRITESHEET:{get:R.deprecate(function(){return R.Types.SPRITESHEET},"AbstractLoader.SPRITESHEET")},SVG:{get:R.deprecate(function(){return R.Types.SVG},"AbstractLoader.SVG")},TEXT:{get:R.deprecate(function(){return R.Types.TEXT},"AbstractLoader.TEXT")},XML:{get:R.deprecate(function(){return R.Types.XML},"AbstractLoader.XML")}})}catch(t){}e.init=function(t,e,i){this.preferXHR=!0,this._preferXHR=!0,this.setPreferXHR(t),this._paused=!1,this._basePath=e,this._crossOrigin=i,this._loadStartWasDispatched=!1,this._currentlyLoadingScript=null,this._currentLoads=[],this._loadQueue=[],this._loadQueueBackup=[],this._loadItemsById={},this._loadItemsBySrc={},this._loadedResults={},this._loadedRawResults={},this._numItems=0,this._numItemsLoaded=0,this._scriptOrder=[],this._loadedScripts=[],this._lastProgress=NaN},e.registerLoader=function(t){if(!t||!t.canLoadItem)throw new Error("loader is of an incorrect type.");if(-1!=this._availableLoaders.indexOf(t))throw new Error("loader already exists.");this._availableLoaders.unshift(t)},e.unregisterLoader=function(t){t=this._availableLoaders.indexOf(t);-1!=t&&t<this._defaultLoaderLength-1&&this._availableLoaders.splice(t,1)},e.setPreferXHR=function(t){return this.preferXHR=0!=t&&null!=window.XMLHttpRequest,this.preferXHR},e.removeAll=function(){this.remove()},e.remove=function(t){var e=null;if(t&&!Array.isArray(t))e=[t];else if(t)e=t;else if(0<arguments.length)return;var i=!1;if(e){for(;e.length;){for(var n=e.pop(),r=this.getResult(n),s=this._loadQueue.length-1;0<=s;s--)if((a=this._loadQueue[s].getItem()).id==n||a.src==n){this._loadQueue.splice(s,1)[0].cancel();break}for(s=this._loadQueueBackup.length-1;0<=s;s--)if((a=this._loadQueueBackup[s].getItem()).id==n||a.src==n){this._loadQueueBackup.splice(s,1)[0].cancel();break}if(r)this._disposeItem(this.getItem(n));else for(var s=this._currentLoads.length-1;0<=s;s--){var a=this._currentLoads[s].getItem();if(a.id==n||a.src==n){this._currentLoads.splice(s,1)[0].cancel(),i=!0;break}}}i&&this._loadNext()}else{for(var o in this.close(),this._loadItemsById)this._disposeItem(this._loadItemsById[o]);this.init(this.preferXHR,this._basePath)}},e.reset=function(){for(var t in this.close(),this._loadItemsById)this._disposeItem(this._loadItemsById[t]);for(var e=[],i=0,n=this._loadQueueBackup.length;i<n;i++)e.push(this._loadQueueBackup[i].getItem());this.loadManifest(e,!1)},e.installPlugin=function(t){if(null!=t&&null!=t.getPreloadHandlers){this._plugins.push(t);var e=t.getPreloadHandlers();if(e.scope=t,null!=e.types)for(var i=0,n=e.types.length;i<n;i++)this._typeCallbacks[e.types[i]]=e;if(null!=e.extensions)for(i=0,n=e.extensions.length;i<n;i++)this._extensionCallbacks[e.extensions[i]]=e}},e.setMaxConnections=function(t){this._maxConnections=t,!this._paused&&0<this._loadQueue.length&&this._loadNext()},e.loadFile=function(t,e,i){null!=t?(this._addItem(t,null,i),!1!==e?this.setPaused(!1):this.setPaused(!0)):(e=new R.ErrorEvent("PRELOAD_NO_FILE"),this._sendError(e))},e.loadManifest=function(t,e,i){var n=null,r=null;if(Array.isArray(t)){if(0==t.length){var s=new R.ErrorEvent("PRELOAD_MANIFEST_EMPTY");return void this._sendError(s)}n=t}else if("string"==typeof t)n=[{src:t,type:h.MANIFEST}];else{if("object"!=typeof t){s=new R.ErrorEvent("PRELOAD_MANIFEST_NULL");return void this._sendError(s)}void 0!==t.src?(null==t.type?t.type=h.MANIFEST:t.type!=h.MANIFEST&&(s=new R.ErrorEvent("PRELOAD_MANIFEST_TYPE"),this._sendError(s)),n=[t]):void 0!==t.manifest&&(n=t.manifest,r=t.path)}for(var a=0,o=n.length;a<o;a++)this._addItem(n[a],r,i);!1!==e?this.setPaused(!1):this.setPaused(!0)},e.load=function(){this.setPaused(!1)},e.getItem=function(t){return this._loadItemsById[t]||this._loadItemsBySrc[t]},e.getResult=function(t,e){t=this._loadItemsById[t]||this._loadItemsBySrc[t];if(null==t)return null;t=t.id;return(e&&this._loadedRawResults[t]?this._loadedRawResults:this._loadedResults)[t]},e.getItems=function(t){var e,i=[];for(e in this._loadItemsById){var n=this._loadItemsById[e],r=this.getResult(e);!0===t&&null==r||i.push({item:n,result:r,rawResult:this.getResult(e,!0)})}return i},e.setPaused=function(t){this._paused=t,this._paused||this._loadNext()},e.close=function(){for(;this._currentLoads.length;)this._currentLoads.pop().cancel();this._scriptOrder.length=0,this._loadedScripts.length=0,this.loadStartWasDispatched=!1,this._itemCount=0,this._lastProgress=NaN},e._addItem=function(t,e,i){e=this._createLoadItem(t,e,i);null==e||null!=(i=this._createLoader(e))&&("plugins"in i&&(i.plugins=this._plugins),e._loader=i,this._loadQueue.push(i),this._loadQueueBackup.push(i),this._numItems++,this._updateProgress(),(this.maintainScriptOrder&&e.type==R.Types.JAVASCRIPT||!0===e.maintainOrder)&&(this._scriptOrder.push(e),this._loadedScripts.push(null)))},e._createLoadItem=function(t,e,i){var n=R.LoadItem.create(t);if(null==n)return null;t="",i=i||this._basePath;if(n.src instanceof Object){if(!n.type)return null;e?(s=R.URLUtils.parseURI(t=e),null==i||s.absolute||s.relative||(t=i+t)):null!=i&&(t=i)}else{var r=R.URLUtils.parseURI(n.src);r.extension&&(n.ext=r.extension),null==n.type&&(n.type=R.RequestUtils.getTypeByExtension(n.ext));var s,a=n.src;r.absolute||r.relative||(e?(s=R.URLUtils.parseURI(t=e),a=e+a,null==i||s.absolute||s.relative||(t=i+t)):null!=i&&(t=i)),n.src=t+n.src}n.path=t,void 0!==n.id&&null!==n.id&&""!==n.id||(n.id=a);a=this._typeCallbacks[n.type]||this._extensionCallbacks[n.ext];if(a){a=a.callback.call(a.scope,n,this);if(!1===a)return null;!0===a||null!=a&&(n._loader=a),null!=(r=R.URLUtils.parseURI(n.src)).extension&&(n.ext=r.extension)}return this._loadItemsById[n.id]=n,null==(this._loadItemsBySrc[n.src]=n).crossOrigin&&(n.crossOrigin=this._crossOrigin),n},e._createLoader=function(t){if(null!=t._loader)return t._loader;for(var e=this.preferXHR,i=0;i<this._availableLoaders.length;i++){var n=this._availableLoaders[i];if(n&&n.canLoadItem(t))return new n(t,e)}return null},e._loadNext=function(){if(!this._paused){this._loadStartWasDispatched||(this._sendLoadStart(),this._loadStartWasDispatched=!0),this._numItems==this._numItemsLoaded?(this.loaded=!0,this._sendComplete(),this.next&&this.next.load&&this.next.load()):this.loaded=!1;for(var t=0;t<this._loadQueue.length&&!(this._currentLoads.length>=this._maxConnections);t++){var e=this._loadQueue[t];this._canStartLoad(e)&&(this._loadQueue.splice(t,1),t--,this._loadItem(e))}}},e._loadItem=function(t){t.on("fileload",this._handleFileLoad,this),t.on("progress",this._handleProgress,this),t.on("complete",this._handleFileComplete,this),t.on("error",this._handleError,this),t.on("fileerror",this._handleFileError,this),this._currentLoads.push(t),this._sendFileStart(t.getItem()),t.load()},e._handleFileLoad=function(t){t.target=null,this.dispatchEvent(t)},e._handleFileError=function(t){t=new R.ErrorEvent("FILE_LOAD_ERROR",null,t.item);this._sendError(t)},e._handleError=function(t){var e=t.target;this._numItemsLoaded++,this._finishOrderedItem(e,!0),this._updateProgress();t=new R.ErrorEvent("FILE_LOAD_ERROR",null,e.getItem());this._sendError(t),this.stopOnError?this.setPaused(!0):(this._removeLoadItem(e),this._cleanLoadItem(e),this._loadNext())},e._handleFileComplete=function(t){var e=t.target,i=e.getItem(),n=e.getResult();this._loadedResults[i.id]=n;t=e.getResult(!0);null!=t&&t!==n&&(this._loadedRawResults[i.id]=t),this._saveLoadedItems(e),this._removeLoadItem(e),this._finishOrderedItem(e)||this._processFinishedLoad(i,e),this._cleanLoadItem(e)},e._saveLoadedItems=function(t){var e=t.getLoadedItems();if(null!==e)for(var i=0;i<e.length;i++){var n=e[i].item;this._loadItemsBySrc[n.src]=n,this._loadItemsById[n.id]=n,this._loadedResults[n.id]=e[i].result,this._loadedRawResults[n.id]=e[i].rawResult}},e._finishOrderedItem=function(t,e){var i=t.getItem();if(this.maintainScriptOrder&&i.type==R.Types.JAVASCRIPT||i.maintainOrder){t instanceof R.JavaScriptLoader&&(this._currentlyLoadingScript=!1);t=R.indexOf(this._scriptOrder,i);return-1==t?!1:(this._loadedScripts[t]=!0===e||i,this._checkScriptLoadOrder(),!0)}return!1},e._checkScriptLoadOrder=function(){for(var t=this._loadedScripts.length,e=0;e<t;e++){var i,n=this._loadedScripts[e];if(null===n)break;!0!==n&&(i=this._loadedResults[n.id],n.type==R.Types.JAVASCRIPT&&R.DomUtils.appendToHead(i),i=n._loader,this._processFinishedLoad(n,i),this._loadedScripts[e]=!0)}},e._processFinishedLoad=function(t,e){var i;this._numItemsLoaded++,this.maintainScriptOrder||t.type!=R.Types.JAVASCRIPT||(i=e.getTag(),R.DomUtils.appendToHead(i)),this._updateProgress(),this._sendFileComplete(t,e),this._loadNext()},e._canStartLoad=function(t){if(!this.maintainScriptOrder||t.preferXHR)return!0;t=t.getItem();if(t.type!=R.Types.JAVASCRIPT)return!0;if(this._currentlyLoadingScript)return!1;for(var e=this._scriptOrder.indexOf(t),i=0;i<e;){if(null==this._loadedScripts[i])return!1;i++}return this._currentlyLoadingScript=!0},e._removeLoadItem=function(t){for(var e=this._currentLoads.length,i=0;i<e;i++)if(this._currentLoads[i]==t){this._currentLoads.splice(i,1);break}},e._cleanLoadItem=function(t){t=t.getItem();t&&delete t._loader},e._handleProgress=function(t){t=t.target;this._sendFileProgress(t.getItem(),t.progress),this._updateProgress()},e._updateProgress=function(){var t=this._numItemsLoaded/this._numItems,e=this._numItems-this._numItemsLoaded;if(0<e){for(var i=0,n=0,r=this._currentLoads.length;n<r;n++)i+=this._currentLoads[n].progress;t+=i/e*(e/this._numItems)}this._lastProgress!=t&&(this._sendProgress(t),this._lastProgress=t)},e._disposeItem=function(t){delete this._loadedResults[t.id],delete this._loadedRawResults[t.id],delete this._loadItemsById[t.id],delete this._loadItemsBySrc[t.src]},e._sendFileProgress=function(t,e){var i;this._isCanceled()||this._paused||this.hasEventListener("fileprogress")&&((i=new R.Event("fileprogress")).progress=e,i.loaded=e,i.total=1,i.item=t,this.dispatchEvent(i))},e._sendFileComplete=function(t,e){var i;this._isCanceled()||this._paused||((i=new R.Event("fileload")).loader=e,i.item=t,i.result=this._loadedResults[t.id],i.rawResult=this._loadedRawResults[t.id],t.completeHandler&&t.completeHandler(i),this.hasEventListener("fileload")&&this.dispatchEvent(i))},e._sendFileStart=function(t){var e=new R.Event("filestart");e.item=t,this.hasEventListener("filestart")&&this.dispatchEvent(e)},e.toString=function(){return"[PreloadJS LoadQueue]"},R.LoadQueue=R.promote(t,"AbstractLoader")}(),function(){"use strict";function t(t){this.AbstractLoader_constructor(t,!0,R.Types.TEXT)}R.extend(t,R.AbstractLoader);t.canLoadItem=function(t){return t.type==R.Types.TEXT},R.TextLoader=R.promote(t,"AbstractLoader")}(),function(){"use strict";function t(t){this.AbstractLoader_constructor(t,!0,R.Types.BINARY),this.on("initialize",this._updateXHR,this)}var e=R.extend(t,R.AbstractLoader);t.canLoadItem=function(t){return t.type==R.Types.BINARY},e._updateXHR=function(t){t.loader.setResponseType("arraybuffer")},R.BinaryLoader=R.promote(t,"AbstractLoader")}(),function(){"use strict";function t(t,e){this.AbstractLoader_constructor(t,e,R.Types.CSS),this.resultFormatter=this._formatResult,this._tagSrcAttribute="href",this._tag=e?R.Elements.style():R.Elements.link(),this._tag.rel="stylesheet",this._tag.type="text/css"}var e=R.extend(t,R.AbstractLoader);t.canLoadItem=function(t){return t.type==R.Types.CSS},e._formatResult=function(t){var e;return this._preferXHR?(e=t.getTag()).styleSheet?e.styleSheet.cssText=t.getResult(!0):(t=R.Elements.text(t.getResult(!0)),e.appendChild(t)):e=this._tag,R.DomUtils.appendToHead(e),e},R.CSSLoader=R.promote(t,"AbstractLoader")}(),function(){"use strict";function h(t,e){this.AbstractLoader_constructor(t,e,t.type),this._faces={},this._watched=[],this._count=0,this._watchInterval=null,this._loadTimeout=null,this._injectCSS=void 0===t.injectCSS||t.injectCSS,this.dispatchEvent("initialize")}var t=R.extend(h,R.AbstractLoader);h.canLoadItem=function(t){return t.type==R.Types.FONT||t.type==R.Types.FONTCSS},h.sampleText="abcdefghijklmnopqrstuvwxyz ABCDEFGHIJKLMNOPQRSTUVWXYZ",h._ctx=document.createElement("canvas").getContext("2d"),h._referenceFonts=["serif","monospace"],h.WEIGHT_REGEX=/[- ._]*(thin|normal|book|regular|medium|black|heavy|[1-9]00|(?:extra|ultra|semi|demi)?[- ._]*(?:light|bold))[- ._]*/gi,h.STYLE_REGEX=/[- ._]*(italic|oblique)[- ._]*/gi,h.FONT_FORMAT={woff2:"woff2",woff:"woff",ttf:"truetype",otf:"truetype"},h.FONT_WEIGHT={thin:100,extralight:200,ultralight:200,light:300,semilight:300,demilight:300,book:"normal",regular:"normal",semibold:600,demibold:600,extrabold:800,ultrabold:800,black:900,heavy:900},h.WATCH_DURATION=10,t.load=function(){var t;if(this.type==R.Types.FONTCSS){if(!this._watchCSS())return void this.AbstractLoader_load()}else this._item.src instanceof Array?this._watchFontArray():(t=this._defFromSrc(this._item.src),this._watchFont(t),this._injectStyleTag(this._cssFromDef(t)));this._loadTimeout=setTimeout(R.proxy(this._handleTimeout,this),this._item.loadTimeout),this.dispatchEvent("loadstart")},t._handleTimeout=function(){this._stopWatching(),this.dispatchEvent(new R.ErrorEvent("PRELOAD_TIMEOUT"))},t._createRequest=function(){return this._request},t.handleEvent=function(t){switch(t.type){case"complete":this._rawResult=t.target._response,this._result=!0,this._parseCSS(this._rawResult);break;case"error":this._stopWatching(),this.AbstractLoader_handleEvent(t)}},t._watchCSS=function(){var t=this._item.src;return t instanceof HTMLStyleElement&&(this._injectCSS&&!t.parentNode&&(document.head||document.getElementsByTagName("head")[0]).appendChild(t),this._injectCSS=!1,t="\n"+t.textContent),-1!==t.search(/\n|\r|@font-face/i)?(this._parseCSS(t),!0):(this._request=new R.XHRRequest(this._item),!1)},t._parseCSS=function(t){for(var e=/@font-face\s*\{([^}]+)}/g;;){var i=e.exec(t);if(!i)break;this._watchFont(this._parseFontFace(i[1]))}this._injectStyleTag(t)},t._watchFontArray=function(){for(var t=this._item.src,e="",i=t.length-1;0<=i;i--){var n=t[i],n="string"==typeof n?this._defFromSrc(n):this._defFromObj(n);this._watchFont(n),e+=this._cssFromDef(n)+"\n"}this._injectStyleTag(e)},t._injectStyleTag=function(t){var e,i;this._injectCSS&&(e=document.head||document.getElementsByTagName("head")[0],(i=document.createElement("style")).type="text/css",i.styleSheet?i.styleSheet.cssText=t:i.appendChild(document.createTextNode(t)),e.appendChild(i))},t._parseFontFace=function(t){var e=this._getCSSValue(t,"font-family"),i=this._getCSSValue(t,"src");return e&&i?this._defFromObj({family:e,src:i,style:this._getCSSValue(t,"font-style"),weight:this._getCSSValue(t,"font-weight")}):null},t._watchFont=function(t){t&&!this._faces[t.id]&&(this._faces[t.id]=t,this._watched.push(t),this._count++,this._calculateReferenceSizes(t),this._startWatching())},t._startWatching=function(){null==this._watchInterval&&(this._watchInterval=setInterval(R.proxy(this._watch,this),h.WATCH_DURATION))},t._stopWatching=function(){clearInterval(this._watchInterval),clearTimeout(this._loadTimeout),this._watchInterval=null},t._watch=function(){for(var t=this._watched,e=h._referenceFonts,i=t.length,n=i-1;0<=n;n--)for(var r=t[n],s=r.refs,a=s.length-1;0<=a;a--)if(this._getTextWidth(r.family+","+e[a],r.weight,r.style)!=s[a]){var o=new R.Event("fileload");r.type="font-family",o.item=r,this.dispatchEvent(o),t.splice(n,1);break}i!==t.length&&(o=new R.ProgressEvent(this._count-t.length,this._count),this.dispatchEvent(o)),0===i&&(this._stopWatching(),this._sendComplete())},t._calculateReferenceSizes=function(t){for(var e=h._referenceFonts,i=t.refs=[],n=0;n<e.length;n++)i[n]=this._getTextWidth(e[n],t.weight,t.style)},t._defFromSrc=function(t){var e=/[- ._]+/g,i=t,n=null,r=i.search(/[?#]/);-1!==(r=(i=-1!==r?i.substr(0,r):i).lastIndexOf("."))&&(n=i.substr(r+1),i=i.substr(0,r));var s=(a=i=-1!==(r=i.lastIndexOf("/"))?i.substr(r+1):i).match(h.WEIGHT_REGEX);s&&(s=s[0],a=a.replace(s,""),s=s.replace(e,"").toLowerCase());r=i.match(h.STYLE_REGEX);r&&(a=a.replace(r[0],""),r="italic");var a=a.replace(e,""),t="local('"+i.replace(e," ")+"'), url('"+t+"')",n=h.FONT_FORMAT[n];return n&&(t+=" format('"+n+"')"),this._defFromObj({family:a,weight:h.FONT_WEIGHT[s]||s,style:r,src:t})},t._defFromObj=function(t){t={family:t.family,src:t.src,style:t.style||"normal",weight:t.weight||"normal"};return t.id=t.family+";"+t.style+";"+t.weight,t},t._cssFromDef=function(t){return"@font-face {\n\tfont-family: '"+t.family+"';\n\tfont-style: "+t.style+";\n\tfont-weight: "+t.weight+";\n\tsrc: "+t.src+";\n}"},t._getTextWidth=function(t,e,i){var n=h._ctx;return n.font=i+" "+e+" 72px "+t,n.measureText(h.sampleText).width},t._getCSSValue=function(t,e){t=new RegExp(e+":s*([^;}]+?)s*[;}]").exec(t);return t&&t[1]?t[1]:null},R.FontLoader=R.promote(h,"AbstractLoader")}(),function(){"use strict";function t(t,e){this.AbstractLoader_constructor(t,e,R.Types.IMAGE),this.resultFormatter=this._formatResult,this._tagSrcAttribute="src",R.DomUtils.isImageTag(t)?this._tag=t:R.DomUtils.isImageTag(t.src)?this._tag=t.src:R.DomUtils.isImageTag(t.tag)&&(this._tag=t.tag),null!=this._tag?this._preferXHR=!1:this._tag=R.Elements.img(),this.on("initialize",this._updateXHR,this)}var e=R.extend(t,R.AbstractLoader);t.canLoadItem=function(t){return t.type==R.Types.IMAGE},e.load=function(){var t;""!=this._tag.src&&this._tag.complete?this._sendComplete():(null==(t=1==(t=this._item.crossOrigin)?"Anonymous":t)||R.URLUtils.isLocal(this._item)||(this._tag.crossOrigin=t),this.AbstractLoader_load())},e._updateXHR=function(t){t.loader.mimeType="text/plain; charset=x-user-defined-binary",t.loader.setResponseType&&t.loader.setResponseType("blob")},e._formatResult=function(t){return this._formatImage},e._formatImage=function(t,e){var i=this._tag,n=window.URL||window.webkitURL;this._preferXHR&&(n?(n=n.createObjectURL(this.getResult(!0)),i.src=n,i.addEventListener("load",this._cleanUpURL,!1),i.addEventListener("error",this._cleanUpURL,!1)):i.src=this._item.src),i.complete?t(i):(i.onload=R.proxy(function(){t(this._tag),i.onload=i.onerror=null},this),i.onerror=R.proxy(function(t){e(new R.ErrorEvent("IMAGE_FORMAT",null,t)),i.onload=i.onerror=null},this))},e._cleanUpURL=function(t){(window.URL||window.webkitURL).revokeObjectURL(t.target.src)},R.ImageLoader=R.promote(t,"AbstractLoader")}(),function(){"use strict";function t(t,e){this.AbstractLoader_constructor(t,e,R.Types.JAVASCRIPT),this.resultFormatter=this._formatResult,this._tagSrcAttribute="src",this.setTag(R.Elements.script())}var e=R.extend(t,R.AbstractLoader);t.canLoadItem=function(t){return t.type==R.Types.JAVASCRIPT},e._formatResult=function(t){var e=t.getTag();return this._preferXHR&&(e.text=t.getResult(!0)),e},R.JavaScriptLoader=R.promote(t,"AbstractLoader")}(),function(){"use strict";function t(t){this.AbstractLoader_constructor(t,!0,R.Types.JSON),this.resultFormatter=this._formatResult}var e=R.extend(t,R.AbstractLoader);t.canLoadItem=function(t){return t.type==R.Types.JSON},e._formatResult=function(e){var t=null;try{t=R.DataUtils.parseJSON(e.getResult(!0))}catch(t){e=new R.ErrorEvent("JSON_FORMAT",null,t);return this._sendError(e),t}return t},R.JSONLoader=R.promote(t,"AbstractLoader")}(),function(){"use strict";function t(t){this.AbstractLoader_constructor(t,!1,R.Types.JSONP),this.setTag(R.Elements.script()),this.getTag().type="text/javascript"}var e=R.extend(t,R.AbstractLoader);t.canLoadItem=function(t){return t.type==R.Types.JSONP},e.cancel=function(){this.AbstractLoader_cancel(),this._dispose()},e.load=function(){if(null==this._item.callback)throw new Error("callback is required for loading JSONP requests.");if(null!=window[this._item.callback])throw new Error("JSONP callback '"+this._item.callback+"' already exists on window. You need to specify a different callback or re-name the current one.");window[this._item.callback]=R.proxy(this._handleLoad,this),R.DomUtils.appendToBody(this._tag),this._loadTimeout=setTimeout(R.proxy(this._handleTimeout,this),this._item.loadTimeout),this._tag.src=this._item.src},e._handleLoad=function(t){this._result=this._rawResult=t,this._sendComplete(),this._dispose()},e._handleTimeout=function(){this._dispose(),this.dispatchEvent(new R.ErrorEvent("timeout"))},e._dispose=function(){R.DomUtils.removeChild(this._tag),delete window[this._item.callback],clearTimeout(this._loadTimeout)},R.JSONPLoader=R.promote(t,"AbstractLoader")}(),function(){"use strict";function t(t,e){this.AbstractLoader_constructor(t,e,R.Types.MANIFEST),this.plugins=null,this._manifestQueue=null}var e=R.extend(t,R.AbstractLoader),i=t;i.MANIFEST_PROGRESS=.25,i.canLoadItem=function(t){return t.type==R.Types.MANIFEST},e.load=function(){this.AbstractLoader_load()},e._createRequest=function(){var t=this._item.callback;this._request=new(null!=t?R.JSONPLoader:R.JSONLoader)(this._item)},e.handleEvent=function(t){switch(t.type){case"complete":return this._rawResult=t.target.getResult(!0),this._result=t.target.getResult(),this._sendProgress(i.MANIFEST_PROGRESS),void this._loadManifest(this._result);case"progress":return t.loaded*=i.MANIFEST_PROGRESS,this.progress=t.loaded/t.total,!isNaN(this.progress)&&this.progress!=1/0||(this.progress=0),void this._sendProgress(t)}this.AbstractLoader_handleEvent(t)},e.destroy=function(){this.AbstractLoader_destroy(),this._manifestQueue.close()},e._loadManifest=function(t){if(t&&t.manifest){var e=this._manifestQueue=new R.LoadQueue(this._preferXHR);e.on("fileload",this._handleManifestFileLoad,this),e.on("progress",this._handleManifestProgress,this),e.on("complete",this._handleManifestComplete,this,!0),e.on("error",this._handleManifestError,this,!0);for(var i=0,n=this.plugins.length;i<n;i++)e.installPlugin(this.plugins[i]);e.loadManifest(t)}else this._sendComplete()},e._handleManifestFileLoad=function(t){t.target=null,this.dispatchEvent(t)},e._handleManifestComplete=function(t){this._loadedItems=this._manifestQueue.getItems(!0),this._sendComplete()},e._handleManifestProgress=function(t){this.progress=t.progress*(1-i.MANIFEST_PROGRESS)+i.MANIFEST_PROGRESS,this._sendProgress(this.progress)},e._handleManifestError=function(t){var e=new R.Event("fileerror");e.item=t.data,this.dispatchEvent(e)},R.ManifestLoader=R.promote(t,"AbstractLoader")}(),function(){"use strict";function t(t,e){this.AbstractMediaLoader_constructor(t,e,R.Types.SOUND),R.DomUtils.isAudioTag(t)||R.DomUtils.isAudioTag(t.src)?this._tag=t:R.DomUtils.isAudioTag(t.tag)&&(this._tag=R.DomUtils.isAudioTag(t)?t:t.src),null!=this._tag&&(this._preferXHR=!1)}var e=R.extend(t,R.AbstractMediaLoader);t.canLoadItem=function(t){return t.type==R.Types.SOUND},e._createTag=function(t){var e=R.Elements.audio();return e.autoplay=!1,e.preload="none",e.src=t,e},R.SoundLoader=R.promote(t,"AbstractMediaLoader")}(),function(){"use strict";function t(t,e){this.AbstractMediaLoader_constructor(t,e,R.Types.VIDEO),R.DomUtils.isVideoTag(t)||R.DomUtils.isVideoTag(t.src)?(this.setTag(R.DomUtils.isVideoTag(t)?t:t.src),this._preferXHR=!1):this.setTag(this._createTag())}var e=t;R.extend(t,R.AbstractMediaLoader)._createTag=function(){return R.Elements.video()},e.canLoadItem=function(t){return t.type==R.Types.VIDEO},R.VideoLoader=R.promote(t,"AbstractMediaLoader")}(),function(){"use strict";function t(t,e){this.AbstractLoader_constructor(t,e,R.Types.SPRITESHEET),this._manifestQueue=null}var e=R.extend(t,R.AbstractLoader),i=t;i.SPRITESHEET_PROGRESS=.25,i.canLoadItem=function(t){return t.type==R.Types.SPRITESHEET},e.destroy=function(){this.AbstractLoader_destroy(),this._manifestQueue.close()},e._createRequest=function(){var t=this._item.callback;this._request=new(null!=t?R.JSONPLoader:R.JSONLoader)(this._item)},e.handleEvent=function(t){switch(t.type){case"complete":return this._rawResult=t.target.getResult(!0),this._result=t.target.getResult(),this._sendProgress(i.SPRITESHEET_PROGRESS),void this._loadManifest(this._result);case"progress":return t.loaded*=i.SPRITESHEET_PROGRESS,this.progress=t.loaded/t.total,!isNaN(this.progress)&&this.progress!=1/0||(this.progress=0),void this._sendProgress(t)}this.AbstractLoader_handleEvent(t)},e._loadManifest=function(t){var e;t&&t.images&&((e=this._manifestQueue=new R.LoadQueue(this._preferXHR,this._item.path,this._item.crossOrigin)).on("complete",this._handleManifestComplete,this,!0),e.on("fileload",this._handleManifestFileLoad,this),e.on("progress",this._handleManifestProgress,this),e.on("error",this._handleManifestError,this,!0),e.loadManifest(t.images))},e._handleManifestFileLoad=function(t){var e,i=t.result;null!=i&&(t=(e=this.getResult().images).indexOf(t.item.src),e[t]=i)},e._handleManifestComplete=function(t){this._result=new R.SpriteSheet(this._result),this._loadedItems=this._manifestQueue.getItems(!0),this._sendComplete()},e._handleManifestProgress=function(t){this.progress=t.progress*(1-i.SPRITESHEET_PROGRESS)+i.SPRITESHEET_PROGRESS,this._sendProgress(this.progress)},e._handleManifestError=function(t){var e=new R.Event("fileerror");e.item=t.data,this.dispatchEvent(e)},R.SpriteSheetLoader=R.promote(t,"AbstractLoader")}(),function(){"use strict";function t(t,e){this.AbstractLoader_constructor(t,e,R.Types.SVG),this.resultFormatter=this._formatResult,this._tagSrcAttribute="data",e?this.setTag(R.Elements.svg()):(this.setTag(R.Elements.object()),this.getTag().type="image/svg+xml")}var e=R.extend(t,R.AbstractLoader);t.canLoadItem=function(t){return t.type==R.Types.SVG},e._formatResult=function(t){var e=R.DataUtils.parseXML(t.getResult(!0)),t=t.getTag();if(!this._preferXHR&&document.body.contains(t)&&document.body.removeChild(t),null==e.documentElement)return e;e=e.documentElement;return document.importNode&&(e=document.importNode(e,!0)),t.appendChild(e),t},R.SVGLoader=R.promote(t,"AbstractLoader")}(),function(){"use strict";function t(t){this.AbstractLoader_constructor(t,!0,R.Types.XML),this.resultFormatter=this._formatResult}var e=R.extend(t,R.AbstractLoader);t.canLoadItem=function(t){return t.type==R.Types.XML},e._formatResult=function(t){return R.DataUtils.parseXML(t.getResult(!0))},R.XMLLoader=R.promote(t,"AbstractLoader")}(),(e=R.SoundJS=R.SoundJS||{}).version="1.0.0",e.buildDate="Thu, 12 Oct 2017 16:34:05 GMT",function(){"use strict";function t(){throw"BrowserDetect cannot be instantiated"}var e=t.agent=window.navigator.userAgent;t.isWindowPhone=-1<e.indexOf("IEMobile")||-1<e.indexOf("Windows Phone"),t.isFirefox=-1<e.indexOf("Firefox"),t.isOpera=null!=window.opera,t.isChrome=-1<e.indexOf("Chrome"),t.isIOS=(-1<e.indexOf("iPod")||-1<e.indexOf("iPhone")||-1<e.indexOf("iPad"))&&!t.isWindowPhone,t.isAndroid=-1<e.indexOf("Android")&&!t.isWindowPhone,t.isBlackberry=-1<e.indexOf("Blackberry"),R.BrowserDetect=t}(),function(){"use strict";function t(){this.interrupt=null,this.delay=null,this.offset=null,this.loop=null,this.volume=null,this.pan=null,this.startTime=null,this.duration=null}var e=t.prototype={},i=t;i.create=function(t){if("string"==typeof t)return console&&(console.warn||console.log)("Deprecated behaviour. Sound.play takes a configuration object instead of individual arguments. See docs for info."),(new R.PlayPropsConfig).set({interrupt:t});if(null==t||t instanceof i||t instanceof Object)return(new R.PlayPropsConfig).set(t);if(null==t)throw new Error("PlayProps configuration not recognized.")},e.set=function(t){if(null!=t)for(var e in t)this[e]=t[e];return this},e.toString=function(){return"[PlayPropsConfig]"},R.PlayPropsConfig=i}(),function(){"use strict";function a(){throw"Sound cannot be instantiated"}var o=a;function h(t,e){this.init(t,e)}o.INTERRUPT_ANY="any",o.INTERRUPT_EARLY="early",o.INTERRUPT_LATE="late",o.INTERRUPT_NONE="none",o.PLAY_INITED="playInited",o.PLAY_SUCCEEDED="playSucceeded",o.PLAY_INTERRUPTED="playInterrupted",o.PLAY_FINISHED="playFinished",o.PLAY_FAILED="playFailed",o.SUPPORTED_EXTENSIONS=["mp3","ogg","opus","mpeg","wav","m4a","mp4","aiff","wma","mid"],o.EXTENSION_MAP={m4a:"mp4"},o.FILE_PATTERN=/^(?:(\w+:)\/{2}(\w+(?:\.\w+)*\/?))?([/.]*?(?:[^?]+)?\/)?((?:[^/?]+)\.(\w+))(?:\?(\S+)?)?$/,o.defaultInterruptBehavior=o.INTERRUPT_NONE,o.alternateExtensions=[],o.activePlugin=null,o._masterVolume=1,o._getMasterVolume=function(){return this._masterVolume},o.getVolume=R.deprecate(o._getMasterVolume,"Sound.getVolume"),o._setMasterVolume=function(t){if(null!=Number(t)&&(t=Math.max(0,Math.min(1,t)),o._masterVolume=t,!this.activePlugin||!this.activePlugin.setVolume||!this.activePlugin.setVolume(t)))for(var e=this._instances,i=0,n=e.length;i<n;i++)e[i].setMasterVolume(t)},o.setVolume=R.deprecate(o._setMasterVolume,"Sound.setVolume"),o._masterMute=!1,o._getMute=function(){return this._masterMute},o.getMute=R.deprecate(o._getMute,"Sound.getMute"),o._setMute=function(t){if(null!=t&&(this._masterMute=t,!this.activePlugin||!this.activePlugin.setMute||!this.activePlugin.setMute(t)))for(var e=this._instances,i=0,n=e.length;i<n;i++)e[i].setMasterMute(t)},o.setMute=R.deprecate(o._setMute,"Sound.setMute"),o._getCapabilities=function(){return null==o.activePlugin?null:o.activePlugin._capabilities},o.getCapabilities=R.deprecate(o._getCapabilities,"Sound.getCapabilities"),Object.defineProperties(o,{volume:{get:o._getMasterVolume,set:o._setMasterVolume},muted:{get:o._getMute,set:o._setMute},capabilities:{get:o._getCapabilities}}),o._pluginsRegistered=!1,o._lastID=0,o._instances=[],o._idHash={},o._preloadHash={},o._defaultPlayPropsHash={},o.addEventListener=null,o.removeEventListener=null,o.removeAllEventListeners=null,o.dispatchEvent=null,o.hasEventListener=null,o._listeners=null,R.EventDispatcher.initialize(o),o.getPreloadHandlers=function(){return{callback:R.proxy(o.initLoad,o),types:["sound"],extensions:o.SUPPORTED_EXTENSIONS}},o._handleLoadComplete=function(t){var e=t.target.getItem().src;if(o._preloadHash[e])for(var i=0,n=o._preloadHash[e].length;i<n;i++){var r=o._preloadHash[e][i];o._preloadHash[e][i]=!0,o.hasEventListener("fileload")&&((t=new R.Event("fileload")).src=r.src,t.id=r.id,t.data=r.data,t.sprite=r.sprite,o.dispatchEvent(t))}},o._handleLoadError=function(t){var e=t.target.getItem().src;if(o._preloadHash[e])for(var i=0,n=o._preloadHash[e].length;i<n;i++){var r=o._preloadHash[e][i];o._preloadHash[e][i]=!1,o.hasEventListener("fileerror")&&((t=new R.Event("fileerror")).src=r.src,t.id=r.id,t.data=r.data,t.sprite=r.sprite,o.dispatchEvent(t))}},o._registerPlugin=function(t){return!!t.isSupported()&&(o.activePlugin=new t,!0)},o.registerPlugins=function(t){o._pluginsRegistered=!0;for(var e=0,i=t.length;e<i;e++)if(o._registerPlugin(t[e]))return!0;return!1},o.initializeDefaultPlugins=function(){return null!=o.activePlugin||!o._pluginsRegistered&&!!o.registerPlugins([R.WebAudioPlugin,R.HTMLAudioPlugin])},o.isReady=function(){return null!=o.activePlugin},o.initLoad=function(t){return"video"==t.type||o._registerSound(t)},o._registerSound=function(t){if(!o.initializeDefaultPlugins())return!1;if(t.src instanceof Object?(s=o._parseSrc(t.src)).src=t.path+s.src:s=o._parsePath(t.src),null==s)return!1;t.src=s.src,t.type="sound";var e=t.data,i=null;if(null!=e&&(isNaN(e.channels)?isNaN(e)||(i=parseInt(e)):i=parseInt(e.channels),e.audioSprite))for(var n,r=e.audioSprite.length;r--;)n=e.audioSprite[r],o._idHash[n.id]={src:t.src,startTime:parseInt(n.startTime),duration:parseInt(n.duration)},n.defaultPlayProps&&(o._defaultPlayPropsHash[n.id]=R.PlayPropsConfig.create(n.defaultPlayProps));null!=t.id&&(o._idHash[t.id]={src:t.src});var s=o.activePlugin.register(t);return h.create(t.src,i),null!=e&&isNaN(e)?t.data.channels=i||h.maxPerChannel():t.data=i||h.maxPerChannel(),s.type&&(t.type=s.type),t.defaultPlayProps&&(o._defaultPlayPropsHash[t.src]=R.PlayPropsConfig.create(t.defaultPlayProps)),s},o.registerSound=function(t,e,i,n,r){r={src:t,id:e,data:i,defaultPlayProps:r};t instanceof Object&&t.src&&(n=e,r=t),null==((r=R.LoadItem.create(r)).path=n)||r.src instanceof Object||(r.src=n+r.src);n=o._registerSound(r);if(!n)return!1;if(o._preloadHash[r.src]||(o._preloadHash[r.src]=[]),o._preloadHash[r.src].push(r),1==o._preloadHash[r.src].length)n.on("complete",this._handleLoadComplete,this),n.on("error",this._handleLoadError,this),o.activePlugin.preload(n);else if(1==o._preloadHash[r.src][0])return!0;return r},o.registerSounds=function(t,e){var i=[];t.path&&(e?e+=t.path:e=t.path,t=t.manifest);for(var n=0,r=t.length;n<r;n++)i[n]=R.Sound.registerSound(t[n].src,t[n].id,t[n].data,e,t[n].defaultPlayProps);return i},o.removeSound=function(t,e){if(null==o.activePlugin)return!1;var i,n;if(null==(i=(t=t instanceof Object&&t.src?t.src:t)instanceof Object?o._parseSrc(t):(t=o._getSrcById(t).src,o._parsePath(t))))return!1;for(n in t=i.src,null!=e&&(t=e+t),o._idHash)o._idHash[n].src==t&&delete o._idHash[n];return h.removeSrc(t),delete o._preloadHash[t],o.activePlugin.removeSound(t),!0},o.removeSounds=function(t,e){var i=[];t.path&&(e?e+=t.path:e=t.path,t=t.manifest);for(var n=0,r=t.length;n<r;n++)i[n]=R.Sound.removeSound(t[n].src,e);return i},o.removeAllSounds=function(){o._idHash={},o._preloadHash={},h.removeAll(),o.activePlugin&&o.activePlugin.removeAllSounds()},o.loadComplete=function(t){if(!o.isReady())return!1;var e=o._parsePath(t);return t=(e?o._getSrcById(e.src):o._getSrcById(t)).src,null!=o._preloadHash[t]&&1==o._preloadHash[t][0]},o._parsePath=function(t){var e=(t="string"!=typeof t?t.toString():t).match(o.FILE_PATTERN);if(null==e)return!1;for(var i=e[4],n=e[5],r=o.capabilities,s=0;!r[n];)if(n=o.alternateExtensions[s++],s>o.alternateExtensions.length)return null;return{name:i,src:t=t.replace("."+e[5],"."+n),extension:n}},o._parseSrc=function(t){var e,i={name:void 0,src:void 0,extension:void 0},n=o.capabilities;for(e in t)if(t.hasOwnProperty(e)&&n[e]){i.src=t[e],i.extension=e;break}if(!i.src)return!1;var r=i.src.lastIndexOf("/");return i.name=-1!=r?i.src.slice(r+1):i.src,i},o.play=function(t,e){e=R.PlayPropsConfig.create(e),t=o.createInstance(t,e.startTime,e.duration);return o._playInstance(t,e)||t._playFailed(),t},o.createInstance=function(t,e,i){if(!o.initializeDefaultPlugins())return new R.DefaultSoundInstance(t,e,i);var n=o._defaultPlayPropsHash[t];t=o._getSrcById(t);var r=o._parsePath(t.src),s=null;return null!=r&&null!=r.src?(h.create(r.src),null==e&&(e=t.startTime),s=o.activePlugin.create(r.src,e,i||t.duration),(n=n||o._defaultPlayPropsHash[r.src])&&s.applyPlayProps(n)):s=new R.DefaultSoundInstance(t,e,i),s.uniqueId=o._lastID++,s},o.stop=function(){for(var t=this._instances,e=t.length;e--;)t[e].stop()},o.setDefaultPlayProps=function(t,e){t=o._getSrcById(t),o._defaultPlayPropsHash[o._parsePath(t.src).src]=R.PlayPropsConfig.create(e)},o.getDefaultPlayProps=function(t){return t=o._getSrcById(t),o._defaultPlayPropsHash[o._parsePath(t.src).src]},o._playInstance=function(t,e){var i=o._defaultPlayPropsHash[t.src]||{};if(null==e.interrupt&&(e.interrupt=i.interrupt||o.defaultInterruptBehavior),null==e.delay&&(e.delay=i.delay||0),null==e.offset&&(e.offset=t.position),null==e.loop&&(e.loop=t.loop),null==e.volume&&(e.volume=t.volume),null==e.pan&&(e.pan=t.pan),0==e.delay){if(!o._beginPlaying(t,e))return!1}else{i=setTimeout(function(){o._beginPlaying(t,e)},e.delay);t.delayTimeoutId=i}return this._instances.push(t),!0},o._beginPlaying=function(t,e){if(!h.add(t,e.interrupt))return!1;if(t._beginPlaying(e))return!0;t=R.indexOf(this._instances,t);return-1<t&&this._instances.splice(t,1),!1},o._getSrcById=function(t){return o._idHash[t]||{src:t}},o._playFinished=function(t){h.remove(t);t=R.indexOf(this._instances,t);-1<t&&this._instances.splice(t,1)},R.Sound=a,h.channels={},h.create=function(t,e){return null==h.get(t)&&(h.channels[t]=new h(t,e),!0)},h.removeSrc=function(t){var e=h.get(t);return null!=e&&(e._removeAll(),delete h.channels[t],!0)},h.removeAll=function(){for(var t in h.channels)h.channels[t]._removeAll();h.channels={}},h.add=function(t,e){var i=h.get(t.src);return null!=i&&i._add(t,e)},h.remove=function(t){var e=h.get(t.src);return null!=e&&(e._remove(t),!0)},h.maxPerChannel=function(){return t.maxDefault},h.get=function(t){return h.channels[t]};var t=h.prototype;t.constructor=h,t.src=null,t.max=null,t.maxDefault=100,t.length=0,t.init=function(t,e){this.src=t,this.max=e||this.maxDefault,-1==this.max&&(this.max=this.maxDefault),this._instances=[]},t._get=function(t){return this._instances[t]},t._add=function(t,e){return!!this._getSlot(e,t)&&(this._instances.push(t),this.length++,!0)},t._remove=function(t){t=R.indexOf(this._instances,t);return-1!=t&&(this._instances.splice(t,1),this.length--,!0)},t._removeAll=function(){for(var t=this.length-1;0<=t;t--)this._instances[t].stop()},t._getSlot=function(t,e){var i,n;if(t!=a.INTERRUPT_NONE&&null==(n=this._get(0)))return!0;for(var r=0,s=this.max;r<s;r++){if(null==(i=this._get(r)))return!0;if(i.playState==a.PLAY_FINISHED||i.playState==a.PLAY_INTERRUPTED||i.playState==a.PLAY_FAILED){n=i;break}t!=a.INTERRUPT_NONE&&(t==a.INTERRUPT_EARLY&&i.position<n.position||t==a.INTERRUPT_LATE&&i.position>n.position)&&(n=i)}return null!=n&&(n._interrupt(),this._remove(n),!0)},t.toString=function(){return"[Sound SoundChannel]"}}(),function(){"use strict";function t(t,e,i,n){this.EventDispatcher_constructor(),this.src=t,this.uniqueId=-1,this.playState=null,this.delayTimeoutId=null,this._volume=1,Object.defineProperty(this,"volume",{get:this._getVolume,set:this._setVolume}),this.getVolume=R.deprecate(this._getVolume,"AbstractSoundInstance.getVolume"),this.setVolume=R.deprecate(this._setVolume,"AbstractSoundInstance.setVolume"),this._pan=0,Object.defineProperty(this,"pan",{get:this._getPan,set:this._setPan}),this.getPan=R.deprecate(this._getPan,"AbstractSoundInstance.getPan"),this.setPan=R.deprecate(this._setPan,"AbstractSoundInstance.setPan"),this._startTime=Math.max(0,e||0),Object.defineProperty(this,"startTime",{get:this._getStartTime,set:this._setStartTime}),this.getStartTime=R.deprecate(this._getStartTime,"AbstractSoundInstance.getStartTime"),this.setStartTime=R.deprecate(this._setStartTime,"AbstractSoundInstance.setStartTime"),this._duration=Math.max(0,i||0),Object.defineProperty(this,"duration",{get:this._getDuration,set:this._setDuration}),this.getDuration=R.deprecate(this._getDuration,"AbstractSoundInstance.getDuration"),this.setDuration=R.deprecate(this._setDuration,"AbstractSoundInstance.setDuration"),this._playbackResource=null,Object.defineProperty(this,"playbackResource",{get:this._getPlaybackResource,set:this._setPlaybackResource}),!1!==n&&!0!==n&&this._setPlaybackResource(n),this.getPlaybackResource=R.deprecate(this._getPlaybackResource,"AbstractSoundInstance.getPlaybackResource"),this.setPlaybackResource=R.deprecate(this._setPlaybackResource,"AbstractSoundInstance.setPlaybackResource"),this._position=0,Object.defineProperty(this,"position",{get:this._getPosition,set:this._setPosition}),this.getPosition=R.deprecate(this._getPosition,"AbstractSoundInstance.getPosition"),this.setPosition=R.deprecate(this._setPosition,"AbstractSoundInstance.setPosition"),this._loop=0,Object.defineProperty(this,"loop",{get:this._getLoop,set:this._setLoop}),this.getLoop=R.deprecate(this._getLoop,"AbstractSoundInstance.getLoop"),this.setLoop=R.deprecate(this._setLoop,"AbstractSoundInstance.setLoop"),this._muted=!1,Object.defineProperty(this,"muted",{get:this._getMuted,set:this._setMuted}),this.getMuted=R.deprecate(this._getMuted,"AbstractSoundInstance.getMuted"),this.setMuted=R.deprecate(this._setMuted,"AbstractSoundInstance.setMuted"),this._paused=!1,Object.defineProperty(this,"paused",{get:this._getPaused,set:this._setPaused}),this.getPaused=R.deprecate(this._getPaused,"AbstractSoundInstance.getPaused"),this.setPaused=R.deprecate(this._setPaused,"AbstractSoundInstance.setPaused")}var e=R.extend(t,R.EventDispatcher);e.play=function(t){t=R.PlayPropsConfig.create(t);return this.playState==R.Sound.PLAY_SUCCEEDED?(this.applyPlayProps(t),void(this._paused&&this._setPaused(!1))):(this._cleanUp(),R.Sound._playInstance(this,t),this)},e.stop=function(){return this._position=0,this._paused=!1,this._handleStop(),this._cleanUp(),this.playState=R.Sound.PLAY_FINISHED,this},e.destroy=function(){this._cleanUp(),this.src=null,this.playbackResource=null,this.removeAllEventListeners()},e.applyPlayProps=function(t){return null!=t.offset&&this._setPosition(t.offset),null!=t.loop&&this._setLoop(t.loop),null!=t.volume&&this._setVolume(t.volume),null!=t.pan&&this._setPan(t.pan),null!=t.startTime&&(this._setStartTime(t.startTime),this._setDuration(t.duration)),this},e.toString=function(){return"[AbstractSoundInstance]"},e._getPaused=function(){return this._paused},e._setPaused=function(t){if(!(!0!==t&&!1!==t||this._paused==t||1==t&&this.playState!=R.Sound.PLAY_SUCCEEDED))return(this._paused=t)?this._pause():this._resume(),clearTimeout(this.delayTimeoutId),this},e._setVolume=function(t){return t==this._volume||(this._volume=Math.max(0,Math.min(1,t)),this._muted||this._updateVolume()),this},e._getVolume=function(){return this._volume},e._setMuted=function(t){if(!0===t||!1===t)return this._muted=t,this._updateVolume(),this},e._getMuted=function(){return this._muted},e._setPan=function(t){return t==this._pan||(this._pan=Math.max(-1,Math.min(1,t)),this._updatePan()),this},e._getPan=function(){return this._pan},e._getPosition=function(){return this._paused||this.playState!=R.Sound.PLAY_SUCCEEDED||(this._position=this._calculateCurrentPosition()),this._position},e._setPosition=function(t){return this._position=Math.max(0,t),this.playState==R.Sound.PLAY_SUCCEEDED&&this._updatePosition(),this},e._getStartTime=function(){return this._startTime},e._setStartTime=function(t){return t==this._startTime||(this._startTime=Math.max(0,t||0),this._updateStartTime()),this},e._getDuration=function(){return this._duration},e._setDuration=function(t){return t==this._duration||(this._duration=Math.max(0,t||0),this._updateDuration()),this},e._setPlaybackResource=function(t){return this._playbackResource=t,0==this._duration&&this._playbackResource&&this._setDurationFromSource(),this},e._getPlaybackResource=function(){return this._playbackResource},e._getLoop=function(){return this._loop},e._setLoop=function(t){null!=this._playbackResource&&(0!=this._loop&&0==t?this._removeLooping(t):0==this._loop&&0!=t&&this._addLooping(t)),this._loop=t},e._sendEvent=function(t){t=new R.Event(t);this.dispatchEvent(t)},e._cleanUp=function(){clearTimeout(this.delayTimeoutId),this._handleCleanUp(),this._paused=!1,R.Sound._playFinished(this)},e._interrupt=function(){this._cleanUp(),this.playState=R.Sound.PLAY_INTERRUPTED,this._sendEvent("interrupted")},e._beginPlaying=function(t){return this._setPosition(t.offset),this._setLoop(t.loop),this._setVolume(t.volume),this._setPan(t.pan),null!=t.startTime&&(this._setStartTime(t.startTime),this._setDuration(t.duration)),null!=this._playbackResource&&this._position<this._duration?(this._paused=!1,this._handleSoundReady(),this.playState=R.Sound.PLAY_SUCCEEDED,this._sendEvent("succeeded"),!0):(this._playFailed(),!1)},e._playFailed=function(){this._cleanUp(),this.playState=R.Sound.PLAY_FAILED,this._sendEvent("failed")},e._handleSoundComplete=function(t){if((this._position=0)!=this._loop)return this._loop--,this._handleLoop(),void this._sendEvent("loop");this._cleanUp(),this.playState=R.Sound.PLAY_FINISHED,this._sendEvent("complete")},e._handleSoundReady=function(){},e._updateVolume=function(){},e._updatePan=function(){},e._updateStartTime=function(){},e._updateDuration=function(){},e._setDurationFromSource=function(){},e._calculateCurrentPosition=function(){},e._updatePosition=function(){},e._removeLooping=function(t){},e._addLooping=function(t){},e._pause=function(){},e._resume=function(){},e._handleStop=function(){},e._handleCleanUp=function(){},e._handleLoop=function(){},R.AbstractSoundInstance=R.promote(t,"EventDispatcher"),R.DefaultSoundInstance=R.AbstractSoundInstance}(),function(){"use strict";function t(){this._capabilities=null,this._loaders={},this._audioSources={},this._soundInstances={},this._volume=1,this._loaderClass,this._soundInstanceClass}var e=t.prototype;t._capabilities=null,t.isSupported=function(){return!0},e.register=function(t){var e=this._loaders[t.src];return e&&!e.canceled?this._loaders[t.src]:(this._audioSources[t.src]=!0,this._soundInstances[t.src]=[],(e=new this._loaderClass(t)).on("complete",this._handlePreloadComplete,this),this._loaders[t.src]=e)},e.preload=function(t){t.on("error",this._handlePreloadError,this),t.load()},e.isPreloadStarted=function(t){return null!=this._audioSources[t]},e.isPreloadComplete=function(t){return!(null==this._audioSources[t]||1==this._audioSources[t])},e.removeSound=function(t){if(this._soundInstances[t]){for(var e=this._soundInstances[t].length;e--;)this._soundInstances[t][e].destroy();delete this._soundInstances[t],delete this._audioSources[t],this._loaders[t]&&this._loaders[t].destroy(),delete this._loaders[t]}},e.removeAllSounds=function(){for(var t in this._audioSources)this.removeSound(t)},e.create=function(t,e,i){this.isPreloadStarted(t)||this.preload(this.register(t));i=new this._soundInstanceClass(t,e,i,this._audioSources[t]);return this._soundInstances[t]&&this._soundInstances[t].push(i),i.setMasterVolume&&i.setMasterVolume(R.Sound.volume),i.setMasterMute&&i.setMasterMute(R.Sound.muted),i},e.setVolume=function(t){return this._volume=t,this._updateVolume(),!0},e.getVolume=function(){return this._volume},e.setMute=function(t){return this._updateVolume(),!0},e.toString=function(){return"[AbstractPlugin]"},e._handlePreloadComplete=function(t){var e=t.target.getItem().src;this._audioSources[e]=t.result;for(var i=0,n=this._soundInstances[e].length;i<n;i++)this._soundInstances[e][i].playbackResource=this._audioSources[e];this._soundInstances[e]=null},e._handlePreloadError=function(t){},e._updateVolume=function(){},R.AbstractPlugin=t}(),function(){"use strict";function e(t){this.AbstractLoader_constructor(t,!0,R.Types.SOUND)}var t=R.extend(e,R.AbstractLoader);e.context=null,t.toString=function(){return"[WebAudioLoader]"},t._createRequest=function(){this._request=new R.XHRRequest(this._item,!1),this._request.setResponseType("arraybuffer")},t._sendComplete=function(t){e.context.decodeAudioData(this._rawResult,R.proxy(this._handleAudioDecoded,this),R.proxy(this._sendError,this))},t._handleAudioDecoded=function(t){this._result=t,this.AbstractLoader__sendComplete()},R.WebAudioLoader=R.promote(e,"AbstractLoader")}(),function(){"use strict";function t(t,e,i,n){this.AbstractSoundInstance_constructor(t,e,i,n),this.gainNode=r.context.createGain(),this.panNode=r.context.createPanner(),this.panNode.panningModel=r._panningModel,this.panNode.connect(this.gainNode),this._updatePan(),this.sourceNode=null,this._soundCompleteTimeout=null,this._sourceNodeNext=null,this._playbackStartTime=0,this._endedHandler=R.proxy(this._handleSoundComplete,this)}var e=R.extend(t,R.AbstractSoundInstance),r=t;r.context=null,r._scratchBuffer=null,r.destinationNode=null,r._panningModel="equalpower",e.destroy=function(){this.AbstractSoundInstance_destroy(),this.panNode.disconnect(0),this.panNode=null,this.gainNode.disconnect(0),this.gainNode=null},e.toString=function(){return"[WebAudioSoundInstance]"},e._updatePan=function(){this.panNode.setPosition(this._pan,0,-.5)},e._removeLooping=function(t){this._sourceNodeNext=this._cleanUpAudioNode(this._sourceNodeNext)},e._addLooping=function(t){this.playState==R.Sound.PLAY_SUCCEEDED&&(this._sourceNodeNext=this._createAndPlayAudioNode(this._playbackStartTime,0))},e._setDurationFromSource=function(){this._duration=1e3*this.playbackResource.duration},e._handleCleanUp=function(){this.sourceNode&&this.playState==R.Sound.PLAY_SUCCEEDED&&(this.sourceNode=this._cleanUpAudioNode(this.sourceNode),this._sourceNodeNext=this._cleanUpAudioNode(this._sourceNodeNext)),0!=this.gainNode.numberOfOutputs&&this.gainNode.disconnect(0),clearTimeout(this._soundCompleteTimeout),this._playbackStartTime=0},e._cleanUpAudioNode=function(t){if(t){if(t.stop(0),t.disconnect(0),R.BrowserDetect.isIOS)try{t.buffer=r._scratchBuffer}catch(t){}t=null}return t},e._handleSoundReady=function(t){this.gainNode.connect(r.destinationNode);var e=.001*this._duration,i=Math.min(.001*Math.max(0,this._position),e);this.sourceNode=this._createAndPlayAudioNode(r.context.currentTime-e,i),this._playbackStartTime=this.sourceNode.startTime-i,this._soundCompleteTimeout=setTimeout(this._endedHandler,1e3*(e-i)),0!=this._loop&&(this._sourceNodeNext=this._createAndPlayAudioNode(this._playbackStartTime,0))},e._createAndPlayAudioNode=function(t,e){var i=r.context.createBufferSource();i.buffer=this.playbackResource,i.connect(this.panNode);var n=.001*this._duration;return i.startTime=t+n,i.start(i.startTime,e+.001*this._startTime,n-e),i},e._pause=function(){this._position=1e3*(r.context.currentTime-this._playbackStartTime),this.sourceNode=this._cleanUpAudioNode(this.sourceNode),this._sourceNodeNext=this._cleanUpAudioNode(this._sourceNodeNext),0!=this.gainNode.numberOfOutputs&&this.gainNode.disconnect(0),clearTimeout(this._soundCompleteTimeout)},e._resume=function(){this._handleSoundReady()},e._updateVolume=function(){var t=this._muted?0:this._volume;t!=this.gainNode.gain.value&&(this.gainNode.gain.value=t)},e._calculateCurrentPosition=function(){return 1e3*(r.context.currentTime-this._playbackStartTime)},e._updatePosition=function(){this.sourceNode=this._cleanUpAudioNode(this.sourceNode),this._sourceNodeNext=this._cleanUpAudioNode(this._sourceNodeNext),clearTimeout(this._soundCompleteTimeout),this._paused||this._handleSoundReady()},e._handleLoop=function(){this._cleanUpAudioNode(this.sourceNode),this.sourceNode=this._sourceNodeNext,this._playbackStartTime=this.sourceNode.startTime,this._sourceNodeNext=this._createAndPlayAudioNode(this._playbackStartTime,0),this._soundCompleteTimeout=setTimeout(this._endedHandler,this._duration)},e._updateDuration=function(){this.playState==R.Sound.PLAY_SUCCEEDED&&(this._pause(),this._resume())},R.WebAudioSoundInstance=R.promote(t,"AbstractSoundInstance")}(),function(){"use strict";function t(){this.AbstractPlugin_constructor(),this._panningModel=o._panningModel,this.context=o.context,this.dynamicsCompressorNode=this.context.createDynamicsCompressor(),this.dynamicsCompressorNode.connect(this.context.destination),this.gainNode=this.context.createGain(),this.gainNode.connect(this.dynamicsCompressorNode),R.WebAudioSoundInstance.destinationNode=this.gainNode,this._capabilities=o._capabilities,this._loaderClass=R.WebAudioLoader,this._soundInstanceClass=R.WebAudioSoundInstance,this._addPropsToClasses()}var e=R.extend(t,R.AbstractPlugin),o=t;o._capabilities=null,o._panningModel="equalpower",o.context=null,o._scratchBuffer=null,o._unlocked=!1,o.DEFAULT_SAMPLE_RATE=44100,o.isSupported=function(){var t=R.BrowserDetect.isIOS||R.BrowserDetect.isAndroid||R.BrowserDetect.isBlackberry;return!("file:"==location.protocol&&!t&&!this._isFileXHRSupported())&&(o._generateCapabilities(),null!=o.context)},o.playEmptySound=function(){var t;null!=o.context&&((t=o.context.createBufferSource()).buffer=o._scratchBuffer,t.connect(o.context.destination),t.start(0,0,0))},o._isFileXHRSupported=function(){var e=!0,t=new XMLHttpRequest;try{t.open("GET","WebAudioPluginTest.fail",!1)}catch(t){return e=!1}t.onerror=function(){e=!1},t.onload=function(){e=404==this.status||200==this.status||0==this.status&&""!=this.response};try{t.send()}catch(t){e=!1}return e},o._generateCapabilities=function(){if(null==o._capabilities){var t=document.createElement("audio");if(null==t.canPlayType)return null;if(null==o.context&&(o.context=o._createAudioContext(),null==o.context))return null;null==o._scratchBuffer&&(o._scratchBuffer=o.context.createBuffer(1,1,22050)),o._compatibilitySetUp(),"ontouchstart"in window&&"running"!=o.context.state&&(o._unlock(),document.addEventListener("mousedown",o._unlock,!0),document.addEventListener("touchstart",o._unlock,!0),document.addEventListener("touchend",o._unlock,!0)),o._capabilities={panning:!0,volume:!0,tracks:-1};for(var e=R.Sound.SUPPORTED_EXTENSIONS,i=R.Sound.EXTENSION_MAP,n=0,r=e.length;n<r;n++){var s=e[n],a=i[s]||s;o._capabilities[s]="no"!=t.canPlayType("audio/"+s)&&""!=t.canPlayType("audio/"+s)||"no"!=t.canPlayType("audio/"+a)&&""!=t.canPlayType("audio/"+a)}o.context.destination.numberOfChannels<2&&(o._capabilities.panning=!1)}},o._createAudioContext=function(){var t=window.AudioContext||window.webkitAudioContext;if(null==t)return null;var e,i,n=new t;return/(iPhone|iPad)/i.test(navigator.userAgent)&&n.sampleRate!==o.DEFAULT_SAMPLE_RATE&&(e=n.createBuffer(1,1,o.DEFAULT_SAMPLE_RATE),(i=n.createBufferSource()).buffer=e,i.connect(n.destination),i.start(0),i.disconnect(),n.close(),n=new t),n},o._compatibilitySetUp=function(){var t;o._panningModel="equalpower",o.context.createGain||(o.context.createGain=o.context.createGainNode,(t=o.context.createBufferSource()).__proto__.start=t.__proto__.noteGrainOn,t.__proto__.stop=t.__proto__.noteOff,o._panningModel=0)},o._unlock=function(){o._unlocked||(o.playEmptySound(),"running"==o.context.state&&(document.removeEventListener("mousedown",o._unlock,!0),document.removeEventListener("touchend",o._unlock,!0),document.removeEventListener("touchstart",o._unlock,!0),o._unlocked=!0))},e.toString=function(){return"[WebAudioPlugin]"},e._addPropsToClasses=function(){var t=this._soundInstanceClass;t.context=this.context,t._scratchBuffer=o._scratchBuffer,t.destinationNode=this.gainNode,t._panningModel=this._panningModel,this._loaderClass.context=this.context},e._updateVolume=function(){var t=R.Sound._masterMute?0:this._volume;t!=this.gainNode.gain.value&&(this.gainNode.gain.value=t)},R.WebAudioPlugin=R.promote(t,"AbstractPlugin")}(),function(){"use strict";function t(){throw"HTMLAudioTagPool cannot be instantiated"}var i=t;function e(t){this._tags=[]}i._tags={},i._tagPool=new e,i._tagUsed={},i.get=function(t){var e=i._tags[t];return null==e?(e=i._tags[t]=i._tagPool.get()).src=t:i._tagUsed[t]?(e=i._tagPool.get()).src=t:i._tagUsed[t]=!0,e},i.set=function(t,e){e==i._tags[t]?i._tagUsed[t]=!1:i._tagPool.set(e)},i.remove=function(t){var e=i._tags[t];return null!=e&&(i._tagPool.set(e),delete i._tags[t],delete i._tagUsed[t],!0)},i.getDuration=function(t){t=i._tags[t];return null!=t&&t.duration?1e3*t.duration:0},R.HTMLAudioTagPool=t;var n=e.prototype;n.constructor=e,n.get=function(){var t=0==this._tags.length?this._createTag():this._tags.pop();return null==t.parentNode&&document.body.appendChild(t),t},n.set=function(t){-1==R.indexOf(this._tags,t)&&(this._tags.src=null,this._tags.push(t))},n.toString=function(){return"[TagPool]"},n._createTag=function(){var t=document.createElement("audio");return t.autoplay=!1,t.preload="none",t}}(),function(){"use strict";function t(t,e,i,n){this.AbstractSoundInstance_constructor(t,e,i,n),this._audioSpriteStopTime=null,this._delayTimeoutId=null,this._endedHandler=R.proxy(this._handleSoundComplete,this),this._readyHandler=R.proxy(this._handleTagReady,this),this._stalledHandler=R.proxy(this._playFailed,this),this._audioSpriteEndHandler=R.proxy(this._handleAudioSpriteLoop,this),this._loopHandler=R.proxy(this._handleSoundComplete,this),i?this._audioSpriteStopTime=.001*(e+i):this._duration=R.HTMLAudioTagPool.getDuration(this.src)}var e=R.extend(t,R.AbstractSoundInstance);e.setMasterVolume=function(t){this._updateVolume()},e.setMasterMute=function(t){this._updateVolume()},e.toString=function(){return"[HTMLAudioSoundInstance]"},e._removeLooping=function(){null!=this._playbackResource&&(this._playbackResource.loop=!1,this._playbackResource.removeEventListener(R.HTMLAudioPlugin._AUDIO_SEEKED,this._loopHandler,!1))},e._addLooping=function(){null==this._playbackResource||this._audioSpriteStopTime||(this._playbackResource.addEventListener(R.HTMLAudioPlugin._AUDIO_SEEKED,this._loopHandler,!1),this._playbackResource.loop=!0)},e._handleCleanUp=function(){var t=this._playbackResource;if(null!=t){t.pause(),t.loop=!1,t.removeEventListener(R.HTMLAudioPlugin._AUDIO_ENDED,this._endedHandler,!1),t.removeEventListener(R.HTMLAudioPlugin._AUDIO_READY,this._readyHandler,!1),t.removeEventListener(R.HTMLAudioPlugin._AUDIO_STALLED,this._stalledHandler,!1),t.removeEventListener(R.HTMLAudioPlugin._AUDIO_SEEKED,this._loopHandler,!1),t.removeEventListener(R.HTMLAudioPlugin._TIME_UPDATE,this._audioSpriteEndHandler,!1);try{t.currentTime=this._startTime}catch(t){}R.HTMLAudioTagPool.set(this.src,t),this._playbackResource=null}},e._beginPlaying=function(t){return this._playbackResource=R.HTMLAudioTagPool.get(this.src),this.AbstractSoundInstance__beginPlaying(t)},e._handleSoundReady=function(t){if(4!==this._playbackResource.readyState){var e=this._playbackResource;return e.addEventListener(R.HTMLAudioPlugin._AUDIO_READY,this._readyHandler,!1),e.addEventListener(R.HTMLAudioPlugin._AUDIO_STALLED,this._stalledHandler,!1),e.preload="auto",void e.load()}this._updateVolume(),this._playbackResource.currentTime=.001*(this._startTime+this._position),this._audioSpriteStopTime?this._playbackResource.addEventListener(R.HTMLAudioPlugin._TIME_UPDATE,this._audioSpriteEndHandler,!1):(this._playbackResource.addEventListener(R.HTMLAudioPlugin._AUDIO_ENDED,this._endedHandler,!1),0!=this._loop&&(this._playbackResource.addEventListener(R.HTMLAudioPlugin._AUDIO_SEEKED,this._loopHandler,!1),this._playbackResource.loop=!0)),this._playbackResource.play()},e._handleTagReady=function(t){this._playbackResource.removeEventListener(R.HTMLAudioPlugin._AUDIO_READY,this._readyHandler,!1),this._playbackResource.removeEventListener(R.HTMLAudioPlugin._AUDIO_STALLED,this._stalledHandler,!1),this._handleSoundReady()},e._pause=function(){this._playbackResource.pause()},e._resume=function(){this._playbackResource.play()},e._updateVolume=function(){var t;null==this._playbackResource||(t=this._muted||R.Sound._masterMute?0:this._volume*R.Sound._masterVolume)!=this._playbackResource.volume&&(this._playbackResource.volume=t)},e._calculateCurrentPosition=function(){return 1e3*this._playbackResource.currentTime-this._startTime},e._updatePosition=function(){this._playbackResource.removeEventListener(R.HTMLAudioPlugin._AUDIO_SEEKED,this._loopHandler,!1),this._playbackResource.addEventListener(R.HTMLAudioPlugin._AUDIO_SEEKED,this._handleSetPositionSeek,!1);try{this._playbackResource.currentTime=.001*(this._position+this._startTime)}catch(t){this._handleSetPositionSeek(null)}},e._handleSetPositionSeek=function(t){null!=this._playbackResource&&(this._playbackResource.removeEventListener(R.HTMLAudioPlugin._AUDIO_SEEKED,this._handleSetPositionSeek,!1),this._playbackResource.addEventListener(R.HTMLAudioPlugin._AUDIO_SEEKED,this._loopHandler,!1))},e._handleAudioSpriteLoop=function(t){this._playbackResource.currentTime<=this._audioSpriteStopTime||(this._playbackResource.pause(),0==this._loop?this._handleSoundComplete(null):(this._position=0,this._loop--,this._playbackResource.currentTime=.001*this._startTime,this._paused||this._playbackResource.play(),this._sendEvent("loop")))},e._handleLoop=function(t){0==this._loop&&(this._playbackResource.loop=!1,this._playbackResource.removeEventListener(R.HTMLAudioPlugin._AUDIO_SEEKED,this._loopHandler,!1))},e._updateStartTime=function(){this._audioSpriteStopTime=.001*(this._startTime+this._duration),this.playState==R.Sound.PLAY_SUCCEEDED&&(this._playbackResource.removeEventListener(R.HTMLAudioPlugin._AUDIO_ENDED,this._endedHandler,!1),this._playbackResource.addEventListener(R.HTMLAudioPlugin._TIME_UPDATE,this._audioSpriteEndHandler,!1))},e._updateDuration=function(){this._audioSpriteStopTime=.001*(this._startTime+this._duration),this.playState==R.Sound.PLAY_SUCCEEDED&&(this._playbackResource.removeEventListener(R.HTMLAudioPlugin._AUDIO_ENDED,this._endedHandler,!1),this._playbackResource.addEventListener(R.HTMLAudioPlugin._TIME_UPDATE,this._audioSpriteEndHandler,!1))},e._setDurationFromSource=function(){this._duration=R.HTMLAudioTagPool.getDuration(this.src),this._playbackResource=null},R.HTMLAudioSoundInstance=R.promote(t,"AbstractSoundInstance")}(),function(){"use strict";function t(){this.AbstractPlugin_constructor(),this._capabilities=o._capabilities,this._loaderClass=R.SoundLoader,this._soundInstanceClass=R.HTMLAudioSoundInstance}var e=R.extend(t,R.AbstractPlugin),o=t;o.MAX_INSTANCES=30,o._AUDIO_READY="canplaythrough",o._AUDIO_ENDED="ended",o._AUDIO_SEEKED="seeked",o._AUDIO_STALLED="stalled",o._TIME_UPDATE="timeupdate",o._capabilities=null,o.isSupported=function(){return o._generateCapabilities(),null!=o._capabilities},o._generateCapabilities=function(){if(null==o._capabilities){var t=document.createElement("audio");if(null==t.canPlayType)return null;o._capabilities={panning:!1,volume:!0,tracks:-1};for(var e=R.Sound.SUPPORTED_EXTENSIONS,i=R.Sound.EXTENSION_MAP,n=0,r=e.length;n<r;n++){var s=e[n],a=i[s]||s;o._capabilities[s]="no"!=t.canPlayType("audio/"+s)&&""!=t.canPlayType("audio/"+s)||"no"!=t.canPlayType("audio/"+a)&&""!=t.canPlayType("audio/"+a)}}},e.register=function(t){var e=R.HTMLAudioTagPool.get(t.src),t=this.AbstractPlugin_register(t);return t.setTag(e),t},e.removeSound=function(t){this.AbstractPlugin_removeSound(t),R.HTMLAudioTagPool.remove(t)},e.create=function(t,e,i){i=this.AbstractPlugin_create(t,e,i);return i.playbackResource=null,i},e.toString=function(){return"[HTMLAudioPlugin]"},e.setVolume=e.getVolume=e.setMute=null,R.HTMLAudioPlugin=R.promote(t,"AbstractPlugin")}(),function(){"use strict";function t(t){this.EventDispatcher_constructor(),this.ignoreGlobalPause=!1,this.loop=0,this.useTicks=!1,this.reversed=!1,this.bounce=!1,this.timeScale=1,this.duration=0,this.position=0,this.rawPosition=-1,this._paused=!0,this._next=null,this._prev=null,this._parent=null,this._labels=null,this._labelList=null,t&&(this.useTicks=!!t.useTicks,this.ignoreGlobalPause=!!t.ignoreGlobalPause,this.loop=!0===t.loop?-1:t.loop||0,this.reversed=!!t.reversed,this.bounce=!!t.bounce,this.timeScale=t.timeScale||1,t.onChange&&this.addEventListener("change",t.onChange),t.onComplete&&this.addEventListener("complete",t.onComplete))}var e=R.extend(t,R.EventDispatcher);e._setPaused=function(t){return R.Tween._register(this,t),this},e.setPaused=R.deprecate(e._setPaused,"AbstractTween.setPaused"),e._getPaused=function(){return this._paused},e.getPaused=R.deprecate(e._getPaused,"AbstactTween.getPaused"),e._getCurrentLabel=function(t){var e=this.getLabels();null==t&&(t=this.position);for(var i=0,n=e.length;i<n&&!(t<e[i].position);i++);return 0===i?null:e[i-1].label},e.getCurrentLabel=R.deprecate(e._getCurrentLabel,"AbstractTween.getCurrentLabel");try{Object.defineProperties(e,{paused:{set:e._setPaused,get:e._getPaused},currentLabel:{get:e._getCurrentLabel}})}catch(t){}e.advance=function(t,e){this.setPosition(this.rawPosition+t*this.timeScale,e)},e.setPosition=function(t,e,i,n){var r=this.duration,s=this.loop,a=this.rawPosition,o=0,h=0,l=!1;if(t<0&&(t=0),0===r){if(l=!0,-1!==a)return l}else{if(h=t-(o=t/r|0)*r,(t=(l=-1!==s&&s*r+r<=t)?(h=r)*(o=s)+r:t)===a)return l;!this.reversed!=!(this.bounce&&o%2)&&(h=r-h)}this.position=h,this.rawPosition=t,this._updatePosition(i,l),l&&(this.paused=!0),n&&n(this),e||this._runActions(a,t,i,!i&&-1===a),this.dispatchEvent("change"),l&&this.dispatchEvent("complete")},e.calculatePosition=function(t){var e=this.duration,i=this.loop,n=0,r=0;return 0===e?0:(-1!==i&&i*e+e<=t?(r=e,n=i):r=t<0?0:t-(n=t/e|0)*e,!this.reversed!=!(this.bounce&&n%2)?e-r:r)},e.getLabels=function(){if(!(e=this._labelList)){var t,e=this._labelList=[],i=this._labels;for(t in i)e.push({label:t,position:i[t]});e.sort(function(t,e){return t.position-e.position})}return e},e.setLabels=function(t){this._labels=t,this._labelList=null},e.addLabel=function(t,e){this._labels||(this._labels={}),this._labels[t]=e;var i=this._labelList;if(i){for(var n=0,r=i.length;n<r&&!(e<i[n].position);n++);i.splice(n,0,{label:t,position:e})}},e.gotoAndPlay=function(t){this.paused=!1,this._goto(t)},e.gotoAndStop=function(t){this.paused=!0,this._goto(t)},e.resolve=function(t){var e=Number(t);return e=isNaN(e)?this._labels&&this._labels[t]:e},e.toString=function(){return"[AbstractTween]"},e.clone=function(){throw"AbstractTween can not be cloned."},e._init=function(t){t&&t.paused||(this.paused=!1),t&&null!=t.position&&this.setPosition(t.position)},e._updatePosition=function(t,e){},e._goto=function(t){t=this.resolve(t);null!=t&&this.setPosition(t,!1,!0)},e._runActions=function(t,e,i,n){if(this._actionHead||this.tweens){var r,s,a,o,h=this.duration,l=this.reversed,u=this.bounce,c=this.loop;if(0===h?(r=s=a=o=0,l=u=!1):(a=t-(r=t/h|0)*h,o=e-(s=e/h|0)*h),-1!==c&&(c<s&&(o=h,s=c),c<r&&(a=h,r=c)),i)return this._runActionsRange(o,o,i,n);if(r!==s||a!==o||i||n){var d=t<=e,p=r=-1===r?a=0:r;do{var _=!l!=!(u&&p%2),f=p===r?a:d?0:h,g=p===s?o:d?h:0;if(_&&(f=h-f,g=h-g),(!u||p===r||f!==g)&&this._runActionsRange(f,g,i,n||p!==r&&!u))return!0}while(n=!1,d&&++p<=s||!d&&--p>=s)}}},e._runActionsRange=function(t,e,i,n){},R.AbstractTween=R.promote(t,"EventDispatcher")}(),function(){"use strict";function g(t,e){this.AbstractTween_constructor(e),this.pluginData=null,this.target=t,this.passive=!1,this._stepHead=new r(null,0,0,{},null,!0),this._stepTail=this._stepHead,this._stepPosition=0,this._actionHead=null,this._actionTail=null,this._plugins=null,this._pluginIds=null,this._injected=null,e&&(this.pluginData=e.pluginData,e.override&&g.removeTweens(t)),this.pluginData||(this.pluginData={}),this._init(e)}var t=R.extend(g,R.AbstractTween);function r(t,e,i,n,r,s){this.next=null,this.prev=t,this.t=e,this.d=i,this.props=n,this.ease=r,this.passive=s,this.index=t?t.index+1:0}function n(t,e,i,n,r){this.next=null,this.prev=t,this.t=e,this.d=0,this.scope=i,this.funct=n,this.params=r}g.IGNORE={},g._tweens=[],g._plugins=null,g._tweenHead=null,g._tweenTail=null,g.get=function(t,e){return new g(t,e)},g.tick=function(t,e){for(var i=g._tweenHead;i;){var n=i._next;e&&!i.ignoreGlobalPause||i._paused||i.advance(i.useTicks?1:t),i=n}},g.handleEvent=function(t){"tick"===t.type&&this.tick(t.delta,t.paused)},g.removeTweens=function(t){if(t.tweenjs_count){for(var e=g._tweenHead;e;){var i=e._next;e.target===t&&g._register(e,!0),e=i}t.tweenjs_count=0}},g.removeAllTweens=function(){for(var t=g._tweenHead;t;){var e=t._next;t._paused=!0,t.target&&(t.target.tweenjs_count=0),t._next=t._prev=null,t=e}g._tweenHead=g._tweenTail=null},g.hasActiveTweens=function(t){return t?!!t.tweenjs_count:!!g._tweenHead},g._installPlugin=function(t){for(var e=t.priority=t.priority||0,i=g._plugins=g._plugins||[],n=0,r=i.length;n<r&&!(e<i[n].priority);n++);i.splice(n,0,t)},g._register=function(t,e){var i,n=t.target;!e&&t._paused?(n&&(n.tweenjs_count=n.tweenjs_count?n.tweenjs_count+1:1),(i=g._tweenTail)?(g._tweenTail=i._next=t)._prev=i:g._tweenHead=g._tweenTail=t,!g._inited&&R.Ticker&&(R.Ticker.addEventListener("tick",g),g._inited=!0)):e&&!t._paused&&(n&&n.tweenjs_count--,i=t._next,n=t._prev,i?i._prev=n:g._tweenTail=n,n?n._next=i:g._tweenHead=i,t._next=t._prev=null),t._paused=e},t.wait=function(t,e){return 0<t&&this._addStep(+t,this._stepTail.props,null,e),this},t.to=function(t,e,i){i=this._addStep(+(e=null==e||e<0?0:e),null,i);return this._appendProps(t,i),this},t.label=function(t){return this.addLabel(t,this.duration),this},t.call=function(t,e,i){return this._addAction(i||this.target,t,e||[this])},t.set=function(t,e){return this._addAction(e||this.target,this._set,[t])},t.play=function(t){return this._addAction(t||this,this._set,[{paused:!1}])},t.pause=function(t){return this._addAction(t||this,this._set,[{paused:!0}])},t.w=t.wait,t.t=t.to,t.c=t.call,t.s=t.set,t.toString=function(){return"[Tween]"},t.clone=function(){throw"Tween can not be cloned."},t._addPlugin=function(t){var e=this._pluginIds||(this._pluginIds={}),i=t.ID;if(i&&!e[i]){e[i]=!0;for(var n=this._plugins||(this._plugins=[]),r=t.priority||0,s=0,a=n.length;s<a;s++)if(r<n[s].priority)return void n.splice(s,0,t);n.push(t)}},t._updatePosition=function(t,e){var i=this._stepHead.next,n=this.position,r=this.duration;if(this.target&&i){for(var s=i.next;s&&s.t<=n;)s=(i=i.next).next;r=e?0===r?1:n/r:(n-i.t)/i.d;this._updateTargetProps(i,r,e)}this._stepPosition=i?n-i.t:0},t._updateTargetProps=function(t,e,i){if(!(this.passive=!!t.passive)){var n,r,s,a,o=t.prev.props,h=t.props;(a=t.ease)&&(e=a(e,0,1,1));var l=this._plugins;t:for(var u in o){if(n=(r=o[u])!==(s=h[u])&&"number"==typeof r?r+(s-r)*e:1<=e?s:r,l)for(var c=0,d=l.length;c<d;c++){var p=l[c].change(this,t,u,n,e,i);if(p===g.IGNORE)continue t;void 0!==p&&(n=p)}this.target[u]=n}}},t._runActionsRange=function(t,e,i,n){var r=e<t,s=r?this._actionTail:this._actionHead,a=e,o=t;r&&(a=t,o=e);for(var h=this.position;s;){var l=s.t;if((l===e||o<l&&l<a||n&&l===t)&&(s.funct.apply(s.scope,s.params),h!==this.position))return!0;s=r?s.prev:s.next}},t._appendProps=function(t,e,i){var n,r,s,a=this._stepHead.props,o=this.target,h=g._plugins,l=e.prev,u=l.props,c=e.props||(e.props=this._cloneProps(u)),d={};for(n in t)if(t.hasOwnProperty(n)&&(d[n]=c[n]=t[n],void 0===a[n])){if(s=void 0,h)for(r=h.length-1;0<=r;r--)if((s=void 0!==(_=h[r].init(this,n,s))?_:s)===g.IGNORE){delete c[n],delete d[n];break}s!==g.IGNORE&&(void 0===s&&(s=o[n]),u[n]=void 0===s?null:s)}for(n in d)for(var p,_=t[n],f=l;(p=f)&&(f=p.prev);)if(f.props!==p.props){if(void 0!==f.props[n])break;f.props[n]=u[n]}if(!1!==i&&(h=this._plugins))for(r=h.length-1;0<=r;r--)h[r].step(this,e,d);(i=this._injected)&&(this._injected=null,this._appendProps(i,e,!1))},t._injectProp=function(t,e){(this._injected||(this._injected={}))[t]=e},t._addStep=function(t,e,i,n){n=new r(this._stepTail,this.duration,t,e,i,n||!1);return this.duration+=t,this._stepTail=this._stepTail.next=n},t._addAction=function(t,e,i){i=new n(this._actionTail,this.duration,t,e,i);return this._actionTail?this._actionTail.next=i:this._actionHead=i,this._actionTail=i,this},t._set=function(t){for(var e in t)this[e]=t[e]},t._cloneProps=function(t){var e,i={};for(e in t)i[e]=t[e];return i},R.Tween=R.promote(g,"AbstractTween")}(),function(){"use strict";function t(t){var e,i;t instanceof Array||null==t&&1<arguments.length?(e=t,i=arguments[1],t=arguments[2]):t&&(e=t.tweens,i=t.labels),this.AbstractTween_constructor(t),this.tweens=[],e&&this.addTween.apply(this,e),this.setLabels(i),this._init(t)}var e=R.extend(t,R.AbstractTween);e.addTween=function(t){t._parent&&t._parent.removeTween(t);var e=arguments.length;if(1<e){for(var i=0;i<e;i++)this.addTween(arguments[i]);return arguments[e-1]}if(0===e)return null;this.tweens.push(t),t._parent=this,t.paused=!0;var n=t.duration;return 0<t.loop&&(n*=t.loop+1),n>this.duration&&(this.duration=n),0<=this.rawPosition&&t.setPosition(this.rawPosition),t},e.removeTween=function(t){var e=arguments.length;if(1<e){for(var i=!0,n=0;n<e;n++)i=i&&this.removeTween(arguments[n]);return i}if(0===e)return!0;for(var r=this.tweens,n=r.length;n--;)if(r[n]===t)return r.splice(n,1),t._parent=null,t.duration>=this.duration&&this.updateDuration(),!0;return!1},e.updateDuration=function(){for(var t=this.duration=0,e=this.tweens.length;t<e;t++){var i=this.tweens[t],n=i.duration;0<i.loop&&(n*=i.loop+1),n>this.duration&&(this.duration=n)}},e.toString=function(){return"[Timeline]"},e.clone=function(){throw"Timeline can not be cloned."},e._updatePosition=function(t,e){for(var i=this.position,n=0,r=this.tweens.length;n<r;n++)this.tweens[n].setPosition(i,!0,t)},e._runActionsRange=function(t,e,i,n){for(var r=this.position,s=0,a=this.tweens.length;s<a;s++)if(this.tweens[s]._runActions(t,e,i,n),r!==this.position)return!0},R.Timeline=R.promote(t,"AbstractTween")}(),function(){"use strict";function e(){throw"Ease cannot be instantiated."}e.none=e.linear=function(t){return t},e.get=function(e){return e<-1?e=-1:1<e&&(e=1),function(t){return 0==e?t:e<0?t*(t*-e+1+e):t*((2-t)*e+(1-e))}},e.getPowIn=function(e){return function(t){return Math.pow(t,e)}},e.getPowOut=function(e){return function(t){return 1-Math.pow(1-t,e)}},e.getPowInOut=function(e){return function(t){return(t*=2)<1?.5*Math.pow(t,e):1-.5*Math.abs(Math.pow(2-t,e))}},e.quadIn=e.getPowIn(2),e.quadOut=e.getPowOut(2),e.quadInOut=e.getPowInOut(2),e.cubicIn=e.getPowIn(3),e.cubicOut=e.getPowOut(3),e.cubicInOut=e.getPowInOut(3),e.quartIn=e.getPowIn(4),e.quartOut=e.getPowOut(4),e.quartInOut=e.getPowInOut(4),e.quintIn=e.getPowIn(5),e.quintOut=e.getPowOut(5),e.quintInOut=e.getPowInOut(5),e.sineIn=function(t){return 1-Math.cos(t*Math.PI/2)},e.sineOut=function(t){return Math.sin(t*Math.PI/2)},e.sineInOut=function(t){return-.5*(Math.cos(Math.PI*t)-1)},e.backIn=(e.getBackIn=function(e){return function(t){return t*t*((e+1)*t-e)}})(1.7),e.backOut=(e.getBackOut=function(e){return function(t){return--t*t*((e+1)*t+e)+1}})(1.7),e.getBackInOut=function(e){return e*=1.525,function(t){return(t*=2)<1?t*t*((e+1)*t-e)*.5:.5*((t-=2)*t*((e+1)*t+e)+2)}},e.backInOut=e.getBackInOut(1.7),e.circIn=function(t){return-(Math.sqrt(1-t*t)-1)},e.circOut=function(t){return Math.sqrt(1- --t*t)},e.circInOut=function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},e.bounceIn=function(t){return 1-e.bounceOut(1-t)},e.bounceOut=function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},e.bounceInOut=function(t){return t<.5?.5*e.bounceIn(2*t):.5*e.bounceOut(2*t-1)+.5},e.elasticIn=(e.getElasticIn=function(i,n){var r=2*Math.PI;return function(t){if(0==t||1==t)return t;var e=n/r*Math.asin(1/i);return-(i*Math.pow(2,10*--t)*Math.sin((t-e)*r/n))}})(1,.3),e.elasticOut=(e.getElasticOut=function(i,n){var r=2*Math.PI;return function(t){if(0==t||1==t)return t;var e=n/r*Math.asin(1/i);return i*Math.pow(2,-10*t)*Math.sin((t-e)*r/n)+1}})(1,.3),e.elasticInOut=(e.getElasticInOut=function(i,n){var r=2*Math.PI;return function(t){var e=n/r*Math.asin(1/i);return(t*=2)<1?i*Math.pow(2,10*--t)*Math.sin((t-e)*r/n)*-.5:i*Math.pow(2,-10*--t)*Math.sin((t-e)*r/n)*.5+1}})(1,.3*1.5),R.Ease=e}(),function(){"use strict";function t(){throw"MotionGuidePlugin cannot be instantiated."}var T=t;T.priority=0,T.ID="MotionGuide",T.install=function(){return R.Tween._installPlugin(t),R.Tween.IGNORE},T.init=function(t,e,i){"guide"==e&&t._addPlugin(T)},T.step=function(t,e,i){for(var n in i)if("guide"===n){var r=e.props.guide,s=T._solveGuideData(i.guide,r);r.valid=!s;n=r.endData;if(t._injectProp("x",n.x),t._injectProp("y",n.y),s||!r.orient)break;s=void 0===e.prev.props.rotation?t.target.rotation||0:e.prev.props.rotation;if(r.startOffsetRot=s-r.startData.rotation,"fixed"==r.orient)r.endAbsRot=n.rotation+r.startOffsetRot,r.deltaRotation=0;else{var n=void 0===i.rotation?t.target.rotation||0:i.rotation,a=n-r.endData.rotation-r.startOffsetRot,o=a%360;switch(r.endAbsRot=n,r.orient){case"auto":r.deltaRotation=a;break;case"cw":r.deltaRotation=(360+o)%360+360*Math.abs(a/360|0);break;case"ccw":r.deltaRotation=(o-360)%360+-360*Math.abs(a/360|0)}}t._injectProp("rotation",r.endAbsRot)}},T.change=function(t,e,i,n,r,s){var a=e.props.guide;if(a&&e.props!==e.prev.props&&a!==e.prev.props.guide)return"guide"===i&&!a.valid||"x"==i||"y"==i||"rotation"===i&&a.orient?R.Tween.IGNORE:void T._ratioToPositionData(r,a,t.target)},T.debug=function(t,e,i){t=t.guide||t;var n=T._findPathProblems(t);if(n&&console.error("MotionGuidePlugin Error found: \n"+n),!e)return n;var r=t.path,s=r.length;for(e.save(),e.lineCap="round",e.lineJoin="miter",e.beginPath(),e.moveTo(r[0],r[1]),l=2;l<s;l+=4)e.quadraticCurveTo(r[l],r[l+1],r[l+2],r[l+3]);e.strokeStyle="black",e.lineWidth=4.5,e.stroke(),e.strokeStyle="white",e.lineWidth=3,e.stroke(),e.closePath();var a=i.length;if(i&&a){var o={},h={};T._solveGuideData(t,o);for(var l=0;l<a;l++)o.orient="fixed",T._ratioToPositionData(i[l],o,h),e.beginPath(),e.moveTo(h.x,h.y),e.lineTo(h.x+9*Math.cos(.0174533*h.rotation),h.y+9*Math.sin(.0174533*h.rotation)),e.strokeStyle="black",e.lineWidth=4.5,e.stroke(),e.strokeStyle="red",e.lineWidth=3,e.stroke(),e.closePath()}return e.restore(),n},T._solveGuideData=function(t,e){if(y=T.debug(t))return y;var i=e.path=t.path;e.orient=t.orient;e.subLines=[],e.totalLength=0,e.startOffsetRot=0,e.deltaRotation=0,e.startData={ratio:0},e.endData={ratio:1},e.animSpan=1;for(var n=i.length,r={},s=i[0],a=i[1],o=2;o<n;o+=4){for(var h=i[o],l=i[o+1],u=i[o+2],c=i[o+3],d={weightings:[],estLength:0,portion:0},p=s,_=a,f=1;f<=10;f++){T._getParamsForCurve(s,a,h,l,u,c,f/10,!1,r);var g=r.x-p,m=r.y-_,v=Math.sqrt(g*g+m*m);d.weightings.push(v),d.estLength+=v,p=r.x,_=r.y}for(e.totalLength+=d.estLength,f=0;f<10;f++)v=d.estLength,d.weightings[f]=d.weightings[f]/v;e.subLines.push(d),s=u,a=c}v=e.totalLength;var b=e.subLines.length;for(o=0;o<b;o++)e.subLines[o].portion=e.subLines[o].estLength/v;var y=isNaN(t.start)?0:t.start,t=isNaN(t.end)?1:t.end;T._ratioToPositionData(y,e,e.startData),T._ratioToPositionData(t,e,e.endData),e.startData.ratio=y,e.endData.ratio=t,e.animSpan=e.endData.ratio-e.startData.ratio},T._ratioToPositionData=function(t,e,i){for(var n,r=e.subLines,s=0,a=t*e.animSpan+e.startData.ratio,o=r.length,h=0;h<o;h++){if(a<=s+(n=r[h].portion)){c=h;break}s+=n}void 0===c&&(c=o-1,s-=n);var l=r[c].weightings,u=n;for(o=l.length,h=0;h<o&&!(a<=s+(n=l[h]*u));h++)s+=n;var c=4*c+2,d=e.path;return T._getParamsForCurve(d[c-2],d[c-1],d[c],d[c+1],d[c+2],d[c+3],h/10+(a-s)/n*.1,e.orient,i),e.orient&&(.99999<=t&&t<=1.00001&&void 0!==e.endAbsRot?i.rotation=e.endAbsRot:i.rotation+=e.startOffsetRot+t*e.deltaRotation),i},T._getParamsForCurve=function(t,e,i,n,r,s,a,o,h){var l=1-a;h.x=l*l*t+2*l*a*i+a*a*r,h.y=l*l*e+2*l*a*n+a*a*s,o&&(h.rotation=57.2957795*Math.atan2((n-e)*l+(s-n)*a,(i-t)*l+(r-i)*a))},T._findPathProblems=function(t){var e=t.path,i=e&&e.length||0;if(i<6||(i-2)%4){var n="\tCannot parse 'path' array due to invalid number of entries in path. ";return n+="There should be an odd number of points, at least 3 points, and 2 entries per point (x & y). ",n+="See 'CanvasRenderingContext2D.quadraticCurveTo' for details as 'path' models a quadratic bezier.\n\n",n+="Only [ "+i+" ] values found. Expected: "+Math.max(4*Math.ceil((i-2)/4)+2,6)}for(var r=0;r<i;r++)if(isNaN(e[r]))return"All data in path array must be numeric";n=t.start;if(isNaN(n)&&void 0!==n)return"'start' out of bounds. Expected 0 to 1, got: "+n;n=t.end;if(isNaN(n)&&void 0!==n)return"'end' out of bounds. Expected 0 to 1, got: "+n;t=t.orient;return t&&"fixed"!=t&&"auto"!=t&&"cw"!=t&&"ccw"!=t?'Invalid orientation value. Expected ["fixed", "auto", "cw", "ccw", undefined], got: '+t:void 0},R.MotionGuidePlugin=t}(),function(){"use strict";var t=R.TweenJS=R.TweenJS||{};t.version="1.0.0",t.buildDate="Thu, 12 Oct 2017 16:34:05 GMT"}()}.call(window)}.call(this,c(22)(t),c(4))},1567:function(t,e,i){var n,r,s,a,o,h=i(12),l=i(710),u=h.object({default:{kind:"Misc"}});h.extendNamedProperties(u),o=h.object({title:"Shape"},{fc:{type:"string",title:"Fill Color"},lf:{type:"array",title:"Linear Gradient Fill"},rf:{type:"array",title:"Radial Gradient Fill"},ls:{type:"array",title:"Linear Gradient Stroke"},p:{type:"string",title:"Path"},de:{type:"array",title:"Draw Ellipse"},sc:{type:"string",title:"Stroke Color"},ss:{type:"array",title:"Stroke Style"},t:h.array({},{type:"number",title:"Transform"}),m:{type:"string",title:"Mask"},bounds:h.array({title:"Bounds"},{type:"number"})}),r=h.object({format:"container"},{b:h.array({title:"Bounds"},{type:"number"}),c:h.array({title:"Children"},{anyOf:[{type:"string",title:"Shape Child"},h.object({title:"Container Child"}),{gn:{type:"string",title:"Global Name"},t:h.array({},{type:"number"})}]})}),a=h.object({},{bounds:h.array({title:"Bounds"},{type:"number"}),frameBounds:h.array({title:"Frame Bounds"},h.array({title:"Bounds"},{type:"number"})),shapes:h.array({},{bn:{type:"string",title:"Block Name"},gn:{type:"string",title:"Global Name"},im:{type:"boolean",title:"Is Mask"},m:{type:"string",title:"Uses Mask"}}),containers:h.array({},{bn:{type:"string",title:"Block Name"},gn:{type:"string",title:"Global Name"},t:h.array({},{type:"number"}),o:{type:"boolean",title:"Starts Hidden (_off)"},al:{type:"number",title:"Alpha"}}),animations:h.array({},{bn:{type:"string",title:"Block Name"},gn:{type:"string",title:"Global Name"},t:h.array({},{type:"number",title:"Transform"}),a:h.array({title:"Arguments"}),off:{type:"bolean",title:"Starts Hidden (_off)"}}),tweens:h.array({},h.array({title:"Function Chain"},h.object({title:"Function Call"},{n:{type:"string",title:"Name"},a:h.array({title:"Arguments"})}))),graphics:h.array({},{bn:{type:"string",title:"Block Name"},p:{type:"string",title:"Path"}})}),s=h.object({title:"Positions",description:"Customize position offsets."},{registration:h.point2d({title:"Registration Point",description:"Action-specific registration point override."}),torso:h.point2d({title:"Torso Offset",description:"Action-specific torso offset override."}),mouth:h.point2d({title:"Mouth Offset",description:"Action-specific mouth offset override."}),aboveHead:h.point2d({title:"Above Head Offset",description:"Action-specific above-head offset override."})}),n=h.object({},{animation:{type:"string",description:"Raw animation being sourced",format:"raw-animation"},container:{type:"string",description:"Name of the container to show"},relatedActions:h.object({},{begin:{$ref:"#/definitions/action"},end:{$ref:"#/definitions/action"},main:{$ref:"#/definitions/action"},fore:{$ref:"#/definitions/action"},back:{$ref:"#/definitions/action"},side:{$ref:"#/definitions/action"},"?0?011?11?11":{$ref:"#/definitions/action",title:"NW corner"},"?0?11011?11?":{$ref:"#/definitions/action",title:"NE corner, flipped"},"?0?111111111":{$ref:"#/definitions/action",title:"N face"},"?11011011?0?":{$ref:"#/definitions/action",title:"SW corner, top"},"11?11?110?0?":{$ref:"#/definitions/action",title:"SE corner, top, flipped"},"?11011?0????":{$ref:"#/definitions/action",title:"SW corner, bottom"},"11?110?0????":{$ref:"#/definitions/action",title:"SE corner, bottom, flipped"},"?11011?11?11":{$ref:"#/definitions/action",title:"W face"},"11?11011?11?":{$ref:"#/definitions/action",title:"E face, flipped"},"011111111111":{$ref:"#/definitions/action",title:"NW elbow"},110111111111:{$ref:"#/definitions/action",title:"NE elbow, flipped"},"111111111?0?":{$ref:"#/definitions/action",title:"S face, top"},"111111?0????":{$ref:"#/definitions/action",title:"S face, bottom"},111111111011:{$ref:"#/definitions/action",title:"SW elbow, top"},111111111110:{$ref:"#/definitions/action",title:"SE elbow, top, flipped"},"111111011?11":{$ref:"#/definitions/action",title:"SW elbow, bottom"},"11111111011?":{$ref:"#/definitions/action",title:"SE elbow, bottom, flipped"},111111111111:{$ref:"#/definitions/action",title:"Middle"}}),loops:{type:"boolean"},speed:{type:"number"},goesTo:{type:"string",description:"Action (animation?) to which we switch after this animation."},frames:{type:"string",pattern:"^[0-9,]+$",description:"Manually way to specify frames."},framerate:{type:"number",description:"Get this from the HTML output."},positions:s,scale:{title:"Scale",type:"number"},flipX:{title:"Flip X",type:"boolean",description:"Flip this animation horizontally?"},flipY:{title:"Flip Y",type:"boolean",description:"Flip this animation vertically?"}}),i=h.sound({delay:{type:"number"}}),_.extend(u.properties,{raw:h.object({title:"Raw Vector Data",default:{shapes:{},containers:{},animations:{}}},{shapes:h.object({title:"Shapes",additionalProperties:o}),containers:h.object({title:"Containers",additionalProperties:r}),animations:h.object({title:"Animations",additionalProperties:a})}),kind:h.shortString({enum:["Unit","Floor","Wall","Doodad","Misc","Mark","Item","Hero","Missile"],default:"Misc",title:"Kind"}),terrains:h.array({title:"Terrains",description:"If specified, limits this ThangType to levels with matching terrains.",uniqueItems:!0},h.terrainString),gems:{type:"integer",minimum:0,title:"Gem Cost",description:"How many gems this item or hero costs."},subscriber:{type:"boolean",title:"Subscriber (items only)",description:"This item is for subscribers only."},heroClass:{type:"string",enum:["Warrior","Ranger","Wizard"],title:"Hero Class",description:"What class this is (if a hero) or is restricted to (if an item). Leave undefined for most items."},tier:{type:"number",minimum:0,title:"Tier",description:"What tier (fractional) this item or hero is in."},actions:h.object({title:"Actions",additionalProperties:{$ref:"#/definitions/action"}}),soundTriggers:h.object({title:"Sound Triggers",additionalProperties:h.array({},{$ref:"#/definitions/sound"})},{say:h.object({format:"slug-props",additionalProperties:{$ref:"#/definitions/sound"}},{defaultSimlish:h.array({},{$ref:"#/definitions/sound"}),swearingSimlish:h.array({},{$ref:"#/definitions/sound"})})}),rotationType:{title:"Rotation",type:"string",enum:["isometric","fixed","free"]},matchWorldDimensions:{title:"Match World Dimensions",type:"boolean"},shadow:{title:"Shadow Diameter",type:"number",format:"meters",description:"Shadow diameter in meters"},description:{type:"string",format:"markdown",title:"Description"},layerPriority:{title:"Layer Priority",type:"integer",description:"Within its layer, sprites are sorted by layer priority, then y, then z."},scale:{title:"Scale",type:"number"},spriteType:{enum:["singular","segmented"],title:"Sprite Type"},positions:s,raster:{type:"string",format:"image-file",title:"Raster Image"},rasterIcon:{type:"string",format:"image-file",title:"Raster Image Icon"},containerIcon:{type:"string"},poseImage:{type:"string",format:"image-file",title:"Pose Image"},featureImages:h.object({title:"Hero Doll Images"},{body:{type:"string",format:"image-file",title:"Body"},head:{type:"string",format:"image-file",title:"Head"},hair:{type:"string",format:"image-file",title:"Hair"},thumb:{type:"string",format:"image-file",title:"Thumb"},wizardHand:{type:"string",format:"image-file",title:"Wizard Hand"}}),dollImages:h.object({title:"Paper Doll Images"},{male:{type:"string",format:"image-file",title:"Male"},female:{type:"string",format:"image-file",title:"Female"},maleThumb:{type:"string",format:"image-file",title:"Thumb (Male)"},femaleThumb:{type:"string",format:"image-file",title:"Thumb (Female)"},maleRanger:{type:"string",format:"image-file",title:"Glove (Male Ranger)"},maleRangerThumb:{type:"string",format:"image-file",title:"Thumb (Male Ranger)"},femaleRanger:{type:"string",format:"image-file",title:"Glove (Female Ranger)"},femaleRangerThumb:{type:"string",format:"image-file",title:"Thumb (Female Ranger)"},maleBack:{type:"string",format:"image-file",title:"Male Back"},femaleBack:{type:"string",format:"image-file",title:"Female Back"},pet:{type:"string",format:"image-file",title:"Pet"}}),colorGroups:h.object({title:"Color Groups",additionalProperties:{type:"array",format:"thang-color-group",items:{type:"string"}}}),snap:h.object({title:"Snap",description:"In the level editor, snap positioning to these intervals.",required:["x","y"],default:{x:4,y:4}},{x:{title:"Snap X",type:"number",description:"Snap to this many meters in the x-direction."},y:{title:"Snap Y",type:"number",description:"Snap to this many meters in the y-direction."}}),components:h.array({title:"Components",description:"Thangs are configured by changing the Components attached to them.",uniqueItems:!0,format:"thang-components-array"},l),i18n:{type:"object",format:"i18n",props:["name","description","extendedName","shortName","unlockLevelName","soundTriggers"],description:"Help translate this ThangType's name and description."},extendedName:{type:"string",title:"Extended Hero Name",description:'The long form of the hero\'s name. Ex.: "Captain Anya Weston".'},shortName:{type:"string",title:"Short Hero Name",description:'The short form of the hero\'s name. Ex.: "Anya".'},unlockLevelName:{type:"string",title:"Unlock Level Name",description:"The name of the level in which the hero is unlocked."},tasks:h.array({title:"Tasks",description:"Tasks to be completed for this ThangType."},h.task),prerenderedSpriteSheetData:h.array({title:"Prerendered SpriteSheet Data"},h.object({title:"SpriteSheet"},{actionNames:{type:"array"},animations:{type:"object",description:"Third EaselJS SpriteSheet animations format",additionalProperties:{description:"EaselJS animation",type:"object",properties:{frames:{type:"array"},next:{type:["string","null"]},speed:{type:"number"}}}},colorConfig:h.object({additionalProperties:h.colorConfig()}),colorLabel:{enum:["red","green","blue"]},frames:{type:"array",description:"Second EaselJS SpriteSheet frames format",items:{type:"array",items:[{type:"number",title:"x"},{type:"number",title:"y"},{type:"number",title:"width"},{type:"number",title:"height"},{type:"number",title:"imageIndex"},{type:"number",title:"regX"},{type:"number",title:"regY"}]}},image:{type:"string",format:"image-file"},resolutionFactor:{type:"number"},spriteType:{enum:["singular","segmented"],title:"Sprite Type"}})),restricted:{type:"string",title:"Restricted",description:"If set, this ThangType will only be accessible by admins and whoever it is restricted to."},releasePhase:{enum:["beta","released"],description:"How far along the ThangType's development is, determining who sees it."},gender:{enum:["female","male"],type:"string",title:"Hero Gender",description:"Affects which paper doll image set and language pronouns to use."},ozaria:{type:"boolean",description:"Marks this thang as an Ozaria only type. Used to prevent Ozaria hero's from appearing in CodeCombat hero selector."}}),u.required=[],u.default={raw:{}},u.definitions={action:n,sound:i},h.extendBasicProperties(u,"thang.type"),h.extendSearchableProperties(u),h.extendVersionedProperties(u,"thang.type"),h.extendPatchableProperties(u),h.extendTranslationCoverageProperties(u),h.extendAlgoliaProperties(u),t.exports=u}}]);